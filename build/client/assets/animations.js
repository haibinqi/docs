import{r as d,j as e}from"./jsx-runtime.js";import{c as f}from"./utils.js";import{B as m}from"./button.js";import{D as j,a as g,P as N,b as v,c as y,d as b,e as w,T as D}from"./dialog.js";import{I as x}from"./input.js";import{L as l}from"./label.js";import{c as L,d as k,L as F,u as S,O as T}from"./components.js";import{F as C}from"./flask-conical.js";import"./index2.js";import"./index3.js";import"./createLucideIcon.js";import"./index6.js";import"./index.js";import"./Combination.js";function O({animations:i}){var c;const p=L().pathname,s=k(),[h,n]=d.useState(!1),o=s.state==="submitting";d.useEffect(()=>{s.data&&s.data.success&&n(!1)},[s.data]);const u=i.reduce((a,t)=>(a[t.category]||(a[t.category]=[]),a[t.category].push(t),a),{});return e.jsx("aside",{className:"fixed top-[calc(3.5rem+5px)] z-30 -ml-2 hidden h-[calc(100vh-3.5rem-5px)] w-full shrink-0 md:sticky md:block border-r bg-background",children:e.jsx("div",{className:"h-full pr-4 pl-2 py-4",children:e.jsxs("div",{className:"w-full h-full flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 px-2",children:[e.jsx("h4",{className:"text-sm font-semibold",children:"动画列表"}),e.jsxs(j,{open:h,onOpenChange:n,children:[e.jsx(g,{asChild:!0,children:e.jsxs(m,{variant:"ghost",size:"icon",className:"h-6 w-6",children:[e.jsx(N,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"添加动画"})]})}),e.jsxs(v,{children:[e.jsxs(y,{children:[e.jsx(b,{children:"添加新动画"}),e.jsx(w,{children:"输入动画标题、分类和代码。"})]}),e.jsxs(s.Form,{method:"post",action:"/animations",className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"category",children:"分类"}),e.jsx(x,{id:"category",name:"category",placeholder:"例如：四年级科学",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"title",children:"标题"}),e.jsx(x,{id:"title",name:"title",placeholder:"例如：水的三态变化",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"content",children:"HTML 代码"}),e.jsx(D,{id:"content",name:"content",placeholder:"<style>...</style><svg>...</svg><script>...<\/script>",className:"font-mono min-h-[150px]",required:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"支持完整 HTML/SVG/CSS/JS。"})]}),((c=s.data)==null?void 0:c.error)&&e.jsx("p",{className:"text-sm text-destructive",children:s.data.error}),e.jsx("div",{className:"flex justify-end",children:e.jsx(m,{type:"submit",disabled:o,children:o?"添加中...":"添加"})})]})]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto pr-2",children:i.length===0?e.jsx("div",{className:"px-2 text-muted-foreground text-xs",children:"暂无动画，点击上方 + 号添加"}):e.jsx("div",{className:"space-y-6",children:Object.entries(u).map(([a,t])=>e.jsxs("div",{children:[e.jsx("h5",{className:"mb-2 px-2 text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:a}),e.jsx("div",{className:"grid grid-flow-row auto-rows-max text-sm gap-1",children:t.map(r=>e.jsxs(F,{to:`/animations/${r.id}`,className:f("group flex w-full items-center rounded-md border border-transparent px-2 py-1.5 hover:underline truncate",p===`/animations/${r.id}`?"text-foreground font-medium bg-muted":"text-muted-foreground"),title:r.title,children:[e.jsx(C,{className:"mr-2 h-4 w-4 shrink-0"}),e.jsx("span",{className:"truncate",children:r.title})]},r.id))})]},a))})})]})})})}function K(){const{animations:i}=S();return e.jsxs("div",{className:"container flex-1 items-start md:grid md:grid-cols-[240px_minmax(0,1fr)] md:gap-2 lg:grid-cols-[280px_minmax(0,1fr)] lg:gap-4 px-[5px] pt-[5px]",children:[e.jsx(O,{animations:i}),e.jsx("main",{className:"relative h-[calc(100vh-4rem)] overflow-hidden -mx-[5px] lg:-mx-4 md:ml-0",children:e.jsx(T,{})})]})}export{K as default};
