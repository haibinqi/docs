var _a=Object.defineProperty;var $a=(t,e,n)=>e in t?_a(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Re=(t,e,n)=>$a(t,typeof e!="symbol"?e+"":e,n);import{r as l,j as h,P as Na}from"./jsx-runtime.js";import{r as us}from"./index4.js";import{B as rn}from"./button.js";import{P as Ae,d as Is,c as Ea,a as ds,u as st,b as Ne,e as Ta}from"./index3.js";import{u as Ra,c as Da}from"./index6.js";import{a as Ia,u as qe,c as Ze}from"./utils.js";import{P as Pa,h as Aa,u as La,R as Ha,F as Oa,D as Wa}from"./Combination.js";import{c as Er,R as za,A as Fa,C as Va,a as Ba,b as Tr}from"./index7.js";import{u as Ya}from"./index.js";import{c as _t}from"./createLucideIcon.js";import{F as Ga}from"./folder-open.js";/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ua=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Ka=_t("check",Ua);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qa=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Qa=_t("chevron-up",qa);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xa=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Ja=_t("download",Xa);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Za=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ei=_t("plus",Za);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ti=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],ni=_t("save",ti);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const si=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],ri=_t("trash-2",si);function Le(t,e="data-id"){let n=t;for(!n.tagName&&t.target&&(n=t.target);n;){if(n.getAttribute&&n.getAttribute(e))return n;n=n.parentNode}return null}function Bn(t,e="data-id"){const n=Le(t,e);return n?n.getAttribute(e):null}function Bt(t,e="data-id"){const n=Le(t,e);return n?$t(n.getAttribute(e)):null}function $t(t){if(typeof t=="string"){const e=t*1;if(!isNaN(e))return e}return t}function oi(){return{detect:()=>!0,addEvent:function(t,e,n){return t.addEventListener(e,n),()=>t.removeEventListener(e,n)},addGlobalEvent:function(t,e){return document.addEventListener(t,e),()=>document.removeEventListener(t,e)},getTopNode:function(){return window.document.body}}}var Pe=oi();function fs(t){Object.assign(Pe,t)}function Ps(t,e,n){function s(r){const o=Le(r);if(!o)return;const a=$t(o.dataset.id);if(typeof e=="function")return e(a,r);let i,c=r.target;for(;c!=o;){if(i=c.dataset?c.dataset.action:null,i&&e[i]){e[i](a,r);return}c=c.parentNode}e[n]&&e[n](a,r)}Pe.addEvent(t,n,s)}function Rr(t,e){Ps(t,e,"click"),e.dblclick&&Ps(t,e.dblclick,"dblclick")}function ai(t,e){for(let n=t.length-1;n>=0;n--)if(t[n]===e){t.splice(n,1);break}}var Dr=new Date,hn=!1,on=[],ut=[],As=t=>{if(hn){hn=!1;return}for(let e=ut.length-1;e>=0;e--){const{node:n,date:s,props:r}=ut[e];if(!(s>Dr)&&!n.contains(t.target)&&n!==t.target&&(r.callback&&r.callback(t),r.modal||t.defaultPrevented))break}},ii=t=>{Dr=new Date,hn=!0;for(let e=ut.length-1;e>=0;e--){const{node:n}=ut[e];if(!n.contains(t.target)&&n!==t.target){hn=!1;break}}};function qt(t,e){on.length||(on=[Pe.addGlobalEvent("click",As,t),Pe.addGlobalEvent("contextmenu",As,t),Pe.addGlobalEvent("mousedown",ii,t)]),typeof e!="object"&&(e={callback:e});const n={node:t,date:new Date,props:e};return ut.push(n),{destroy(){ai(ut,n),ut.length||(on.forEach(s=>s()),on=[])}}}var li=t=>t.indexOf("bottom")!==-1,ci=t=>t.indexOf("left")!==-1,Ls=t=>t.indexOf("right")!==-1,ui=t=>t.indexOf("top")!==-1,Hs=t=>t.indexOf("fit")!==-1,Os=t=>t.indexOf("overlap")!==-1,di=t=>t.indexOf("center")!==-1;function fi(t,e){let n=0;const s=Pe.getTopNode(t);for(;t&&t!==s;){const r=getComputedStyle(t).position;if((r==="absolute"||r==="relative"||r==="fixed")&&(n=parseInt(getComputedStyle(t).zIndex)||0),t=t.parentNode,t===e)break}return n}var De,tt,At,Ue;function hi(t,e,n="bottom",s=0,r=0){if(!t)return null;De=s,tt=r,At="auto";let o=0,a=0;const i=pi(t),c=Os(n)?Pe.getTopNode(t):i;if(!i)return null;const u=i.getBoundingClientRect(),d=t.getBoundingClientRect(),f=c.getBoundingClientRect();if(e){const g=fi(e,i);o=Math.max(g+1,20)}if(e){if(Ue=e.getBoundingClientRect(),Hs(n)&&(At=Ue.width+"px"),n!=="point")if(di(n))Hs(n)?De=0:(De=f.width/2,a=1),tt=(f.height-d.height)/2;else{const g=Os(n)?0:1;De=Ls(n)?Ue.right+g:Ue.left-g,tt=li(n)?Ue.bottom+1:Ue.top}}else Ue={left:s,right:s,top:r,bottom:r};ci(n)&&(De=Ue.left,a=2),ui(n)&&(tt=Ue.top-d.height);const m=tt+d.height-f.bottom;return m>0&&(tt-=m),De+d.width-f.right>0&&(Ls(n)?a=2:De=f.right-d.width),a&&(De=Math.round(De-d.width*a/2)),De<0&&(n!=="left"?De=0:De=Ue.right),De+=c.scrollLeft-u.left,tt+=c.scrollTop-u.top,At=At||"auto",{x:De,y:tt,z:o,width:At}}function pi(t){const e=Pe.getTopNode(t);for(t&&(t=t.parentElement);t;){const n=getComputedStyle(t).position;if(t===e||n==="relative"||n==="absolute"||n==="fixed")return t;t=t.parentNode}return null}var Ws=new Date().valueOf();function Qe(){return Ws+=1,Ws}function Ie(t){return t<10?"0"+t:t.toString()}function mi(t){const e=Ie(t);return e.length==2?"0"+e:e}function Ir(t){const e=Math.floor(t/11)*11;return{start:e,end:e+11}}function xi(t){let e=t.getDay();e===0&&(e=7);const n=new Date(t.valueOf());n.setDate(t.getDate()+(4-e));const s=n.getFullYear(),r=Math.floor((n.getTime()-new Date(s,0,1).getTime())/864e5);return 1+Math.floor(r/7)}var zs=["",""];function gi(t,e,n){switch(t){case"%d":return Ie(e.getDate());case"%m":return Ie(e.getMonth()+1);case"%j":return e.getDate();case"%n":return e.getMonth()+1;case"%y":return Ie(e.getFullYear()%100);case"%Y":return e.getFullYear();case"%D":return n.dayShort[e.getDay()];case"%l":return n.dayFull[e.getDay()];case"%M":return n.monthShort[e.getMonth()];case"%F":return n.monthFull[e.getMonth()];case"%h":return Ie((e.getHours()+11)%12+1);case"%g":return(e.getHours()+11)%12+1;case"%G":return e.getHours();case"%H":return Ie(e.getHours());case"%i":return Ie(e.getMinutes());case"%a":return((e.getHours()>11?n.pm:n.am)||zs)[0];case"%A":return((e.getHours()>11?n.pm:n.am)||zs)[1];case"%s":return Ie(e.getSeconds());case"%S":return mi(e.getMilliseconds());case"%W":return Ie(xi(e));case"%c":{let s=e.getFullYear()+"";return s+="-"+Ie(e.getMonth()+1),s+="-"+Ie(e.getDate()),s+="T",s+=Ie(e.getHours()),s+=":"+Ie(e.getMinutes()),s+=":"+Ie(e.getSeconds()),s}default:return t}}var wi=/%[a-zA-Z]/g;function St(t,e){return typeof t=="function"?t:function(n){return n?(n.getMonth||(n=new Date(n)),t.replace(wi,s=>gi(s,n,e))):""}}function Fs(t){return t&&typeof t=="object"&&!Array.isArray(t)}function Yn(t,e){for(const n in e){const s=e[n];Fs(t[n])&&Fs(s)?t[n]=Yn({...t[n]},e[n]):t[n]=e[n]}return t}function Nt(t){return{getGroup(e){const n=t[e];return s=>n&&n[s]||s},getRaw(){return t},extend(e,n){if(!e)return this;let s;return n?s=Yn({...e},t):s=Yn({...t},e),Nt(s)}}}function ke(t){const[e,n]=l.useState(t),s=l.useRef(t);return l.useEffect(()=>{if(s.current!==t){if(Array.isArray(s.current)&&Array.isArray(t)&&s.current.length===0&&t.length===0)return;s.current=t,n(t)}},[t]),[e,n]}function yi(t,e,n){const[s,r]=l.useState(()=>e);return t||console.warn(`Writable ${n} is not defined`),l.useEffect(()=>t?t.subscribe(a=>{r(()=>a)}):void 0,[t]),s}function ne(t,e){const n=t.getState(),s=t.getReactiveState();return yi(s[e],n[e],e)}function yt(t,e){const[n,s]=l.useState(()=>null);return l.useEffect(()=>{if(!t)return;const r=t.getReactiveState(),o=r?r[e]:null;return o?o.subscribe(i=>s(()=>i)):void 0},[t,e]),n}function vi(t,e){const n=l.useRef(e);n.current=e;const[s,r]=l.useState(1);return l.useEffect(()=>t.subscribe(a=>{n.current=a,r(i=>i+1)}),[t]),[n.current,s]}function pn(t,e){const n=t.getState(),s=t.getReactiveState();return vi(s[e],n[e])}function hs(t,e){return typeof t=="function"?typeof e=="object"?t(e):t():t}function Pr(t){const e={};return t.split(";").forEach(n=>{const[s,r]=n.split(":");if(r){let o=s.trim();o.indexOf("-")&&(o=o.replace(/-([a-z])/g,(a,i)=>i.toUpperCase())),e[o]=r.trim()}}),e}function Ar(t){let e=t,n=[];return{subscribe:i=>{n.push(i),i(e)},unsubscribe:i=>{n=n.filter(c=>c!==i)},set:i=>{e=i,n.forEach(c=>c(e))},update:i=>{e=i(e),n.forEach(c=>c(e))}}}function Vs(t,e,n){function s(r){const o=Le(r);if(!o)return;const a=$t(o.dataset.id);if(typeof e=="function")return e(a,r);let i,c=r.target;for(;c!=o;){if(i=c.dataset?c.dataset.action:null,i&&e[i]){e[i](a,r);return}c=c.parentNode}e[n]&&e[n](a,r)}return Pe.addEvent(t,n,s)}function bi(t,e){const n=[Vs(t,e,"click")];return e.dblclick&&n.push(Vs(t,e.dblclick,"dblclick")),()=>{n.forEach(s=>s())}}const ki="en-US",Si={monthFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],hours:"Hours",minutes:"Minutes",done:"Done",clear:"Clear",today:"Today",am:["am","AM"],pm:["pm","PM"],weekStart:0,clockFormat:24},Ci={ok:"OK",cancel:"Cancel",select:"Select","No data":"No data","Rows per page":"Rows per page","Total pages":"Total pages"},ji={timeFormat:"%H:%i",dateFormat:"%m/%d/%Y",monthYearFormat:"%F %Y",yearFormat:"%Y"},bn={core:Ci,calendar:Si,formats:ji,lang:ki};function Mi({value:t="",id:e=Qe(),placeholder:n="",title:s="",disabled:r=!1,error:o=!1,readonly:a=!1,onChange:i}){const[c,u]=ke(t),d=l.useCallback(p=>{const g=p.target.value;u(g),i&&i({value:g,input:!0})},[i]),f=l.useCallback(p=>{const g=p.target.value;u(g),i&&i({value:g})},[i]),m=l.useRef(null);return l.useEffect(()=>{const p=f,g=m.current;return g.addEventListener("change",p),()=>{g&&g.removeEventListener("change",p)}},[f]),h.jsx("textarea",{className:`wx-3yFVAC wx-textarea ${o?"wx-error":""}`,id:e,disabled:r,placeholder:n,readOnly:a,title:s,value:c,onInput:d,ref:m})}function dt({type:t="",css:e="",icon:n="",disabled:s=!1,title:r="",text:o="",children:a,onClick:i}){const c=l.useMemo(()=>{let d=t?t.split(" ").filter(f=>f!=="").map(f=>"wx-"+f).join(" "):"";return e+(e?" ":"")+d},[t,e]),u=d=>{i&&i(d)};return h.jsxs("button",{title:r,className:`wx-2ZWgb4 wx-button ${c} ${n&&!a?"wx-icon":""}`,disabled:s,onClick:u,children:[n&&h.jsx("i",{className:"wx-2ZWgb4 "+n}),a||o||" "]})}function _i({id:t=Qe(),label:e="",inputValue:n="",value:s=!1,onChange:r,disabled:o=!1}){const[a,i]=ke(s);return h.jsxs("div",{className:"wx-2IvefP wx-checkbox",children:[h.jsx("input",{type:"checkbox",id:t,disabled:o,className:"wx-2IvefP wx-check",checked:a,value:n,onChange:({target:c})=>{const u=c.checked;i(u),r&&r({value:u,inputValue:n})}}),h.jsxs("label",{htmlFor:t,className:"wx-2IvefP wx-label",children:[h.jsx("span",{className:"wx-2IvefP wx-before"}),e&&h.jsx("span",{className:"wx-2IvefP wx-after",children:e})]})]})}function Et({position:t="bottom",align:e="start",autoFit:n=!0,onCancel:s,width:r="100%",children:o}){const a=l.useRef(null),[i,c]=l.useState(t),[u,d]=l.useState(e);return l.useEffect(()=>{c(t)},[t]),l.useEffect(()=>{d(e)},[e]),l.useEffect(()=>{if(n){const f=a.current;if(f){const m=f.getBoundingClientRect(),p=Pe.getTopNode(f).getBoundingClientRect();m.right>=p.right&&d("end"),m.bottom>=p.bottom&&c("top")}}},[n,u,i]),l.useEffect(()=>{const f=m=>{s&&s(m)};if(a.current)return qt(a.current,f).destroy},[s]),h.jsx("div",{ref:a,className:`wx-32GZ52 wx-dropdown wx-${i}-${u}`,style:{width:r},children:o})}const ps=l.createContext("willow"),$i=l.createContext({}),We=l.createContext(null),He=Object.freeze(Object.defineProperty({__proto__:null,helpers:$i,i18n:We,theme:ps},Symbol.toStringTag,{value:"Module"}));function Qt(){return Nt(bn)}function Ni(){let t=null,e=!1,n,s,r,o;const a=(d,f,m,p)=>{n=d,s=f,r=m,o=p},i=d=>{t=d,e=t!==null,r(t)},c=(d,f)=>{if(d!==null&&n){const m=n.querySelectorAll(".wx-list > .wx-item")[d];m&&(m.scrollIntoView({block:"nearest"}),f&&f.preventDefault())}},u=(d,f)=>{const m=d===null?null:Math.max(0,Math.min(t+d,s.length-1));m!==t&&(i(m),n?c(m,f):requestAnimationFrame(()=>c(m,f)))};return{move:d=>{const f=Bt(d),m=s.findIndex(p=>p.id==f);m!==t&&i(m)},keydown:(d,f)=>{switch(d.code){case"Enter":e?o():i(0);break;case"Space":e||i(0);break;case"Escape":r(t=null);break;case"Tab":r(t=null);break;case"ArrowDown":u(e?1:f||0,d);break;case"ArrowUp":u(e?-1:f||0,d);break}},init:a,navigate:u}}function kn({items:t=[],children:e,onSelect:n,onReady:s}){const r=l.useRef(),o=l.useRef(Ni()),[a,i]=l.useState(null),c=l.useRef(a),u=(l.useContext(We)||Qt()).getGroup("core"),d=f=>{var m;f&&f.stopPropagation(),n&&n({id:(m=t[c.current])==null?void 0:m.id})};return l.useEffect(()=>{o.current.init(r.current,t,f=>{i(f),c.current=f},d)},[t,!!r.current]),l.useEffect(()=>{s&&s(o.current)},[]),a===null?null:h.jsx(Et,{onCancel:()=>o.current.navigate(null),children:h.jsx("div",{className:"wx-233fr7 wx-list",ref:r,onClick:d,onMouseMove:o.current.move,children:t.length?t.map((f,m)=>h.jsx("div",{className:`wx-233fr7 wx-item ${m===a?"wx-focus":""}`,"data-id":f.id,children:e?hs(e,{option:f}):f.label},f.id)):h.jsx("div",{className:"wx-233fr7 wx-no-data",children:u("No data")})})})}function Ei({value:t="",onValueChange:e,id:n=Qe(),options:s=[],textOptions:r=null,textField:o="label",placeholder:a="",title:i="",disabled:c=!1,error:u=!1,clear:d=!1,children:f,onChange:m}){const p=l.useRef(null),g=l.useRef(null),[x,w]=ke(t),[y,v]=l.useState(!1),[b,S]=l.useState(""),C=l.useRef(null),[k,j]=l.useState(!1),N=l.useMemo(()=>{if(y)return b;if(x||x===0){const H=(r||s).find(z=>z.id===x);if(H)return H[o]}return""},[y,b,x,r,s,o]),_=l.useMemo(()=>!N||!y?s:s.filter(H=>H[o].toLowerCase().includes(N.toLowerCase())),[N,y,s,o]),$=l.useCallback(()=>_.findIndex(H=>H.id===x),[_,x]),M=l.useCallback(H=>{p.current=H.navigate,g.current=H.keydown},[]),E=l.useCallback((H,z)=>{if(H||H===0){let I=s.find(X=>X.id===H);if(v(!1),z&&p.current(null),I&&x!==I.id){const X=I.id;w(X),e&&e(X),m&&m({value:X})}}!k&&z&&C.current.focus()},[s,x,k,e,m]),L=l.useCallback(({id:H})=>{E(H,!0)},[E]),P=l.useCallback(H=>{H&&H.stopPropagation(),w(""),v(!1),e&&e(""),m&&m({value:""})},[e,m]),W=l.useCallback(H=>{if(!s.length)return;if(H===""&&d){P();return}let z=s.find(X=>X[o]===H);z||(z=s.find(X=>X[o].toLowerCase().includes(H.toLowerCase())));const I=z?z.id:x||s[0].id;E(I,!1)},[s,o,d,x,E,P]),V=l.useCallback(()=>{S(C.current.value),v(!0),_.length?p.current(0):p.current(null)},[_.length,p]),ee=l.useCallback(()=>{j(!0)},[]),O=l.useCallback(()=>{j(!1),setTimeout(()=>{k||W(N)},200)},[k,W,N]);return h.jsxs("div",{className:"wx-1j11Jk wx-combo",onClick:()=>p.current($()),onKeyDown:H=>g.current(H,$()),title:i,children:[h.jsx("input",{className:"wx-1j11Jk wx-input "+(u?"wx-error":""),id:n,ref:C,value:N,disabled:c,placeholder:a,onFocus:ee,onBlur:O,onInput:V}),d&&!c&&x?h.jsx("i",{className:"wx-1j11Jk wx-icon wxi-close",onClick:P}):h.jsx("i",{className:"wx-1j11Jk wx-icon wxi-angle-down"}),!c&&h.jsx(kn,{items:_,onReady:M,onSelect:L,children:({option:H})=>h.jsx(h.Fragment,{children:f?f({option:H}):H[o]})})]})}function Sn({value:t="",id:e=Qe(),readonly:n=!1,focus:s=!1,select:r=!1,type:o="text",placeholder:a="",disabled:i=!1,error:c=!1,inputStyle:u={},title:d="",css:f="",icon:m="",clear:p=!1,onChange:g}){const[x,w]=ke(t),y=l.useRef(null),v=l.useMemo(()=>m&&f.indexOf("wx-icon-left")===-1?"wx-icon-right "+f:f,[m,f]),b=l.useMemo(()=>m&&f.indexOf("wx-icon-left")!==-1,[m,f]);l.useEffect(()=>{const N=setTimeout(()=>{s&&y.current&&y.current.focus(),r&&y.current&&y.current.select()},1);return()=>clearTimeout(N)},[s,r]);const S=l.useCallback(N=>{const _=N.target.value;w(_),g&&g({value:_,input:!0})},[g]),C=l.useCallback(N=>g&&g({value:N.target.value}),[g]);function k(N){N.stopPropagation(),w(""),g&&g({value:""})}let j=o;return o!=="password"&&o!=="number"&&(j="text"),l.useEffect(()=>{const N=C,_=y.current;return _.addEventListener("change",N),()=>{_&&_.removeEventListener("change",N)}},[C]),h.jsxs("div",{className:`wx-hQ64J4 wx-text ${v} ${c?"wx-error":""} ${i?"wx-disabled":""} ${p?"wx-clear":""}`,children:[h.jsx("input",{className:"wx-hQ64J4 wx-input",ref:y,id:e,readOnly:n,disabled:i,placeholder:a,type:j,style:u,title:d,value:x,onInput:S}),p&&!i&&x?h.jsxs(h.Fragment,{children:[h.jsx("i",{className:"wx-hQ64J4 wx-icon wxi-close",onClick:k}),b&&h.jsx("i",{className:`wx-hQ64J4 wx-icon ${m}`})]}):m?h.jsx("i",{className:`wx-hQ64J4 wx-icon ${m}`}):null]})}function Ti({date:t,type:e,part:n,onShift:s}){const{calendar:r,formats:o}=l.useContext(We).getRaw(),a=t.getFullYear(),i=l.useMemo(()=>{switch(e){case"month":return St(o.monthYearFormat,r)(t);case"year":return St(o.yearFormat,r)(t);case"duodecade":{const{start:u,end:d}=Ir(a),f=St(o.yearFormat,r);return`${f(new Date(u,0,1))} - ${f(new Date(d,11,31))}`}default:return""}},[t,e,a,r,o]);function c(){s&&s({diff:0,type:e})}return h.jsxs("div",{className:"wx-8HQVQV wx-header",children:[n!=="right"?h.jsx("i",{className:"wx-8HQVQV wx-pager wxi-angle-left",onClick:()=>s&&s({diff:-1,type:e})}):h.jsx("span",{className:"wx-8HQVQV wx-spacer"}),h.jsx("span",{className:"wx-8HQVQV wx-label",onClick:c,children:i}),n!=="left"?h.jsx("i",{className:"wx-8HQVQV wx-pager wxi-angle-right",onClick:()=>s&&s({diff:1,type:e})}):h.jsx("span",{className:"wx-8HQVQV wx-spacer"})]})}function ms({onClick:t,children:e}){return h.jsx("button",{className:"wx-3s8W4d wx-button",onClick:t,children:e})}function Ri({value:t,current:e,part:n="",markers:s=null,onCancel:r,onChange:o}){const a=(l.useContext(We)||Qt()).getRaw().calendar,i=(a.weekStart||7)%7,c=a.dayShort.slice(i).concat(a.dayShort.slice(0,i)),u=(S,C,k)=>new Date(S.getFullYear(),S.getMonth()+(C||0),S.getDate()+(k||0));let d=n!=="normal";function f(S){const C=S.getDay();return C===0||C===6}function m(){const S=u(e,0,1-e.getDate());return S.setDate(S.getDate()-(S.getDay()-(i-7))%7),S}function p(){const S=u(e,1,-e.getDate());return S.setDate(S.getDate()+(6-S.getDay()+i)%7),S}const g=l.useRef(0);function x(S,C){C.timeStamp!==g.current&&(g.current=C.timeStamp,C.stopPropagation(),o&&o(new Date(new Date(S))),r&&r())}const w=l.useMemo(()=>n=="normal"?[t?u(t).valueOf():0]:t?[t.start?u(t.start).valueOf():0,t.end?u(t.end).valueOf():0]:[0,0],[n,t]),y=l.useMemo(()=>{const S=m(),C=p(),k=e.getMonth();let j=[];for(let N=S;N<=C;N.setDate(N.getDate()+1)){const _={day:N.getDate(),in:N.getMonth()===k,date:N.valueOf()};let $="";if($+=_.in?"":" wx-inactive",$+=w.indexOf(_.date)>-1?" wx-selected":"",d){const M=_.date==w[0],E=_.date==w[1];M&&!E?$+=" wx-left":E&&!M&&($+=" wx-right"),_.date>w[0]&&_.date<w[1]&&($+=" wx-inrange")}if($+=f(N)?" wx-weekend":"",s){const M=s(N);M&&($+=" "+M)}j.push({..._,css:$})}return j},[e,w,d,s]),v=l.useRef(null);let b=l.useRef({});return b.current.click=x,l.useEffect(()=>{Rr(v.current,b.current)},[]),h.jsxs("div",{children:[h.jsx("div",{className:"wx-398RBS wx-weekdays",children:c.map(S=>h.jsx("div",{className:"wx-398RBS wx-weekday",children:S},S))}),h.jsx("div",{className:"wx-398RBS wx-days",ref:v,children:y.map(S=>h.jsx("div",{className:`wx-398RBS wx-day ${S.css} ${S.in?"":"wx-out"}`,"data-id":S.date,children:S.day},S.date))})]})}function Di({value:t,current:e,part:n,onCancel:s,onChange:r,onShift:o}){const[a,i]=ke(t||new Date),[c,u]=ke(e||new Date),d=l.useContext(We).getRaw().calendar,f=d.monthShort||[],m=l.useMemo(()=>c.getMonth(),[c]),p=l.useCallback((w,y)=>{if(w!=null){y.stopPropagation();const v=new Date(c);v.setMonth(w),u(v),o&&o({current:v})}n==="normal"&&i(new Date(c)),s&&s()},[c,n,o,s]),g=l.useCallback(()=>{const w=new Date(Lr(a,n)||c);w.setMonth(c.getMonth()),w.setFullYear(c.getFullYear()),r&&r(w)},[a,c,n,r]),x=l.useCallback(w=>{const y=w.target.closest("[data-id]");if(y){const v=parseInt(y.getAttribute("data-id"),10);p(v,w)}},[p]);return h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"wx-34U8T8 wx-months",onClick:x,children:f.map((w,y)=>h.jsx("div",{className:"wx-34U8T8 wx-month"+(m===y?" wx-current":""),"data-id":y,children:w},y))}),h.jsx("div",{className:"wx-34U8T8 wx-buttons",children:h.jsx(ms,{onClick:g,children:d.done})})]})}const An="wx-1XEF33",Ii=({value:t,current:e,onCancel:n,onChange:s,onShift:r,part:o})=>{const a=l.useContext(We).getRaw().calendar,[i,c]=ke(e),[u,d]=ke(t),f=l.useMemo(()=>i.getFullYear(),[i]),m=l.useMemo(()=>{const{start:y,end:v}=Ir(f),b=[];for(let S=y;S<=v;++S)b.push(S);return b},[f]),p={click:g};function g(y,v){if(y){v.stopPropagation();const b=new Date(i);b.setFullYear(y),c(b),r&&r({current:b})}o==="normal"&&d(new Date(i)),n&&n()}function x(){const y=new Date(Lr(u,o)||i);y.setFullYear(i.getFullYear()),s&&s(y)}const w=l.useRef(null);return l.useEffect(()=>{w.current&&Rr(w.current,p)},[]),h.jsxs(h.Fragment,{children:[h.jsx("div",{className:An+" wx-years",ref:w,children:m.map((y,v)=>h.jsx("div",{className:An+` wx-year ${f==y?"wx-current":""} ${v===0?"wx-prev-decade":""} ${v===11?"wx-next-decade":""}`,"data-id":y,children:y},v))}),h.jsx("div",{className:An+" wx-buttons",children:h.jsx(ms,{onClick:x,children:a.done})})]})},Bs={month:{component:Ri,next:Ai,prev:Pi},year:{component:Di,next:Hi,prev:Li},duodecade:{component:Ii,next:Wi,prev:Oi}};function Pi(t){return t=new Date(t),t.setMonth(t.getMonth()-1),t}function Ai(t){return t=new Date(t),t.setMonth(t.getMonth()+1),t}function Li(t){return t=new Date(t),t.setFullYear(t.getFullYear()-1),t}function Hi(t){return t=new Date(t),t.setFullYear(t.getFullYear()+1),t}function Oi(t){return t=new Date(t),t.setFullYear(t.getFullYear()-10),t}function Wi(t){return t=new Date(t),t.setFullYear(t.getFullYear()+10),t}function Lr(t,e){let n;if(e==="normal")n=t;else{const{start:s,end:r}=t;e==="left"?n=s:e=="right"?n=r:n=s&&r}return n}const zi=["clear","today"];function Fi(t){if(t==="done")return-1;if(t==="clear")return null;if(t==="today")return new Date}function Vi({value:t,current:e,onCurrentChange:n,part:s="normal",markers:r=null,buttons:o,onShift:a,onChange:i}){const c=l.useContext(We).getGroup("calendar"),[u,d]=l.useState("month"),f=Array.isArray(o)?o:o?zi:[],m=(y,v)=>{y.preventDefault(),i&&i({value:v})},p=()=>{u==="duodecade"?d("year"):u==="year"&&d("month")},g=y=>{const{diff:v,current:b}=y;if(v===0){u==="month"?d("year"):u==="year"&&d("duodecade");return}if(v){const S=Bs[u];n(v>0?S.next(e):S.prev(e))}else b&&n(b);a&&a()},x=y=>{d("month"),i&&i({select:!0,value:y})},w=l.useMemo(()=>Bs[u].component,[u]);return h.jsx("div",{className:`wx-2Gr4AS wx-calendar ${s!=="normal"&&s!=="both"?"wx-part":""}`,children:h.jsxs("div",{className:"wx-2Gr4AS wx-wrap",children:[h.jsx(Ti,{date:e,part:s,type:u,onShift:g}),h.jsxs("div",{children:[h.jsx(w,{value:t,current:e,onCurrentChange:n,part:s,markers:r,onCancel:p,onChange:x,onShift:g}),u==="month"&&f.length>0&&h.jsx("div",{className:"wx-2Gr4AS wx-buttons",children:f.map(y=>h.jsx("div",{className:"wx-2Gr4AS wx-button-item",children:h.jsx(ms,{onClick:v=>m(v,Fi(y)),children:c(y)})},y))})]})]})})}function Xt(t){let{words:e=null,optional:n=!1,children:s}=t,r=l.useContext(We);const o=l.useMemo(()=>{let a=r;return(!a||!a.extend)&&(a=Nt(bn)),e!==null&&(a=a.extend(e,n)),a},[e,n,r]);return h.jsx(We.Provider,{value:o,children:s})}function Ys(t,e,n,s){if(!t||s){const r=e?new Date(e):new Date;r.setDate(1),n(r)}else if(t.getDate()!==1){const r=new Date(t);r.setDate(1),n(r)}}const Bi=["clear","today"];function Hr({value:t,current:e,markers:n=null,buttons:s=Bi,onChange:r}){const[o,a]=ke(t),[i,c]=ke(e);l.useEffect(()=>{Ys(i,o,c,!1)},[o,i]);const u=l.useCallback(f=>{const m=f.value;m?(a(new Date(m)),Ys(i,new Date(m),c,!0)):a(null),r&&r({value:m?new Date(m):null})},[r,i]),d=l.useCallback(f=>{c(f)},[c]);return i?h.jsx(Xt,{children:h.jsx(Vi,{value:o,current:i,markers:n,buttons:s,onChange:u,onCurrentChange:d})}):null}const Yi=["clear","today"];function Gi({value:t,id:e=Qe(),disabled:n=!1,error:s=!1,width:r="unset",align:o="start",placeholder:a="",format:i="",buttons:c=Yi,css:u="",title:d="",editable:f=!1,clear:m=!1,onChange:p}){const{calendar:g,formats:x}=(l.useContext(We)||Qt()).getRaw(),w=i||(x==null?void 0:x.dateFormat);let y=typeof w=="function"?w:St(w,g);const[v,b]=l.useState(t),[S,C]=l.useState(!1);l.useEffect(()=>{b(t)},[t]);function k(){C(!1)}function j($){const M=$===v||$&&v&&$.valueOf()===v.valueOf()||!$&&!v;b($),M||p&&p({value:$}),setTimeout(k,1)}const N=l.useMemo(()=>v?y(v):"",[v,y]);function _({value:$,input:M}){if(!f&&!m||M)return;let E=typeof f=="function"?f($):$?new Date($):null;E=isNaN(E)?v||null:E||null,j(E)}return l.useEffect(()=>{const $=k;return window.addEventListener("scroll",$),()=>window.removeEventListener("scroll",$)},[]),h.jsxs("div",{className:"wx-1lKOFG wx-datepicker",onClick:()=>C(!0),children:[h.jsx(Sn,{css:u,title:d,value:N,id:e,readonly:!f,disabled:n,error:s,placeholder:a,onInput:k,onChange:_,icon:"wxi-calendar",inputStyle:{cursor:"pointer",width:"100%",paddingRight:"calc(var(--wx-input-icon-size) + var(--wx-input-icon-indent) * 2)"},clear:m}),S&&!n&&h.jsx(Et,{onCancel:k,width:r,align:o,autoFit:!!o,children:h.jsx(Hr,{buttons:c,value:v,onChange:$=>j($.value)})})]})}function Or({value:t="",options:e=[],textOptions:n=null,placeholder:s="",disabled:r=!1,error:o=!1,title:a="",textField:i="label",clear:c=!1,children:u,onChange:d}){const f=l.useRef(null),m=l.useRef(null);let[p,g]=ke(t);function x(S){f.current=S.navigate,m.current=S.keydown}const w=l.useMemo(()=>p||p===0?(n||e).find(S=>S.id===p):null,[p,n,e]),y=l.useCallback(({id:S})=>{(S||S===0)&&(g(S),f.current(null),d&&d({value:S}))},[g,d]),v=l.useCallback(S=>{S.stopPropagation(),g(""),d&&d({value:""})},[g,d]),b=l.useCallback(()=>e.findIndex(S=>S.id===p),[e,p]);return h.jsxs("div",{className:`wx-2YgblL wx-richselect ${o?"wx-2YgblL wx-error":""} ${r?"wx-2YgblL wx-disabled":""} ${u?"":"wx-2YgblL wx-nowrap"}`,title:a,onClick:()=>f.current(b()),onKeyDown:S=>m.current(S,b()),tabIndex:0,children:[h.jsx("div",{className:"wx-2YgblL wx-label",children:w?u?u(w):w[i]:s?h.jsx("span",{className:"wx-2YgblL wx-placeholder",children:s}):"Â "}),c&&!r&&p?h.jsx("i",{className:"wx-2YgblL wx-icon wxi-close",onClick:v}):h.jsx("i",{className:"wx-2YgblL wx-icon wxi-angle-down"}),!r&&h.jsx(kn,{items:e,onReady:x,onSelect:y,children:({option:S})=>u?u(S):S[i]})]})}function Gn({id:t=Qe(),label:e="",css:n="",min:s=0,max:r=100,value:o=0,step:a=1,title:i="",disabled:c=!1,onChange:u}){const[d,f]=ke(o),m=l.useRef({value:d,input:d}),p=l.useMemo(()=>(d-s)/(r-s)*100+"%",[d,s,r]),g=l.useMemo(()=>c?"":`linear-gradient(90deg, var(--wx-slider-primary) 0% ${p}, var(--wx-slider-background) ${p} 100%)`,[c,p]);function x({target:v}){const b=v.value*1;f(b),u&&u({value:b,previous:m.current.input,input:!0}),m.current.input=b}function w({target:v}){const b=v.value*1;f(b),u&&u({value:b,previous:m.current.value}),m.current.value=b}l.useEffect(()=>{f(o)},[o]);const y=l.useRef(null);return l.useEffect(()=>{if(y.current)return y.current.addEventListener("change",w),()=>{y.current&&y.current.removeEventListener("change",w)}},[y,w]),h.jsxs("div",{className:`wx-2EDJ8G wx-slider ${n}`,title:i,children:[e&&h.jsx("label",{className:"wx-2EDJ8G wx-label",htmlFor:t,children:e}),h.jsx("div",{className:"wx-2EDJ8G wx-inner",children:h.jsx("input",{id:t,className:"wx-2EDJ8G wx-input",type:"range",min:s,max:r,step:a,disabled:c,value:d,onInput:x,style:{background:g},ref:y})})]})}const Ui=({id:t=Qe(),value:e=0,step:n=1,min:s=0,max:r=1/0,error:o=!1,disabled:a=!1,readonly:i=!1,onChange:c})=>{const[u,d]=ke(e),f=l.useCallback(()=>{if(i||u<=s)return;const x=u-n;d(x),c&&c({value:x})},[u,i,s,n,c]),m=l.useCallback(()=>{if(i||u>=r)return;const x=u+n;d(x),c&&c({value:x})},[u,i,r,n,c]),p=l.useCallback(()=>{if(!i){const x=Math.round(Math.min(r,Math.max(u,s))/n)*n,w=isNaN(x)?Math.max(s,0):x;d(w),c&&c({value:w})}},[i,u,r,s,n,c]),g=l.useCallback(x=>{const w=x.target.value*1;d(w),c&&c({value:w,input:!0})},[c]);return h.jsxs("div",{className:`wx-22t21n wx-counter ${a?"wx-disabled":""} ${i?"wx-readonly":""} ${o?"wx-error":""}`,children:[h.jsx("button",{"aria-label":"-",className:"wx-22t21n wx-btn wx-btn-dec",disabled:a,onClick:f,children:h.jsx("svg",{className:"wx-22t21n wx-dec",width:"12",height:"2",viewBox:"0 0 12 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:h.jsx("path",{d:"M11.2501 1.74994H0.750092V0.249939H11.2501V1.74994Z"})})}),h.jsx("input",{id:t,type:"text",className:"wx-22t21n wx-input",disabled:a,readOnly:i,required:!0,value:u,onBlur:p,onInput:g}),h.jsx("button",{"aria-label":"-",className:"wx-22t21n wx-btn wx-btn-inc",disabled:a,onClick:m,children:h.jsx("svg",{className:"wx-22t21n wx-inc",width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:h.jsx("path",{d:`M11.2501
								6.74994H6.75009V11.2499H5.25009V6.74994H0.750092V5.24994H5.25009V0.749939H6.75009V5.24994H11.2501V6.74994Z`})})})]})};function Ki({notice:t={}}){function e(){t.remove&&t.remove()}return h.jsxs("div",{className:`wx-11sNg5 wx-notice wx-${t.type?t.type:""}`,role:"status","aria-live":"polite",children:[h.jsx("div",{className:"wx-11sNg5 wx-text",children:t.text}),h.jsx("div",{className:"wx-11sNg5 wx-button",children:h.jsx("i",{className:"wx-11sNg5 wxi-close",onClick:e})})]})}function qi({data:t=[]}){return h.jsx("div",{className:"wx-3nwoO9 wx-notices",children:t.map(e=>h.jsx(Ki,{notice:e},e.id))})}function Qi({title:t="",buttons:e=["cancel","ok"],header:n,children:s,footer:r,onConfirm:o,onCancel:a}){const i=(l.useContext(We)||Qt()).getGroup("core"),c=l.useRef(null);l.useEffect(()=>{var f;(f=c.current)==null||f.focus()},[]);function u(f){switch(f.code){case"Enter":{const m=f.target.tagName;if(m==="TEXTAREA"||m==="BUTTON")return;o&&o({event:f});break}case"Escape":a&&a({event:f});break}}function d(f,m){const p={event:f,button:m};m==="cancel"?a&&a(p):o&&o(p)}return h.jsx("div",{className:"wx-1FxkZa wx-modal",ref:c,tabIndex:0,onKeyDown:u,children:h.jsxs("div",{className:"wx-1FxkZa wx-window",children:[n||(t?h.jsx("div",{className:"wx-1FxkZa wx-header",children:t}):null),h.jsx("div",{children:s}),r||e&&h.jsx("div",{className:"wx-1FxkZa wx-buttons",children:e.map(f=>h.jsx("div",{className:"wx-1FxkZa wx-button",children:h.jsx(dt,{type:`block ${f==="ok"?"primary":"secondary"}`,onClick:m=>d(m,f),children:i(f)})},f))})]})})}function Xi({children:t},e){const[n,s]=l.useState(null),[r,o]=l.useState([]);return l.useImperativeHandle(e,()=>({showModal:a=>{const i={...a};return s(i),new Promise((c,u)=>{i.resolve=d=>{s(null),c(d)},i.reject=d=>{s(null),u(d)}})},showNotice:a=>{a={...a},a.id=a.id||Qe(),a.remove=()=>o(i=>i.filter(c=>c.id!==a.id)),a.expire!=-1&&setTimeout(a.remove,a.expire||5100),o(i=>[...i,a])}}),[]),h.jsxs(h.Fragment,{children:[t,n&&h.jsx(Qi,{title:n.title,buttons:n.buttons,onConfirm:n.resolve,onCancel:n.reject,children:n.message}),h.jsx(qi,{data:r})]})}l.forwardRef(Xi);function Yt({label:t="",position:e="",css:n="",error:s=!1,type:r="",required:o=!1,children:a}){const i=l.useMemo(()=>Qe(),[]);return h.jsxs("div",{className:`wx-2oVUvC wx-field wx-${e} ${n} ${s?"wx-error":""} ${o?"wx-required":""}`.trim(),children:[t&&h.jsx("label",{className:"wx-2oVUvC wx-label",htmlFor:i,children:t}),h.jsx("div",{className:`wx-2oVUvC wx-field-control wx-${r}`,children:hs(a,{id:i})})]})}const Wr=({value:t=!1,type:e="",icon:n="",disabled:s=!1,iconActive:r="",onClick:o,title:a="",css:i="",text:c="",textActive:u="",children:d,active:f,onChange:m})=>{const[p,g]=ke(t),x=l.useMemo(()=>(p?"pressed":"")+(e?" "+e:""),[p,e]),w=l.useCallback(y=>{let v=!p;o&&o(y),y.defaultPrevented||(g(v),m&&m({value:v}))},[p,o,m]);return p&&f?h.jsx(dt,{title:a,text:p&&u||c,css:i,type:x,icon:p&&r||n,onClick:w,disabled:s,children:hs(f,{value:p})}):d?h.jsx(dt,{title:a,text:p&&u||c,css:i,type:x,icon:p&&r||n,onClick:w,disabled:s,children:d}):h.jsx(dt,{title:a,text:p&&u||c,css:i,type:x,icon:p&&r||n,onClick:w,disabled:s})},Gs=new Date(0,0,0,0,0);function Ji({value:t=Gs,id:e,title:n="",css:s="",disabled:r=!1,error:o=!1,format:a="",onChange:i}){let[c,u]=ke(t);const{calendar:d,formats:f}=(l.useContext(We)||Qt()).getRaw(),m=d.clockFormat==12,p=23,g=59,x=l.useMemo(()=>{const I=a||(f==null?void 0:f.timeFormat);return typeof I=="function"?I:St(I,d)},[a,f,d]),w=l.useMemo(()=>x(new Date(0,0,0,1)).indexOf("01")!=-1,[x]),y=(I,X)=>(I<10&&X?`0${I}`:`${I}`).slice(-2),v=I=>y(I,!0),b=I=>`${I}`.replace(/[^\d]/g,"")||0,S=I=>m&&(I=I%12,I===0)?"12":y(I,w),C=l.useCallback((I,X)=>(I=b(I),Math.min(I,X)),[]),[k,j]=l.useState(null),N=c||Gs,_=C(N.getHours(),p),$=C(N.getMinutes(),g),M=_>12,E=S(_),L=v($),P=l.useMemo(()=>x(new Date(0,0,0,_,$)),[_,$,x]),W=l.useCallback(()=>{j(!0)},[]),V=l.useCallback(()=>{const I=new Date(N);I.setHours(I.getHours()+(M?-12:12)),u(I),i&&i({value:I})},[N,M,i]),ee=l.useCallback(({value:I})=>{if(N.getHours()===I)return;const X=new Date(N);X.setHours(I),u(X),i&&i({value:X})},[N,i]),O=l.useCallback(({value:I})=>{if(N.getMinutes()===I)return;const X=new Date(N);X.setMinutes(I),u(X),i&&i({value:X})},[N,i]),H=l.useCallback(I=>(I=C(I,p),m&&(I=I*1,I===12&&(I=0),M&&(I+=12)),I),[C,m,M]),z=l.useCallback(()=>{j(null)},[]);return h.jsxs("div",{className:`wx-7f497i wx-timepicker ${o?"wx-7f497i wx-error":""} ${r?"wx-7f497i wx-disabled":""}`,onClick:r?void 0:W,style:{cursor:r?"default":"pointer"},children:[h.jsx(Sn,{id:e,css:s,title:n,value:P,readonly:!0,disabled:r,error:o,icon:"wxi-clock",inputStyle:{cursor:"pointer",width:"100%",paddingRight:"calc(var(--wx-input-icon-size) + var(--wx-input-icon-indent) * 2)"}}),k&&!r&&h.jsx(Et,{onCancel:z,width:"unset",children:h.jsxs("div",{className:"wx-7f497i wx-wrapper",children:[h.jsxs("div",{className:"wx-7f497i wx-timer",children:[h.jsx("input",{className:"wx-7f497i wx-digit",value:E,onChange:I=>{const X=H(I.target.value);ee({value:X})}}),h.jsx("div",{className:"wx-7f497i wx-separator",children:":"}),h.jsx("input",{className:"wx-7f497i wx-digit",value:L,onChange:I=>{const X=C(I.target.value,g);O({value:X})}}),m&&h.jsx(Wr,{value:M,onClick:V,active:()=>h.jsx("span",{children:"pm"}),children:h.jsx("span",{children:"am"})})]}),h.jsx(Yt,{width:"unset",children:h.jsx(Gn,{label:d.hours,value:_,onChange:ee,max:p})}),h.jsx(Yt,{width:"unset",children:h.jsx(Gn,{label:d.minutes,value:$,onChange:O,max:g})})]})})]})}function Zi({children:t}){return h.jsx("div",{className:"wx-KgpO9N wx-modal",children:h.jsx("div",{className:"wx-KgpO9N wx-window",children:t})})}function el({position:t="right",children:e,onCancel:n}){const s=l.useRef(null);return l.useEffect(()=>qt(s.current,n).destroy,[]),h.jsx("div",{ref:s,className:`wx-2L733M wx-sidearea wx-pos-${t}`,children:e})}function zr({theme:t="",target:e,children:n}){const s=l.useRef(null),r=l.useRef(null),[o,a]=l.useState(null);s.current||(s.current=document.createElement("div"));const i=l.useContext(ps);return l.useEffect(()=>{a(e||tl(r.current)||Pe.getTopNode(r.current))},[r.current]),h.jsxs(h.Fragment,{children:[h.jsx("span",{ref:r,style:{display:"none"}}),r.current&&o?us.createPortal(h.jsx("div",{className:`wx-3ZWsT0 wx-${t||i}-theme`,children:n}),o):null]})}function tl(t){const e=Pe.getTopNode(t);for(;t&&t!==e&&!t.getAttribute("data-wx-portal-root");)t=t.parentNode;return t}function nl(){return h.jsx(h.Fragment,{})}function Us(t){const{fonts:e=!0,children:n}=t;return h.jsx(ps.Provider,{value:"willow",children:h.jsxs(h.Fragment,{children:[n&&n&&h.jsx("div",{className:"wx-willow-theme",children:n}),e&&h.jsxs(h.Fragment,{children:[h.jsx("link",{rel:"preconnect",href:"https://cdn.webix.com",crossOrigin:"true"}),h.jsx(nl,{}),h.jsx("link",{rel:"stylesheet",href:"https://webix.io/dev/fonts/wxi/wx-icons.css"})]})]})})}fs(Pe);const Cn={gantt:{"Task name":"Task name","Start date":"Start date","Add task":"Add task",Duration:"Duration",Task:"Task",Milestone:"Milestone","Summary task":"Summary task",Save:"Save",Delete:"Delete",Name:"Name",Description:"Description","Select type":"Select type",Type:"Type","End date":"End date",Progress:"Progress",Predecessors:"Predecessors",Successors:"Successors","Add task name":"Add task name","Add description":"Add description","Select link type":"Select link type","End-to-start":"End-to-start","Start-to-start":"Start-to-start","End-to-end":"End-to-end","Start-to-end":"Start-to-end",Add:"Add","Child task":"Child task","Task above":"Task above","Task below":"Task below","Convert to":"Convert to",Edit:"Edit",Cut:"Cut",Copy:"Copy",Paste:"Paste",Move:"Move",Up:"Up",Down:"Down",Indent:"Indent",Outdent:"Outdent","Split task":"Split task","New task":"New task","Move up":"Move up","Move down":"Move down"}};var sl=new Date().valueOf(),rl=()=>sl++;function ol(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in e){const s=t[n],r=e[n];if(!jn(s,r))return!1}return!0}function jn(t,e){if(typeof t=="number"||typeof t=="string"||typeof t=="boolean"||t===null)return t===e;if(typeof t!=typeof e||(t===null||e===null)&&t!==e||t instanceof Date&&e instanceof Date&&t.getTime()!==e.getTime())return!1;if(typeof t=="object")if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(let s=t.length-1;s>=0;s--)if(!jn(t[s],e[s]))return!1;return!0}else return ol(t,e);return t===e}function mn(t){if(typeof t!="object"||t===null)return t;if(t instanceof Date)return new Date(t);if(t instanceof Array)return t.map(mn);const e={};for(const n in t)e[n]=mn(t[n]);return e}var Fr=class{constructor(t){this._nextHandler=null,this._dispatch=t,this.exec=this.exec.bind(this)}async exec(t,e){return this._dispatch(t,e),this._nextHandler&&await this._nextHandler.exec(t,e),e}setNext(t){return this._nextHandler=t}},Vr=new Date().valueOf(),al=()=>Vr++;function Br(){return"temp://"+Vr++}var Ks=class{constructor(t){this._data=t,this._pool=new Map;for(let e=0;e<t.length;e++){const n=t[e];this._pool.set(n.id,n)}}add(t){t={id:al(),...t},this._data.push(t),this._pool.set(t.id,t)}update(t,e){const n=this._data.findIndex(r=>r.id==t),s={...this._data[n],...e};this._data[n]=s,this._pool.set(s.id,s)}remove(t){this._data=this._data.filter(e=>e.id!=t),this._pool.delete(t)}filter(t){this._data=this._data.filter(e=>{const n=t(e);return n||this._pool.delete(e.id),n})}byId(t){return this._pool.get(t)}map(t){return this._data.map(t)}forEach(t){this._data.forEach(t)}},il=class{constructor(e){const n={id:0,$level:0,data:[],parent:null},s=new Map;s.set(0,n),this._pool=s,e&&e.length&&this.parse(e,0)}parse(e,n){const s=this._pool;for(let o=0;o<e.length;o++){const a=e[o];a.parent=a.parent||n,a.data=null,s.set(a.id,a)}for(let o=0;o<e.length;o++){const a=e[o],i=s.get(a.parent);i&&(i.data||(i.data=[]),i.data.push(a))}const r=s.get(n);this.setLevel(r,r.$level+1,!1)}add(e,n){const s=this._pool.get(e.parent||0);e.$level=s.$level+1,this._pool.set(e.id,e),s.data?n===-1?s.data=[...s.data,e]:qs(s,n,e):s.data=[e]}addAfter(e,n){if(!n)return this.add(e,-1);const s=this.byId(n),r=this.byId(s.parent),o=an(r,s.id)+1;e.parent=r.id,e.$level=r.$level+1,this.add(e,o)}remove(e){const n=this._pool.get(e);this._remove(n);const s=this._pool.get(n.parent);s.data=s.data.filter(r=>r.id!=e),this._clearBranch(s)}_remove(e){e.data&&e.data.forEach(n=>this._remove(n)),this._pool.delete(e.id)}update(e,n){let s=this._pool.get(e);const r=this._pool.get(s.parent),o=an(r,s.id);s={...s,...n},r&&o>=0&&(r.data[o]=s,r.data=[...r.data]),this._pool.set(s.id,s)}move(e,n,s){const r=this._pool.get(e),o=n==="child",a=this._pool.get(s),i=a.$level+(o?1:0);if(!r||!a)return;const c=this._pool.get(r.parent),u=o?a:this._pool.get(a.parent);u.data||(u.data=[]);const d=an(c,r.id);ll(c,d);const f=o?u.data.length:an(u,a.id)+(n==="after"?1:0);if(qs(u,f,r),c.id===u.id&&d===f)return null;r.parent=u.id,r.$level!==i&&(r.$level=i,this.setLevel(r,i+1,!0)),this.update(r.id,r),this._clearBranch(c)}_clearBranch(e){e.data&&!e.data.length&&(e.open&&delete e.open,this.update(e.id,{data:null}))}toArray(){const e=[],n=this._pool.get(0).data;return n&&Yr(n,e),e}byId(e){return this._pool.get(e)}getBranch(e){return this._pool.get(e).data}forEach(e){this._pool.forEach((n,s)=>{s!==0&&e(n)})}eachChild(e,n){const s=this.byId(n);!s||!s.data||s.data.forEach((r,o)=>{e(this.byId(r.id),o),this.eachChild(e,r.id)})}setLevel(e,n,s){e.data&&(e.data=e.data.map(r=>(s&&(r={...r},this._pool.set(r.id,r)),r.$level=n,r.data&&this.setLevel(r,n+1,s),r)))}};function Yr(t,e){t.forEach(n=>{e.push(n),n.open===!0&&Yr(n.data,e)})}function ll(t,e){const n=[...t.data];n.splice(e,1),t.data=n}function qs(t,e,n){const s=[...t.data];s.splice(e,0,n),t.data=s}function an(t,e){return t==null?void 0:t.data.findIndex(n=>n.id===e)}var Gr=2,cl=class{constructor(e){e&&(this._writable=e.writable,this._async=e.async),this._values={},this._state={}}setState(e,n=0){const s={};return this._wrapProperties(e,this._state,this._values,"",s,n),s}getState(){return this._values}getReactive(){return this._state}_wrapProperties(e,n,s,r,o,a){for(const i in e){const c=n[i],u=s[i],d=e[i];if(c&&(u===d&&typeof d!="object"||d instanceof Date&&u instanceof Date&&u.getTime()===d.getTime()))continue;const f=r+(r?".":"")+i;c?(c.__parse(d,f,o,a)&&(s[i]=d),a&Gr?o[f]=c.__trigger:c.__trigger()):(d&&d.__reactive?n[i]=this._wrapNested(d,d,f,o):n[i]=this._wrapWritable(d),s[i]=d),o[f]=o[f]||null}}_wrapNested(e,n,s,r){const o=this._wrapWritable(e);return this._wrapProperties(e,o,n,s,r,0),o.__parse=(a,i,c,u)=>(this._wrapProperties(a,o,n,i,c,u),!1),o}_wrapWritable(e){const n=[],s=function(){for(let r=0;r<n.length;r++)n[r](e)};return{subscribe:r=>(n.push(r),this._async?setTimeout(r,1,e):r(e),()=>{const o=n.indexOf(r);o>=0&&n.splice(o,1)}),__trigger:()=>{n.length&&(this._async?setTimeout(s,1):s())},__parse:function(r){return e=r,!0}}}},ul=class{constructor(e,n,s,r){typeof e=="function"?this._setter=e:this._setter=e.setState.bind(e),this._routes=n,this._parsers=s,this._prev={},this._triggers=new Map,this._sources=new Map,this._routes.forEach(o=>{o.in.forEach(a=>{const i=this._triggers.get(a)||[];i.push(o),this._triggers.set(a,i)}),o.out.forEach(a=>{const i=this._sources.get(a)||{};o.in.forEach(c=>i[c]=!0),this._sources.set(a,i)})}),this._routes.forEach(o=>{o.length=Math.max(...o.in.map(a=>Ur(a,this._sources,1)))}),this._bus=r}init(e){const n={};for(const s in e)if(this._prev[s]!==e[s]){const r=this._parsers[s];n[s]=r?r(e[s]):e[s]}this._prev=this._prev?{...this._prev,...e}:{...e},this.setState(n),this._bus&&this._bus.exec("init-state",n)}setStateAsync(e){const n=this._setter(e,Gr);return this._async?Object.assign(this._async.signals,n):this._async={signals:n,timer:setTimeout(this._applyState.bind(this),1)},n}_applyState(){const e=this._async;if(e){this._async=null,this._triggerUpdates(e.signals,[]);for(const n in e.signals){const s=e.signals[n];s&&s()}}}setState(e,n=[]){const s=this._setter(e);return this._triggerUpdates(s,n),s}_triggerUpdates(e,n){const s=Object.keys(e),r=!n.length;n=n||[];for(let o=0;o<s.length;o++){const a=s[o],i=this._triggers.get(a);i&&i.forEach(c=>{n.indexOf(c)==-1&&n.push(c)})}r&&this._execNext(n)}_execNext(e){for(;e.length;){e.sort((s,r)=>s.length<r.length?1:-1);const n=e[e.length-1];e.splice(e.length-1),n.exec(e)}}};function Ur(t,e,n){const s=e.get(t);if(!s)return n;const r=Object.keys(s).map(o=>Ur(o,e,n+1));return Math.max(...r)}var dl=class{constructor(){this._nextHandler=null,this._handlers={},this._tag=new WeakMap,this.exec=this.exec.bind(this)}on(e,n,s){let r=this._handlers[e];r?s&&s.intercept?r.unshift(n):r.push(n):r=this._handlers[e]=[n],s&&s.tag&&this._tag.set(n,s.tag)}intercept(e,n,s){this.on(e,n,{...s,intercept:!0})}detach(e){for(const n in this._handlers){const s=this._handlers[n];for(let r=s.length-1;r>=0;r--)this._tag.get(s[r])===e&&s.splice(r,1)}}async exec(e,n){const s=this._handlers[e];if(s)for(let r=0;r<s.length;r++){const o=s[r](n);if(o===!1||o&&o.then&&await o===!1)return}return this._nextHandler&&await this._nextHandler.exec(e,n),n}setNext(e){return this._nextHandler=e}};function fl(t,e){return typeof t=="string"?t.localeCompare(e,void 0,{numeric:!0}):typeof t=="object"?t.getTime()-e.getTime():(t??0)-(e??0)}function hl(t,e){return typeof t=="string"?-t.localeCompare(e,void 0,{numeric:!0}):typeof e=="object"?e.getTime()-t.getTime():(e??0)-(t??0)}function pl({key:t,order:e}){const n=e==="asc"?fl:hl;return(s,r)=>n(s[t],r[t])}function ml(t){if(!t||!t.length)return;const e=t.map(n=>pl(n));return t.length===1?e[0]:function(n,s){for(let r=0;r<e.length;r++){const o=e[r](n,s);if(o!==0)return o}return 0}}function xl(t,e){return t.sort(ml(e))}function ae(t){const e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new t.constructor(+t):typeof t=="number"||e==="[object Number]"||typeof t=="string"||e==="[object String]"?new Date(t):new Date(NaN)}function ze(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}function Mn(t,e){const n=ae(t);return isNaN(e)?ze(t,NaN):(e&&n.setDate(n.getDate()+e),n)}function xs(t,e){const n=ae(t);if(isNaN(e))return ze(t,NaN);if(!e)return n;const s=n.getDate(),r=ze(t,n.getTime());r.setMonth(n.getMonth()+e+1,0);const o=r.getDate();return s>=o?r:(n.setFullYear(r.getFullYear(),r.getMonth(),s),n)}function Kr(t,e){const n=+ae(t);return ze(t,n+e)}const _n=6048e5,gl=864e5,qr=6e4,Qr=36e5;function wl(t,e){return Kr(t,e*Qr)}let yl={};function $n(){return yl}function rt(t,e){var i,c,u,d;const n=$n(),s=(e==null?void 0:e.weekStartsOn)??((c=(i=e==null?void 0:e.locale)==null?void 0:i.options)==null?void 0:c.weekStartsOn)??n.weekStartsOn??((d=(u=n.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,r=ae(t),o=r.getDay(),a=(o<s?7:0)+o-s;return r.setDate(r.getDate()-a),r.setHours(0,0,0,0),r}function jt(t){return rt(t,{weekStartsOn:1})}function Xr(t){const e=ae(t),n=e.getFullYear(),s=ze(t,0);s.setFullYear(n+1,0,4),s.setHours(0,0,0,0);const r=jt(s),o=ze(t,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const a=jt(o);return e.getTime()>=r.getTime()?n+1:e.getTime()>=a.getTime()?n:n-1}function ft(t){const e=ae(t);return e.setHours(0,0,0,0),e}function xn(t){const e=ae(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}function gs(t,e){const n=ft(t),s=ft(e),r=+n-xn(n),o=+s-xn(s);return Math.round((r-o)/gl)}function Un(t){const e=Xr(t),n=ze(t,0);return n.setFullYear(e,0,4),n.setHours(0,0,0,0),jt(n)}function vl(t,e){return Kr(t,e*qr)}function bl(t,e){const n=e*3;return xs(t,n)}function Jr(t,e){const n=e*7;return Mn(t,n)}function kl(t,e){return xs(t,e*12)}function Ft(t,e){const n=ae(t),s=ae(e),r=n.getTime()-s.getTime();return r<0?-1:r>0?1:r}function Sl(t,e){const n=ft(t),s=ft(e);return+n==+s}function Cl(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function jl(t){if(!Cl(t)&&typeof t!="number")return!1;const e=ae(t);return!isNaN(Number(e))}function ws(t,e){const n=jt(t),s=jt(e),r=+n-xn(n),o=+s-xn(s);return Math.round((r-o)/_n)}function Ml(t,e){const n=ae(t),s=ae(e),r=n.getFullYear()-s.getFullYear(),o=n.getMonth()-s.getMonth();return r*12+o}function _l(t,e){const n=ae(t),s=ae(e);return n.getFullYear()-s.getFullYear()}function ys(t){return e=>{const n=(t?Math[t]:Math.trunc)(e);return n===0?0:n}}function Zr(t,e){return+ae(t)-+ae(e)}function $l(t,e,n){const s=Zr(t,e)/Qr;return ys(n==null?void 0:n.roundingMethod)(s)}function Nl(t,e,n){const s=Zr(t,e)/qr;return ys(n==null?void 0:n.roundingMethod)(s)}function El(t){const e=ae(t);return e.setHours(23,59,59,999),e}function eo(t){const e=ae(t),n=e.getMonth();return e.setFullYear(e.getFullYear(),n+1,0),e.setHours(23,59,59,999),e}function Tl(t){const e=ae(t);return+El(e)==+eo(e)}function to(t,e){const n=ae(t),s=ae(e),r=Ft(n,s),o=Math.abs(Ml(n,s));let a;if(o<1)a=0;else{n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-r*o);let i=Ft(n,s)===-r;Tl(ae(t))&&o===1&&Ft(t,s)===1&&(i=!1),a=r*(o-Number(i))}return a===0?0:a}function Rl(t,e,n){const s=to(t,e)/3;return ys(n==null?void 0:n.roundingMethod)(s)}function Dl(t,e){const n=ae(t),s=ae(e),r=Ft(n,s),o=Math.abs(_l(n,s));n.setFullYear(1584),s.setFullYear(1584);const a=Ft(n,s)===-r,i=r*(o-+a);return i===0?0:i}function Gt(t){const e=ae(t),n=e.getMonth(),s=n-n%3;return e.setMonth(s,1),e.setHours(0,0,0,0),e}function no(t){const e=ae(t);return e.setDate(1),e.setHours(0,0,0,0),e}function so(t){const e=ae(t),n=ze(t,0);return n.setFullYear(e.getFullYear(),0,1),n.setHours(0,0,0,0),n}function ro(t){const e=ae(t),n=e.getMonth(),s=n-n%3+3;return e.setMonth(s,0),e.setHours(23,59,59,999),e}const Il={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Pl=(t,e,n)=>{let s;const r=Il[t];return typeof r=="string"?s=r:e===1?s=r.one:s=r.other.replace("{{count}}",e.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+s:s+" ago":s};function Ln(t){return(e={})=>{const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const Al={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Ll={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Hl={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Ol={date:Ln({formats:Al,defaultWidth:"full"}),time:Ln({formats:Ll,defaultWidth:"full"}),dateTime:Ln({formats:Hl,defaultWidth:"full"})},Wl={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},zl=(t,e,n,s)=>Wl[t];function Lt(t){return(e,n)=>{const s=n!=null&&n.context?String(n.context):"standalone";let r;if(s==="formatting"&&t.formattingValues){const a=t.defaultFormattingWidth||t.defaultWidth,i=n!=null&&n.width?String(n.width):a;r=t.formattingValues[i]||t.formattingValues[a]}else{const a=t.defaultWidth,i=n!=null&&n.width?String(n.width):t.defaultWidth;r=t.values[i]||t.values[a]}const o=t.argumentCallback?t.argumentCallback(e):e;return r[o]}}const Fl={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Vl={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Bl={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Yl={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Gl={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Ul={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Kl=(t,e)=>{const n=Number(t),s=n%100;if(s>20||s<10)switch(s%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},ql={ordinalNumber:Kl,era:Lt({values:Fl,defaultWidth:"wide"}),quarter:Lt({values:Vl,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Lt({values:Bl,defaultWidth:"wide"}),day:Lt({values:Yl,defaultWidth:"wide"}),dayPeriod:Lt({values:Gl,defaultWidth:"wide",formattingValues:Ul,defaultFormattingWidth:"wide"})};function Ht(t){return(e,n={})=>{const s=n.width,r=s&&t.matchPatterns[s]||t.matchPatterns[t.defaultMatchWidth],o=e.match(r);if(!o)return null;const a=o[0],i=s&&t.parsePatterns[s]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(i)?Xl(i,f=>f.test(a)):Ql(i,f=>f.test(a));let u;u=t.valueCallback?t.valueCallback(c):c,u=n.valueCallback?n.valueCallback(u):u;const d=e.slice(a.length);return{value:u,rest:d}}}function Ql(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return n}function Xl(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return n}function Jl(t){return(e,n={})=>{const s=e.match(t.matchPattern);if(!s)return null;const r=s[0],o=e.match(t.parsePattern);if(!o)return null;let a=t.valueCallback?t.valueCallback(o[0]):o[0];a=n.valueCallback?n.valueCallback(a):a;const i=e.slice(r.length);return{value:a,rest:i}}}const Zl=/^(\d+)(th|st|nd|rd)?/i,ec=/\d+/i,tc={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},nc={any:[/^b/i,/^(a|c)/i]},sc={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},rc={any:[/1/i,/2/i,/3/i,/4/i]},oc={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},ac={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},ic={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},lc={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},cc={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},uc={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},dc={ordinalNumber:Jl({matchPattern:Zl,parsePattern:ec,valueCallback:t=>parseInt(t,10)}),era:Ht({matchPatterns:tc,defaultMatchWidth:"wide",parsePatterns:nc,defaultParseWidth:"any"}),quarter:Ht({matchPatterns:sc,defaultMatchWidth:"wide",parsePatterns:rc,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Ht({matchPatterns:oc,defaultMatchWidth:"wide",parsePatterns:ac,defaultParseWidth:"any"}),day:Ht({matchPatterns:ic,defaultMatchWidth:"wide",parsePatterns:lc,defaultParseWidth:"any"}),dayPeriod:Ht({matchPatterns:cc,defaultMatchWidth:"any",parsePatterns:uc,defaultParseWidth:"any"})},fc={code:"en-US",formatDistance:Pl,formatLong:Ol,formatRelative:zl,localize:ql,match:dc,options:{weekStartsOn:0,firstWeekContainsDate:1}};function hc(t){const e=ae(t);return gs(e,so(e))+1}function pc(t){const e=ae(t),n=+jt(e)-+Un(e);return Math.round(n/_n)+1}function oo(t,e){var d,f,m,p;const n=ae(t),s=n.getFullYear(),r=$n(),o=(e==null?void 0:e.firstWeekContainsDate)??((f=(d=e==null?void 0:e.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??r.firstWeekContainsDate??((p=(m=r.locale)==null?void 0:m.options)==null?void 0:p.firstWeekContainsDate)??1,a=ze(t,0);a.setFullYear(s+1,0,o),a.setHours(0,0,0,0);const i=rt(a,e),c=ze(t,0);c.setFullYear(s,0,o),c.setHours(0,0,0,0);const u=rt(c,e);return n.getTime()>=i.getTime()?s+1:n.getTime()>=u.getTime()?s:s-1}function mc(t,e){var a,i,c,u;const n=$n(),s=(e==null?void 0:e.firstWeekContainsDate)??((i=(a=e==null?void 0:e.locale)==null?void 0:a.options)==null?void 0:i.firstWeekContainsDate)??n.firstWeekContainsDate??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.firstWeekContainsDate)??1,r=oo(t,e),o=ze(t,0);return o.setFullYear(r,0,s),o.setHours(0,0,0,0),rt(o,e)}function xc(t,e){const n=ae(t),s=+rt(n,e)-+mc(n,e);return Math.round(s/_n)+1}function ge(t,e){const n=t<0?"-":"",s=Math.abs(t).toString().padStart(e,"0");return n+s}const nt={y(t,e){const n=t.getFullYear(),s=n>0?n:1-n;return ge(e==="yy"?s%100:s,e.length)},M(t,e){const n=t.getMonth();return e==="M"?String(n+1):ge(n+1,2)},d(t,e){return ge(t.getDate(),e.length)},a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(t,e){return ge(t.getHours()%12||12,e.length)},H(t,e){return ge(t.getHours(),e.length)},m(t,e){return ge(t.getMinutes(),e.length)},s(t,e){return ge(t.getSeconds(),e.length)},S(t,e){const n=e.length,s=t.getMilliseconds(),r=Math.trunc(s*Math.pow(10,n-3));return ge(r,e.length)}},wt={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Qs={G:function(t,e,n){const s=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(s,{width:"abbreviated"});case"GGGGG":return n.era(s,{width:"narrow"});case"GGGG":default:return n.era(s,{width:"wide"})}},y:function(t,e,n){if(e==="yo"){const s=t.getFullYear(),r=s>0?s:1-s;return n.ordinalNumber(r,{unit:"year"})}return nt.y(t,e)},Y:function(t,e,n,s){const r=oo(t,s),o=r>0?r:1-r;if(e==="YY"){const a=o%100;return ge(a,2)}return e==="Yo"?n.ordinalNumber(o,{unit:"year"}):ge(o,e.length)},R:function(t,e){const n=Xr(t);return ge(n,e.length)},u:function(t,e){const n=t.getFullYear();return ge(n,e.length)},Q:function(t,e,n){const s=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(s);case"QQ":return ge(s,2);case"Qo":return n.ordinalNumber(s,{unit:"quarter"});case"QQQ":return n.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(s,{width:"wide",context:"formatting"})}},q:function(t,e,n){const s=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(s);case"qq":return ge(s,2);case"qo":return n.ordinalNumber(s,{unit:"quarter"});case"qqq":return n.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(s,{width:"wide",context:"standalone"})}},M:function(t,e,n){const s=t.getMonth();switch(e){case"M":case"MM":return nt.M(t,e);case"Mo":return n.ordinalNumber(s+1,{unit:"month"});case"MMM":return n.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(s,{width:"wide",context:"formatting"})}},L:function(t,e,n){const s=t.getMonth();switch(e){case"L":return String(s+1);case"LL":return ge(s+1,2);case"Lo":return n.ordinalNumber(s+1,{unit:"month"});case"LLL":return n.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(s,{width:"wide",context:"standalone"})}},w:function(t,e,n,s){const r=xc(t,s);return e==="wo"?n.ordinalNumber(r,{unit:"week"}):ge(r,e.length)},I:function(t,e,n){const s=pc(t);return e==="Io"?n.ordinalNumber(s,{unit:"week"}):ge(s,e.length)},d:function(t,e,n){return e==="do"?n.ordinalNumber(t.getDate(),{unit:"date"}):nt.d(t,e)},D:function(t,e,n){const s=hc(t);return e==="Do"?n.ordinalNumber(s,{unit:"dayOfYear"}):ge(s,e.length)},E:function(t,e,n){const s=t.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(s,{width:"short",context:"formatting"});case"EEEE":default:return n.day(s,{width:"wide",context:"formatting"})}},e:function(t,e,n,s){const r=t.getDay(),o=(r-s.weekStartsOn+8)%7||7;switch(e){case"e":return String(o);case"ee":return ge(o,2);case"eo":return n.ordinalNumber(o,{unit:"day"});case"eee":return n.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(r,{width:"short",context:"formatting"});case"eeee":default:return n.day(r,{width:"wide",context:"formatting"})}},c:function(t,e,n,s){const r=t.getDay(),o=(r-s.weekStartsOn+8)%7||7;switch(e){case"c":return String(o);case"cc":return ge(o,e.length);case"co":return n.ordinalNumber(o,{unit:"day"});case"ccc":return n.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(r,{width:"narrow",context:"standalone"});case"cccccc":return n.day(r,{width:"short",context:"standalone"});case"cccc":default:return n.day(r,{width:"wide",context:"standalone"})}},i:function(t,e,n){const s=t.getDay(),r=s===0?7:s;switch(e){case"i":return String(r);case"ii":return ge(r,e.length);case"io":return n.ordinalNumber(r,{unit:"day"});case"iii":return n.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(s,{width:"short",context:"formatting"});case"iiii":default:return n.day(s,{width:"wide",context:"formatting"})}},a:function(t,e,n){const s=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(t,e,n){const s=t.getHours();let r;switch(s===12?r=wt.noon:s===0?r=wt.midnight:r=s/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(t,e,n){const s=t.getHours();let r;switch(s>=17?r=wt.evening:s>=12?r=wt.afternoon:s>=4?r=wt.morning:r=wt.night,e){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(t,e,n){if(e==="ho"){let s=t.getHours()%12;return s===0&&(s=12),n.ordinalNumber(s,{unit:"hour"})}return nt.h(t,e)},H:function(t,e,n){return e==="Ho"?n.ordinalNumber(t.getHours(),{unit:"hour"}):nt.H(t,e)},K:function(t,e,n){const s=t.getHours()%12;return e==="Ko"?n.ordinalNumber(s,{unit:"hour"}):ge(s,e.length)},k:function(t,e,n){let s=t.getHours();return s===0&&(s=24),e==="ko"?n.ordinalNumber(s,{unit:"hour"}):ge(s,e.length)},m:function(t,e,n){return e==="mo"?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):nt.m(t,e)},s:function(t,e,n){return e==="so"?n.ordinalNumber(t.getSeconds(),{unit:"second"}):nt.s(t,e)},S:function(t,e){return nt.S(t,e)},X:function(t,e,n){const s=t.getTimezoneOffset();if(s===0)return"Z";switch(e){case"X":return Js(s);case"XXXX":case"XX":return ct(s);case"XXXXX":case"XXX":default:return ct(s,":")}},x:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"x":return Js(s);case"xxxx":case"xx":return ct(s);case"xxxxx":case"xxx":default:return ct(s,":")}},O:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+Xs(s,":");case"OOOO":default:return"GMT"+ct(s,":")}},z:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+Xs(s,":");case"zzzz":default:return"GMT"+ct(s,":")}},t:function(t,e,n){const s=Math.trunc(t.getTime()/1e3);return ge(s,e.length)},T:function(t,e,n){const s=t.getTime();return ge(s,e.length)}};function Xs(t,e=""){const n=t>0?"-":"+",s=Math.abs(t),r=Math.trunc(s/60),o=s%60;return o===0?n+String(r):n+String(r)+e+ge(o,2)}function Js(t,e){return t%60===0?(t>0?"-":"+")+ge(Math.abs(t)/60,2):ct(t,e)}function ct(t,e=""){const n=t>0?"-":"+",s=Math.abs(t),r=ge(Math.trunc(s/60),2),o=ge(s%60,2);return n+r+e+o}const Zs=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},ao=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},gc=(t,e)=>{const n=t.match(/(P+)(p+)?/)||[],s=n[1],r=n[2];if(!r)return Zs(t,e);let o;switch(s){case"P":o=e.dateTime({width:"short"});break;case"PP":o=e.dateTime({width:"medium"});break;case"PPP":o=e.dateTime({width:"long"});break;case"PPPP":default:o=e.dateTime({width:"full"});break}return o.replace("{{date}}",Zs(s,e)).replace("{{time}}",ao(r,e))},wc={p:ao,P:gc},yc=/^D+$/,vc=/^Y+$/,bc=["D","DD","YY","YYYY"];function kc(t){return yc.test(t)}function Sc(t){return vc.test(t)}function Cc(t,e,n){const s=jc(t,e,n);if(console.warn(s),bc.includes(t))throw new RangeError(s)}function jc(t,e,n){const s=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${s} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Mc=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,_c=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,$c=/^'([^]*?)'?$/,Nc=/''/g,Ec=/[a-zA-Z]/;function Kn(t,e,n){var d,f,m,p,g,x,w,y;const s=$n(),r=(n==null?void 0:n.locale)??s.locale??fc,o=(n==null?void 0:n.firstWeekContainsDate)??((f=(d=n==null?void 0:n.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??s.firstWeekContainsDate??((p=(m=s.locale)==null?void 0:m.options)==null?void 0:p.firstWeekContainsDate)??1,a=(n==null?void 0:n.weekStartsOn)??((x=(g=n==null?void 0:n.locale)==null?void 0:g.options)==null?void 0:x.weekStartsOn)??s.weekStartsOn??((y=(w=s.locale)==null?void 0:w.options)==null?void 0:y.weekStartsOn)??0,i=ae(t);if(!jl(i))throw new RangeError("Invalid time value");let c=e.match(_c).map(v=>{const b=v[0];if(b==="p"||b==="P"){const S=wc[b];return S(v,r.formatLong)}return v}).join("").match(Mc).map(v=>{if(v==="''")return{isToken:!1,value:"'"};const b=v[0];if(b==="'")return{isToken:!1,value:Tc(v)};if(Qs[b])return{isToken:!0,value:v};if(b.match(Ec))throw new RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");return{isToken:!1,value:v}});r.localize.preprocessor&&(c=r.localize.preprocessor(i,c));const u={firstWeekContainsDate:o,weekStartsOn:a,locale:r};return c.map(v=>{if(!v.isToken)return v.value;const b=v.value;(!(n!=null&&n.useAdditionalWeekYearTokens)&&Sc(b)||!(n!=null&&n.useAdditionalDayOfYearTokens)&&kc(b))&&Cc(b,e,String(t));const S=Qs[b[0]];return S(i,b,r.localize,u)}).join("")}function Tc(t){const e=t.match($c);return e?e[1].replace(Nc,"'"):t}function io(t){const e=ae(t),n=e.getFullYear(),s=e.getMonth(),r=ze(t,0);return r.setFullYear(n,s+1,0),r.setHours(0,0,0,0),r.getDate()}function Rc(t){const e=ae(t).getFullYear();return e%400===0||e%4===0&&e%100!==0}function lo(t){const e=ae(t);return String(new Date(e))==="Invalid Date"?NaN:Rc(e)?366:365}function Dc(t){const e=Un(t),n=+Un(Jr(e,60))-+e;return Math.round(n/_n)}function vt(t,e){const n=ae(t),s=ae(e);return+n==+s}function Ic(t){const e=ae(t);return e.setMinutes(0,0,0),e}function Pc(t,e,n){const s=rt(t,n),r=rt(e,n);return+s==+r}function Ac(t,e){const n=ae(t),s=ae(e);return n.getFullYear()===s.getFullYear()&&n.getMonth()===s.getMonth()}function Lc(t,e){const n=Gt(t),s=Gt(e);return+n==+s}function Hc(t,e){const n=ae(t),s=ae(e);return n.getFullYear()===s.getFullYear()}const qn=8,co=4,Oc=3,er=7,Wc=qn+co;function uo(t,e){var n;(t.open||t.type!="summary")&&((n=t.data)==null||n.forEach(s=>{s.$x+=e,uo(s,e)}))}function Qn(t,e,n,s){const r=t.getSummaryId(e.id);if(r){const o=t.byId(r),a={xMin:1/0,xMax:0};fo(o,a,n,s),o.$x=a.xMin,o.$w=a.xMax-a.xMin,Qn(t,o,n,s)}}function fo(t,e,n,s){var a;const{lengthUnit:r,start:o}=n;(a=t.data)==null||a.forEach(i=>{if(!i.unscheduled){typeof i.$x>"u"&&(i.$x=Math.round(n.diff(i.start,o,r)*s),i.$w=Math.round(n.diff(i.end,i.start,r,!0)*s));const c=i.type==="milestone"&&i.$h?i.$h/2:0;e.xMin>i.$x&&(e.xMin=i.$x+c);const u=i.$x+i.$w-c;e.xMax<u&&(e.xMax=u)}i.type!=="summary"&&fo(i,e,n,s)})}function vs(t,e){var r;let n;e&&(n=e.filter(o=>o.parent==t.id));const s={data:n,...t};if((r=s.data)!=null&&r.length)s.data.forEach(o=>{if(o.unscheduled&&!o.data)return;(e||o.type!="summary"&&o.data)&&(o.unscheduled&&(o={...o,start:void 0,end:void 0}),o=vs(o,e)),o.start&&(!s.start||s.start>o.start)&&(s.start=new Date(o.start));const a=o.type==="milestone"?o.start:o.end;a&&(!s.end||s.end<a)&&(s.end=new Date(a))});else if(t.type==="summary")throw Error("Summary tasks must have start and end dates if they have no subtasks");return s}function zc(t,e,n,s,r,o){return tr(t,e,n,s,r,o,!1),o&&tr(t,e,n,s,r,o,!0),t}function tr(t,e,n,s,r,o,a){const{start:i,end:c,lengthUnit:u,diff:d}=r,f=(a?"base_":"")+"start",m=(a?"base_":"")+"end",p="$x"+(a?"_base":""),g="$y"+(a?"_base":""),x="$w"+(a?"_base":""),w="$h"+(a?"_base":""),y="$skip"+(a?"_baseline":"");let v=t[f],b=t[m];if(a&&!v){t[y]=!0;return}t[f]<i&&(t[m]<i||vt(t[m],i))?v=b=i:t[f]>c&&(v=b=c),t[p]=Math.round(d(v,i,u)*n),t[g]=a?t.$y+t.$h+co:s*e+Oc,t[x]=Math.round(d(b,v,u,!0)*n),t[w]=a?qn:o?s-er-Wc:s-er,t.type==="milestone"&&(t[p]=t[p]-t.$h/2,t[x]=t.$h,a&&(t[g]=t.$y+qn,t[x]=t[w]=t.$h)),t.unscheduled&&!a?t.$skip=!0:t[y]=vt(v,b)}class Fc extends il{constructor(n){super();Re(this,"_sort");this.parse(n,0)}parse(n,s){if(!n||!n.length)return;const r=n.map(o=>this.normalizeTask(o,n));super.parse(r,s),this._sort&&this.sortBranch(this._sort,s)}getBranch(n){const s=this._pool.get(n);return this._pool.get(s.parent||0).data}contains(n,s){const r=this._pool.get(n).data;let o=!1;if(r)for(let a=0;a<r.length;a++){if(r[a].id===s){o=!0;break}if(r[a].data&&(o=this.contains(r[a].id,s),o))break}return o}getIndexById(n){return this.getBranch(n).findIndex(s=>s.id===n)}add(n,s){const r=this.normalizeTask(n);return super.add(r,s),r}copy(n,s,r){var i;const o=this.add({...n,id:null,data:null,parent:s},r);let a=[[n.id,o.id]];return(i=n.data)==null||i.forEach((c,u)=>{const d=this.copy(c,o.id,u);a=a.concat(d)}),a}normalizeTask(n,s){const r=n.id||Br(),o=n.parent||0,a=n.text||"",i=n.type||"task",c=n.progress||0,u=n.details||"",d={...n,id:r,text:a,parent:o,progress:c,type:i,details:u};if(d.type==="summary"&&!(d.start&&d.end)){const{start:f,end:m}=vs({...d},s);d.start=f,d.end=m}return d}getSummaryId(n){const s=this._pool.get(n);if(!s.parent)return null;const r=this._pool.get(s.parent);return r.type==="summary"?r.id:this.getSummaryId(r.id)}sort(n){this._sort=n,n&&this.sortBranch(n,0)}sortBranch(n,s){const r=this._pool.get(s||0).data;r&&(xl(r,n),r.forEach(o=>{this.sortBranch(n,o.id)}))}serialize(){const n=[],s=this._pool.get(0).data;return s&&ho(s,n),n}}function ho(t,e){t.forEach(n=>{e.push(n),n.data&&ho(n.data,e)})}const nr={year:Dl,quarter:Rl,month:to,week:ws,day:gs,hour:$l,minute:Nl},Ut={year:{quarter:4,month:12,week:Dc,day:Vc,hour:Bc},quarter:{month:3,week:Yc,day:po,hour:Gc},month:{week:Uc,day:Kc,hour:qc},week:{day:7,hour:24*7},day:{hour:24},hour:{minute:60}};function Vc(t){return t?lo(t):365}function Bc(t){return lo(t)*24}function Yc(t){const e=Gt(t),n=Mn(ft(ro(t)),1);return ws(n,e)}function po(t){if(t){const e=Gt(t),n=ro(t);return gs(n,e)+1}return 91}function Gc(t){return po(t)*24}function Uc(t){if(t){const e=no(t),n=Mn(ft(eo(t)),1);return ws(n,e)}return 5}function Kc(t){return t?io(t):30}function qc(t){return io(t)*24}function gn(t,e,n){const s=Ut[t][e];return s?typeof s=="number"?s:s(n):1}function Qc(t,e){return t===e||!!(Ut[t]&&Ut[t][e])}const Xn={year:kl,quarter:bl,month:xs,week:Jr,day:Mn,hour:wl,minute:vl};function bs(t){return(e,n,s,r)=>!Ut[t][s]||typeof Ut[t][s]=="number"||mo(t,e,n)?Wt(t,e,n,s,r):Xc(e,n,t,s,r)}function Wt(t,e,n,s,r){const o=s||t;let a=n,i=e;if(r&&(a=Je(o,n),i=Je(o,e),i<e&&(i=Ke(o)(i,1))),t!==o){const c=nr[o](i,a),u=gn(t,o,n);return c/u}else return nr[o](i,a)}function Xc(t,e,n,s,r){let o=0;const a=Je(n,e);if(e>a){const c=Xn[n](a,1);o=Wt(n,c,e,s),e=c}let i=0;return mo(n,e,t)||(i=Wt(n,Je(n,t),e),e=Xn[n](e,i)),i+=o+Wt(n,t,e,s),!i&&r&&(i=Wt(n,t,e,s,r)),i}function Ke(t){return Xn[t]}const Jc={year:so,quarter:Gt,month:no,week:t=>rt(t,{weekStartsOn:1}),day:ft,hour:Ic};function Je(t,e){const n=Jc[t];return n?n(e):new Date(e)}const Zc={year:Hc,quarter:Lc,month:Ac,week:(t,e)=>Pc(t,e,{weekStartsOn:1}),day:Sl};function mo(t,e,n){const s=Zc[t];return s?s(e,n):!1}function Mt(t){const e=new Date;return t.map(n=>({item:n,len:Ke(n.unit)(e,1)})).sort((n,s)=>n.len<s.len?-1:1)[0].item}const Ct=["year","quarter","month","week","day","hour"],ln={year:"yyyy",quarter:"QQQ",month:"MMM",week:"w",day:"MMM d",hour:"HH:mm"},Jn=50,Zn=300;function eu(t,e,n,s,r){let o=t,a=e,i=!1,c=!1;r&&r.forEach(d=>{(!t||n)&&(!o||d.start<=o)&&(o=d.start,i=!0);const f=d.type==="milestone"?d.start:d.end;(!e||n)&&(!a||f>=a)&&(a=f,c=!0)});const u=Ke(s||"day");return o?i&&(o=u(o,-1)):a?o=u(a,-30):o=new Date,a?c&&(a=u(a,1)):a=u(o,30),{_start:o,_end:a}}function tu(t,e,n,s,r,o){const a=Mt(o).unit,i=bs(a),c=i(e,t,"",!0),u=Je(a,e);t=Je(a,t),e=u<e?Ke(a)(u,1):u;const d=c*s,f=r*o.length,m=o.map(g=>{const x=[],w=Ke(g.unit);let y=Je(g.unit,t);for(;y<e;){let v=w(y,g.step);y<t&&(y=t),v>e&&(v=e);const b=i(v,y,"",!0)*s,S=typeof g.format=="function"?g.format(y,v):Kn(y,g.format,{firstWeekContainsDate:4,weekStartsOn:1});let C="";g.css&&(C+=typeof g.css=="function"?g.css(y):g.css),x.push({width:b,value:S,date:y,css:C,unit:g.unit}),y=v}return{cells:x,add:w,height:r}});let p=s;return a!==n&&(p=Math.round(p/gn(a,n))||1),{rows:m,width:d,height:f,diff:i,start:t,end:e,lengthUnit:n,minUnit:a,lengthUnitWidth:p}}function nu(t,e,n){const s=typeof t=="boolean"?{}:t,r=Ct.indexOf(Mt(e).unit);if(typeof s.level>"u"&&(s.level=r),s.levels)s.levels.forEach(i=>{i.minCellWidth||(i.minCellWidth=cn(s.minCellWidth,Jn)),i.maxCellWidth||(i.maxCellWidth=cn(s.maxCellWidth,Zn))});else{const i=[],c=e.length||1,u=cn(s.minCellWidth,Jn),d=cn(s.maxCellWidth,Zn);e.forEach(f=>{f.format&&!ln[f.unit]&&(ln[f.unit]=f.format)}),Ct.forEach((f,m)=>{if(m===r)i.push({minCellWidth:u,maxCellWidth:d,scales:e});else{const p=[];if(m)for(let g=c-1;g>0;g--){const x=Ct[m-g];x&&p.push({unit:x,step:1,format:ln[x]})}p.push({unit:f,step:1,format:ln[f]}),i.push({minCellWidth:u,maxCellWidth:d,scales:p})}}),s.levels=i}s.levels[s.level]||(s.level=0);const o=s.levels[s.level],a=Math.min(Math.max(n,o.minCellWidth),o.maxCellWidth);return{_zoom:s,scales:o.scales,cellWidth:a}}function su(t,e,n,s,r,o,a){t.level=n;let i;const c=s.scales||s,u=Mt(c).unit,d=ru(u,r);if(e===-1){const p=gn(u,r);i=a*p}else{const p=gn(Mt(o).unit,u);i=Math.round(a/p)}const f=s.minCellWidth??Jn,m=s.maxCellWidth??Zn;return{scales:c,cellWidth:Math.min(m,Math.max(f,i)),lengthUnit:d,zoom:t}}function ru(t,e){const n=Ct.indexOf(t),s=Ct.indexOf(e);return s>=n?t==="hour"?"hour":"day":Ct[s]}function cn(t,e){return t??e}const Hn=20,ou=function(t,e,n,s,r){const o=Math.round(s/2)-3;if(!e||!n||!e.$y||!n.$y||e.$skip||n.$skip)return t.$p="",t;let a=!1,i=!1;switch(t.type){case"e2s":i=!0;break;case"s2s":a=!0,i=!0;break;case"s2e":a=!0;break}const c=a?e.$x:e.$x+e.$w,u=r?e.$y-7:e.$y,d=i?n.$x:n.$x+n.$w,f=r?n.$y-7:n.$y;if(c!==d||u!==f){const m=au(c,u+o,d,f+o,a,i,s/2,r),p=iu(d,f+o,i);t.$p=`${m},${p}`}return t};function au(t,e,n,s,r,o,a,i){const c=Hn*(r?-1:1),u=Hn*(o?-1:1),d=t+c,f=n+u,m=[t,e,d,e,0,0,0,0,f,s,n,s],p=f-d;let g=s-e;const x=o===r;return x||(f<=t+Hn-2&&o||f>t&&!o)&&(g=i?g-a+6:g-a),x&&o&&d>f||x&&!o&&d<f?(m[4]=m[2]+p,m[5]=m[3],m[6]=m[4],m[7]=m[5]+g):(m[4]=m[2],m[5]=m[3]+g,m[6]=m[4]+p,m[7]=m[5]),m.join(",")}function iu(t,e,n){return n?`${t-5},${e-3},${t-5},${e+3},${t},${e}`:`${t+5},${e+3},${t+5},${e-3},${t},${e}`}const xo=["start","end","duration"];function lu(t,e){const{type:n,unscheduled:s}=t;return s||n==="summary"?!xo.includes(e):n==="milestone"?!["end","duration"].includes(e):!0}function cu(t,e){return typeof e=="function"?e:xo.includes(t)?(typeof e=="string"&&(e={type:e,config:{}}),e.config||(e.config={}),e.type==="datepicker"&&(e.config.buttons=["today"]),(n,s)=>lu(n,s.id)?e:null):e}function uu(t){return!t||!t.length?[]:t.map(e=>{const n=e.align||"left",s=e.id==="add-task",r=!s&&e.flexgrow?e.flexgrow:null,o=r?1:e.width||(s?50:120);let a=e.template;if(!a)switch(e.id){case"start":a=c=>Kn(c,"dd-MM-yyyy");break;case"end":a=c=>c?Kn(c,"dd-MM-yyyy"):"-";break}const i=e.editor&&cu(e.id,e.editor);return{width:o,align:n,header:e.header,id:e.id,template:a,...r&&{flexgrow:r},cell:e.cell,resize:e.resize??!0,sort:e.sort??!s,...i&&{editor:i},...e.options&&{options:e.options}}})}const du=[{id:"text",header:"Task name",flexgrow:1,sort:!0},{id:"start",header:"Start date",align:"center",sort:!0},{id:"duration",header:"Duration",width:100,align:"center",sort:!0},{id:"add-task",header:"Add task",width:50,align:"center",sort:!1,resize:!1}];function fu(){let t=!0;return t=!1,t}function bt(t,e,n,s){const{selected:r,tasks:o}=t.getState(),a=r.length,i=!a&&e==="add-task",c=["edit-task","paste-task"],u=["copy-task","cut-task"],d=["copy-task","cut-task","delete-task","indent-task:remove","move-task:down"],f=["indent-task:add","move-task:down","move-task:up"],m={"indent-task:remove":2},p={parent:f.includes(e),level:m[e]};if(n=n||(a?r[r.length-1]:null),!(!n&&!i)){if(e!=="paste-task"&&(t._temp=null),c.includes(e)||i||r.length===1)sr(t,e,n,s);else if(a){const g=u.includes(e)?r:hu(r,o,p);d.includes(e)&&g.reverse(),g.forEach(x=>sr(t,e,x,s))}}}function hu(t,e,n){let s=t.map(r=>{const o=e.byId(r);return{id:r,level:o.$level,parent:o.parent,index:e.getIndexById(r)}});return(n.parent||n.level)&&(s=s.filter(r=>n.level&&r.level<=n.level||!t.includes(r.parent))),s.sort((r,o)=>r.level-o.level||r.index-o.index),s.map(r=>r.id)}function sr(t,e,n,s){const r=t.exec?t.exec:t.in.exec;let o=e.split(":")[0],a=e.split(":")[1],i={id:n},c={};if(o=="copy-task"||o=="cut-task"){t._temp||(t._temp=[]),t._temp.push({id:n,cut:o=="cut-task"});return}else if(o=="paste-task"){t._temp&&t._temp.length&&(t._temp.forEach(u=>{r(u.cut?"move-task":"copy-task",{id:u.id,target:n,mode:"after"})}),t._temp=null);return}else o==="add-task"?(c={task:{type:"task",text:s("New Task")},target:n},i={}):o==="edit-task"?o="show-editor":o==="convert-task"?(o="update-task",c={task:{type:a}},a=void 0):o==="indent-task"&&(a=a==="add");typeof a<"u"&&(c={mode:a,...c}),i={...i,...c},r(o,i)}function ks(t,e){return t.some(n=>n.data?ks(n.data,e):n.id===e)}const pu=t=>Ke(t),mu=t=>bs(t);function rr(t,e,n){or(t,e),t.base_start&&or(t,e,!0),Kt(e,n)}function Kt(t,e,n,s){t.unscheduled||(n&&xu(t,s),ar(t,e)),t.base_start&&ar(t,e,!0)}function or(t,e,n=!1){e.type=e.type||t.type;const[s,r,o]=go(n);e.type!=="milestone"?(t[r]&&e[s]||(e[s]=t[s]),e[s]&&!(e[o]||e[r])?(e[r]=t[r]>e[s]?t[r]:null,e[r]||(e[o]=1)):e[r]&&!(e[o]||e[s])?(e[s]=t[s]<e[r]?t[s]:e[r],e[s]===e[r]&&(e[o]=1,delete e[r])):e[o]&&!(e[s]||e[r])&&(e[s]=t[s])):(e[r]&&delete e[r],t[r]&&delete t[r])}function ar(t,e="day",n){const[s,r,o]=go(n);t.type==="milestone"?t[o]=0:t[s]&&(t[o]?t[r]||(t[r]=pu(e)(t[s],t[o])):t[r]?t[o]=mu(e)(t[r],t[s]):(t[r]=t[s],t[o]=0))}function go(t){return t?["base_start","base_end","base_duration"]:["start","end","duration"]}function xu(t,e){e==="duration"&&(t.end=null),t.start&&t.end&&(t.start>=t.end?t.end=null:t.duration=null),t.base_start&&t.base_end&&(t.base_start>=t.base_end?t.base_end=null:t.base_duration=null)}class gu extends cl{constructor(n){super({writable:n,async:!1});Re(this,"in");Re(this,"_router");this._router=new ul(super.setState.bind(this),[{in:["tasks","start","end","scales","autoScale"],out:["_start","_end"],exec:o=>{const{_end:a,_start:i,start:c,end:u,tasks:d,scales:f,autoScale:m}=this.getState();if(!c||!u||m){const p=Mt(f).unit,g=eu(c,u,m,p,d);(g._end!=a||g._start!=i)&&this.setState(g,o)}else this.setState({_start:c,_end:u},o)}},{in:["_start","_end","cellWidth","scaleHeight","scales","lengthUnit"],out:["_scales"],exec:o=>{const a=this.getState();let{lengthUnit:i}=a;const{_start:c,_end:u,cellWidth:d,scaleHeight:f,scales:m}=a,p=Mt(m).unit;Qc(p,i)||(i=p);const g=tu(c,u,i,d,f,m);this.setState({_scales:g},o)}},{in:["_scales","tasks","cellHeight","baselines"],out:["_tasks"],exec:o=>{const{cellWidth:a,cellHeight:i,tasks:c,_scales:u,baselines:d}=this.getState(),f=c.toArray().map((m,p)=>zc(m,p,a,i,u,d));this.setState({_tasks:f},o)}},{in:["_tasks","links","cellHeight"],out:["_links"],exec:o=>{const{tasks:a,links:i,cellHeight:c,baselines:u}=this.getState(),d=i.map(f=>{const m=a.byId(f.source),p=a.byId(f.target);return ou(f,m,p,c,u)}).filter(f=>f!==null);this.setState({_links:d},o)}},{in:["tasks","activeTask"],out:["_activeTask"],exec:o=>{const{tasks:a,activeTask:i}=this.getState();this.setState({_activeTask:a.byId(i)||null},o)}},{in:["tasks","selected"],out:["_selected"],exec:o=>{const{tasks:a,selected:i}=this.getState(),c=i.map(u=>a.byId(u)).filter(u=>!!u);this.setState({_selected:c},o)}},{in:["start","end"],out:["cellWidth"],exec:o=>{const{_cellWidth:a,cellWidth:i}=this.getState();a!=i&&this.setState({cellWidth:a},o)}},{in:["markers","_scales","cellWidth"],out:["_markers"],exec:o=>{const{markers:a,_scales:i,cellWidth:c}=this.getState(),{start:u,diff:d}=i,f=a.map(m=>(m.left=d(m.start,u)*c,m));this.setState({_markers:f},o)}}],{tasks:o=>new Fc(o),links:o=>new Ks(o),columns:o=>uu(o)});const s=this.in=new dl;s.on("show-editor",({id:o})=>{this.setStateAsync({activeTask:o})}),s.on("select-task",({id:o,toggle:a,range:i,show:c})=>{const{selected:u,_tasks:d,activeTask:f}=this.getState();let m=!1,p;if(u.length&&(a||i)){const x=[...u];if(i){const w=x[x.length-1],y=d.findIndex(k=>k.id==w),v=d.findIndex(k=>k.id==o),b=Math.min(y,v),S=Math.max(y,v)+1,C=d.slice(b,S).map(k=>k.id);y>v&&C.reverse(),C.forEach(k=>{x.includes(k)||x.push(k)})}else if(a){const w=x.findIndex(y=>y==o);w===-1?x.push(o):(m=!0,x.splice(w,1))}p=x}else p=[o];const g={selected:p};c&&p.length&&(g._scrollTask={id:p[0],mode:c}),this.setStateAsync(g),!m&&f&&f!=o&&s.exec("show-editor",{id:o})}),s.on("delete-link",({id:o})=>{const{links:a}=this.getState();a.remove(o),this.setStateAsync({links:a})}),s.on("update-link",o=>{const{links:a}=this.getState(),{id:i,link:c}=o;a.update(i,c),this.setStateAsync({links:a}),o.link=a.byId(i)}),s.on("add-link",o=>{const{link:a}=o,{links:i}=this.getState();!a.source||!a.target||(a.type||(a.type="e2s"),a.id=a.id||Br(),i.add(a),this.setStateAsync({links:i}),o.id=a.id,o.link=i.byId(a.id))});let r=null;s.on("move-task",o=>{const{tasks:a}=this.getState();let{mode:i,target:c}=o;const{id:u,inProgress:d}=o,f=a.byId(u);if(typeof d>"u"?o.source=f.parent:o.source=r=r??f.parent,d===!1){a.update(f.id,{$reorder:!1}),this.setState({tasks:a}),r=null;return}if(c===u||a.contains(u,c)){o.skipProvider=!0;return}if(i==="up"||i==="down"){const m=a.getBranch(u);let p=a.getIndexById(u);if(i==="up"){const g=f.parent===0;if(p===0&&g){o.skipProvider=!0;return}p-=1,i="before"}else if(i==="down"){const g=p===m.length-1,x=f.parent===0;if(g&&x){o.skipProvider=!0;return}p+=1,i="after"}if(c=m[p]&&m[p].id||f.parent,c){const g=a.getBranch(c);let x=a.getIndexById(c),w=g[x];if(w.data){if(i==="before"){if(w.parent===f.parent){for(;w.data;)w.open||s.exec("open-task",{id:w.id,mode:!0}),w=w.data[w.data.length-1];c=w.id}}else if(i==="after"){let b;w.parent===f.parent?(b=w,w=w.data[0],c=w.id,i="before"):g.length-1!==x&&(b=w,x+=1,w=g[x],f.$level>w.$level&&w.data?(b=w,w=w.data[0],c=w.id,i="before"):c=w.id),b&&!b.open&&s.exec("open-task",{id:b.id,mode:!0})}}const y=a.getSummaryId(f.id);a.move(u,i,c);const v=a.getSummaryId(u);y!=v&&(y&&this.resetSummaryDates(y,"move-task"),v&&this.resetSummaryDates(v,"move-task"))}}else{const m=a.byId(c);let p=m,g=!1;for(;p.$level>f.$level;)p=a.byId(p.parent),p.id===u&&(g=!0);if(g)return;const x=a.getSummaryId(f.id);if(a.move(u,i,c),i=="child"){let y=m;for(;y.id!==0&&!y.open;)s.exec("open-task",{id:y.id,mode:!0}),y=a.byId(y.parent)}const w=a.getSummaryId(u);x!=w&&(x&&this.resetSummaryDates(x,"move-task"),w&&this.resetSummaryDates(w,"move-task"))}d?this.setState({tasks:a}):this.setStateAsync({tasks:a}),o.target=c,o.mode=i}),s.on("drag-task",o=>{const{id:a,width:i,left:c,top:u,inProgress:d}=o,f=this.getState(),{tasks:m,_tasks:p,_selected:g,_scales:x,cellWidth:w}=f,y={_tasks:p,_selected:g},v=m.byId(a);typeof i<"u"&&(v.$w=i,Qn(m,v,x,w)),typeof c<"u"&&(v.type==="summary"&&uo(v,c-v.$x),v.$x=c,Qn(m,v,x,w)),typeof u<"u"&&(v.$y=u+4,v.$reorder=d),typeof i<"u"&&(v.$w=i),typeof c<"u"&&(v.$x=c),typeof u<"u"&&(v.$y=u+4,v.$reorder=d),this.setState(y)}),s.on("update-task",o=>{var v;const{id:a,task:i,eventSource:c}=o;let u=o.diff;const{tasks:d,_scales:f,durationUnit:m}=this.getState(),p=d.byId(a);if(c==="add-task"||c==="copy-task"||c==="move-task"||c==="update-task"||c==="delete-task"){rr(p,i,m),d.update(a,i);return}const g=f.lengthUnit,x=Ke(g),w=bs(g);if(u&&(i.start&&(i.start=x(i.start,u)),i.end&&(i.end=x(i.end,u))),i.start&&i.end){if((!vt(i.start,p.start)||!vt(i.end,p.end))&&p.type==="summary"&&(!i.type||i.type==="summary")&&((v=p.data)!=null&&v.length)){if(!u&&(u=w(i.start,p.start),w(i.end,p.end)!==u))return;this.moveSummaryKids(p,b=>x(b,u),"update-task")}}else if(p.type=="summary"&&(i.start&&!i.end||i.end&&!i.start||i.duration))return;rr(p,i,m),d.update(a,i),i.type==="summary"&&p.type!=="summary"&&this.resetSummaryDates(a,"update-task");const y=d.getSummaryId(a);y&&this.resetSummaryDates(y,"update-task"),this.setStateAsync({tasks:d}),o.task=d.byId(a)}),s.on("add-task",o=>{const{tasks:a,_scales:i,baselines:c,unscheduledTasks:u,durationUnit:d}=this.getState(),{target:f,mode:m,task:p,show:g}=o;p.unscheduled=u;let x=-1,w,y;if(f?(y=a.byId(f),m=="child"?(w=y,p.parent=w.id):(y.parent!==null&&(w=a.byId(y.parent),p.parent=w.id),x=a.getIndexById(f),m=="after"&&(x+=1))):p.parent&&(w=a.byId(p.parent)),!p.start){if(w!=null&&w.start)p.start=new Date(w.start.valueOf());else if(y)p.start=new Date(y.start.valueOf());else{const S=a.getBranch(0);let C;if(S!=null&&S.length){const k=S[S.length-1];if(!k.$skip){const j=new Date(k.start.valueOf());i.start<=j&&(C=j)}}p.start=C||Ke(d)(i.start,1)}p.duration=1,c&&(p.base_start=p.start,p.base_duration=p.duration)}Kt(p,d);const v=a.add(p,x);if(w)for(;w&&w.id;)s.exec("open-task",{id:w.id,mode:!0}),w=a.byId(w.parent);o.id=v.id;const b=a.getSummaryId(v.id);b&&this.resetSummaryDates(b,"add-task"),this.setStateAsync({tasks:a}),s.exec("select-task",{id:v.id,show:g||!1}),o.id=v.id,o.task=v}),s.on("delete-task",o=>{const{id:a}=o,{tasks:i,links:c,selected:u}=this.getState();o.source=i.byId(a).parent;const d=i.getSummaryId(a),f=[a];i.eachChild(p=>f.push(p.id),a),c.filter(p=>!(f.includes(p.source)||f.includes(p.target)));const m={tasks:i,links:c};u.includes(a)&&(m.selected=u.filter(p=>p!==a)),i.remove(a),d&&this.resetSummaryDates(d,"delete-task"),this.setStateAsync(m)}),s.on("indent-task",({id:o,mode:a})=>{const{tasks:i}=this.getState();if(a){const c=i.getBranch(o)[i.getIndexById(o)-1];c&&s.exec("move-task",{id:o,mode:"child",target:c.id})}else{const c=i.byId(o),u=i.byId(c.parent);u&&u.parent!==null&&s.exec("move-task",{id:o,mode:"after",target:c.parent})}}),s.on("copy-task",o=>{const{id:a,target:i,mode:c,eventSource:u}=o;if(u==="copy-task")return;const{tasks:d,links:f}=this.getState();if(d.contains(a,i)){o.skipProvider=!0;return}const m=d.getSummaryId(a),p=d.getSummaryId(i);let g=d.getIndexById(i);c=="before"&&(g-=1);const x=d.byId(a),w=d.copy(x,d.byId(i).parent,g+1);o.source=o.id,o.id=w[0][1],x.lazy&&(o.lazy=!0),m!=p&&p&&this.resetSummaryDates(p,"copy-task");let y=[];for(let v=1;v<w.length;v++){const[b,S]=w[v];f.forEach(C=>{if(C.source===b){const k={...C};delete k.target,y.push({...k,source:S})}else if(C.target===b){const k={...C};delete k.source,y.push({...k,target:S})}})}y=y.reduce((v,b)=>{const S=v.findIndex(C=>C.id===b.id);return S>-1?v[S]={...v[S],...b}:v.push(b),v},[]);for(let v=1;v<w.length;v++){const[b,S]=w[v],C=d.byId(S);s.exec("copy-task",{source:b,id:S,lazy:!!C.lazy,eventSource:"copy-task",target:C.parent,mode:"child"})}y.forEach(v=>{s.exec("add-link",{link:{source:v.source,target:v.target,type:v.type}})}),this.setStateAsync({tasks:d})}),s.on("open-task",({id:o,mode:a})=>{const{tasks:i}=this.getState(),c=i.byId(o);c.lazy?s.exec("request-data",{id:c.id}):(i.toArray().forEach(u=>u.$y=0),i.update(o,{open:a}),this.setState({tasks:i}))}),s.on("scroll-chart",({left:o,top:a})=>{if(!isNaN(o)){const i=this.calcScaleDate(o);this.setState({scrollLeft:o,_scaleDate:i})}isNaN(a)||this.setState({scrollTop:a})}),s.on("render-data",o=>{this.setState({area:o})}),s.on("provide-data",o=>{const{tasks:a,links:i}=this.getState(),c=a.byId(o.id);c.lazy?(c.lazy=!1,c.open=!0):c.data=[],a.parse(o.data.tasks,o.id),this.setStateAsync({tasks:a,links:new Ks(i.map(u=>u).concat(o.data.links))})}),s.on("zoom-scale",({dir:o,offset:a})=>{const{zoom:i,cellWidth:c,_cellWidth:u,scrollLeft:d}=this.getState(),f=a+d,m=this.calcScaleDate(f);let p=c;o<0&&(p=u||c);const g=p+o*50,x=i.levels[i.level],w=o<0&&c>x.maxCellWidth;if(g<x.minCellWidth||g>x.maxCellWidth||w){if(!this.changeScale(i,o))return}else this.setState({cellWidth:g,_cellWidth:g});const{_scales:y,_start:v,cellWidth:b}=this.getState(),S=Je(y.minUnit,v),C=y.diff(m,S,"hour");typeof a>"u"&&(a=b);let k=Math.round(C*b)-a;k<0&&(k=0),this.setState({scrollLeft:k,_scaleDate:m,_zoomOffset:a})}),s.on("expand-scale",({minWidth:o})=>{const{_start:a,_scales:i,start:c,end:u,_end:d,cellWidth:f,_scaleDate:m,_zoomOffset:p}=this.getState(),g=Ke(i.minUnit);let x=i.width;if(c&&u){if(x<o&&x){const S=o/x;this.setState({cellWidth:f*S})}return!0}let w=0;for(;x<o;)x+=f,w++;const y=w?u?-w:-1:0,v=c||g(a,y);let b=0;if(m){const S=i.diff(m,v,"hour");b=Math.max(0,Math.round(S*f)-(p||0))}this.setState({_start:v,_end:u||g(d,w),scrollLeft:b})}),s.on("sort-tasks",({key:o,order:a,add:i})=>{const c=this.getState(),{tasks:u}=c;let d=c._sort;const f={key:o,order:a};let m=(d==null?void 0:d.length)||0;m&&i?(d.forEach((p,g)=>{p.key===o&&(m=g)}),d[m]=f):d=[f],u.sort(d),this.setState({_sort:d,tasks:u})}),s.on("hotkey",({key:o,event:a,eventSource:i})=>{var c,u,d,f;switch(o){case"arrowup":case"arrowdown":{const{selected:m,_tasks:p}=this.getState();a.preventDefault();const g=m.length;let x;if(o==="arrowup"?x=g?(c=this.getPrevRow(m[g-1]))==null?void 0:c.id:(u=p[p.length-1])==null?void 0:u.id:x=g?(d=this.getNextRow(m[g-1]))==null?void 0:d.id:(f=p[0])==null?void 0:f.id,x){const w=i==="chart"?"xy":!0;this.in.exec("select-task",{id:x,show:w})}break}case"ctrl+c":{bt(this,"copy-task",null,null);break}case"ctrl+x":{bt(this,"cut-task",null,null);break}case"ctrl+v":{bt(this,"paste-task",null,null);break}case"ctrl+d":case"backspace":{a.preventDefault(),bt(this,"delete-task",null,null);break}}})}init(n){const s=this.getState().area?{}:{scrollLeft:0,scrollTop:0,area:{from:0,start:0,end:0}};if(n.cellWidth&&(n._cellWidth=n.cellWidth),n._sort=null,fu()&&(n.unscheduledTasks=!1,n.baselines=!1,n.markers=[]),Array.isArray(n.tasks)&&n.tasks.forEach(r=>Kt(r,n.durationUnit)),this._router.init({_scrollTask:null,selected:[],markers:[],autoScale:!0,durationUnit:"day",...s,...n}),n.zoom){const r=nu(n.zoom,n.scales,n.cellWidth);this.setState({zoom:r._zoom,cellWidth:r.cellWidth,_cellWidth:r.cellWidth,scales:r.scales})}}setState(n,s){return this._router.setState(n,s)}setStateAsync(n){this._router.setStateAsync(n)}getTask(n){const{tasks:s}=this.getState();return s.byId(n)}serialize(){const{tasks:n}=this.getState();return n.serialize()}changeScale(n,s){const r=n.level+s,o=n.levels[r];if(o){const{cellWidth:a,scales:i,_scales:c}=this.getState(),u=su(n,s,r,o,c.lengthUnit,i,a);return u._cellWidth=u.cellWidth,this.setState(u),!0}return!1}isScheduled(n){return this.getState().unscheduledTasks?n.some(s=>!s.unscheduled||s.data&&this.isScheduled(s.data)):!0}resetSummaryDates(n,s){const{tasks:r}=this.getState(),o=r.byId(n),a=o.data;if(a!=null&&a.length&&this.isScheduled(a)){const i=vs({...o,start:void 0,end:void 0,duration:void 0});if(!vt(o.start,i.start)||!vt(o.end,i.end)){this.in.exec("update-task",{id:n,task:i,eventSource:s});const c=r.getSummaryId(n);c&&this.resetSummaryDates(c,s)}}}moveSummaryKids(n,s,r){const{tasks:o}=this.getState();n.data.forEach(a=>{var c;const i={...o.byId(a.id),start:s(a.start)};i.type!=="milestone"&&(i.end=s(a.end)),delete i.id,this.in.exec("update-task",{id:a.id,task:i,eventSource:r}),(c=a.data)!=null&&c.length&&this.moveSummaryKids(a,s,r)})}calcScaleDate(n){const{_scales:s,_start:r}=this.getState(),o=s.lengthUnit==="day"?s.lengthUnitWidth/24:s.lengthUnitWidth;return Ke("hour")(Je(s.minUnit,r),Math.floor(n/o))}getNextRow(n){const s=this.getState()._tasks,r=s.findIndex(o=>o.id==n);return s[r+1]}getPrevRow(n){const s=this.getState()._tasks,r=s.findIndex(o=>o.id==n);return s[r-1]}}function wu(t,e,n,s){if(typeof document>"u")return"";const r=document.createElement("canvas");{const o=yu(r,t,e,1,n);vu(o,s,0,t,0,e)}return r.toDataURL()}function yu(t,e,n,s,r){t.setAttribute("width",(e*s).toString()),t.setAttribute("height",(n*s).toString());const o=t.getContext("2d");return o.translate(-.5,-.5),o.strokeStyle=r,o}function vu(t,e,n,s,r,o){t.beginPath(),t.moveTo(s,r),t.lineTo(s,o),e==="full"&&t.lineTo(n,o),t.stroke()}function Ss(t){return t.map(e=>{switch(e.data&&Ss(e.data),e.id){case"add-task:before":case"move-task:up":e.check=(n,s)=>!ku(n,s);break;case"move-task:down":e.check=(n,s)=>!Su(n,s);break;case"indent-task:add":e.check=(n,s)=>Cu(n,s)!==n.parent;break;case"indent-task:remove":e.check=n=>!bu(n);break}return e})}function bu(t){return t.parent===0}function ku(t,e){var n;return((n=e[0])==null?void 0:n.id)===t.id}function Su(t,e){var n;return((n=e[e.length-1])==null?void 0:n.id)===t.id}function Cu(t,e){var s;const n=e.findIndex(r=>r.id===t.id);return((s=e[n-1])==null?void 0:s.id)??t.parent}const ju=t=>e=>e.type!==t,ir=Ss([{id:"add-task",text:"Add",icon:"wxi-plus",data:[{id:"add-task:child",text:"Child task"},{id:"add-task:before",text:"Task above"},{id:"add-task:after",text:"Task below"}]},{type:"separator"},{id:"convert-task",text:"Convert to",icon:"wxi-swap-horizontal",dataFactory:t=>({id:`convert-task:${t.id}`,text:`${t.label}`,check:ju(t.id)})},{id:"edit-task",text:"Edit",icon:"wxi-edit",subtext:"Ctrl+E"},{id:"cut-task",text:"Cut",icon:"wxi-content-cut",subtext:"Ctrl+X"},{id:"copy-task",text:"Copy",icon:"wxi-content-copy",subtext:"Ctrl+C"},{id:"paste-task",text:"Paste",icon:"wxi-content-paste",subtext:"Ctrl+V"},{id:"move-task",text:"Move",icon:"wxi-swap-vertical",data:[{id:"move-task:up",text:"Up"},{id:"move-task:down",text:"Down"}]},{type:"separator"},{id:"indent-task:add",text:"Indent",icon:"wxi-indent"},{id:"indent-task:remove",text:"Outdent",icon:"wxi-unindent"},{type:"separator"},{id:"delete-task",icon:"wxi-delete",text:"Delete",subtext:"Ctrl+D / BS"}]),es=Ss([{id:"add-task",comp:"button",icon:"wxi-plus",text:"New task",type:"primary"},{id:"edit-task",comp:"icon",icon:"wxi-edit",menuText:"Edit",text:"Ctrl+E"},{id:"delete-task",comp:"icon",icon:"wxi-delete",menuText:"Delete",text:"Ctrl+D, Backspace"},{comp:"separator"},{id:"move-task:up",comp:"icon",icon:"wxi-angle-up",menuText:"Move up"},{id:"move-task:down",comp:"icon",icon:"wxi-angle-down",menuText:"Move down"},{comp:"separator"},{id:"copy-task",comp:"icon",icon:"wxi-content-copy",menuText:"Copy",text:"Ctrl+V"},{id:"cut-task",comp:"icon",icon:"wxi-content-cut",menuText:"Cut",text:"Ctrl+X"},{id:"paste-task",comp:"icon",icon:"wxi-content-paste",menuText:"Paste",text:"Ctrl+V"},{comp:"separator"},{id:"indent-task:add",comp:"icon",icon:"wxi-indent",menuText:"Indent"},{id:"indent-task:remove",comp:"icon",icon:"wxi-unindent",menuText:"Outdent"}]),Mu=[{key:"text",comp:"text",label:"Name",config:{placeholder:"Add task name"}},{key:"details",comp:"textarea",label:"Description",config:{placeholder:"Add description"}},{key:"type",comp:"select",label:"Type"},{key:"start",comp:"date",label:"Start date"},{key:"end",comp:"date",label:"End date"},{key:"duration",comp:"counter",label:"Duration",config:{min:1}},{key:"unscheduled",comp:"twostate",label:"",config:{value:!0,text:"Unschedule",textActive:"Schedule"}},{key:"progress",comp:"slider",label:"Progress",config:{min:1,max:100}},{key:"links",comp:"links",label:""}],_u=[{id:"task",label:"Task"},{id:"summary",label:"Summary task"},{id:"milestone",label:"Milestone"}];new Date().valueOf();function $u(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in e){const s=t[n],r=e[n];if(!Jt(s,r))return!1}return!0}function Jt(t,e){if(typeof t=="number"||typeof t=="string"||typeof t=="boolean"||t===null)return t===e;if(typeof t!=typeof e||(t===null||e===null)&&t!==e||t instanceof Date&&e instanceof Date&&t.getTime()!==e.getTime())return!1;if(typeof t=="object")if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(let n=t.length-1;n>=0;n--)if(!Jt(t[n],e[n]))return!1;return!0}else return $u(t,e);return t===e}function ts(t){if(typeof t!="object"||t===null)return t;if(t instanceof Date)return new Date(t);if(t instanceof Array)return t.map(ts);const e={};for(const n in t)e[n]=ts(t[n]);return e}var wo=2,Nu=class{constructor(e){e&&(this._writable=e.writable,this._async=e.async),this._values={},this._state={}}setState(e,n=0){const s={};return this._wrapProperties(e,this._state,this._values,"",s,n),s}getState(){return this._values}getReactive(){return this._state}_wrapProperties(e,n,s,r,o,a){for(const i in e){const c=n[i],u=s[i],d=e[i];if(c&&(u===d&&typeof d!="object"||d instanceof Date&&u instanceof Date&&u.getTime()===d.getTime()))continue;const f=r+(r?".":"")+i;c?(c.__parse(d,f,o,a)&&(s[i]=d),a&wo?o[f]=c.__trigger:c.__trigger()):(d&&d.__reactive?n[i]=this._wrapNested(d,d,f,o):n[i]=this._wrapWritable(d),s[i]=d),o[f]=o[f]||null}}_wrapNested(e,n,s,r){const o=this._wrapWritable(e);return this._wrapProperties(e,o,n,s,r,0),o.__parse=(a,i,c,u)=>(this._wrapProperties(a,o,n,i,c,u),!1),o}_wrapWritable(e){const n=[],s=function(){for(let r=0;r<n.length;r++)n[r](e)};return{subscribe:r=>(n.push(r),this._async?setTimeout(r,1,e):r(e),()=>{const o=n.indexOf(r);o>=0&&n.splice(o,1)}),__trigger:()=>{n.length&&(this._async?setTimeout(s,1):s())},__parse:function(r){return e=r,!0}}}},Eu=class{constructor(t,e,n,s){typeof t=="function"?this._setter=t:this._setter=t.setState.bind(t),this._routes=e,this._parsers=n,this._prev={},this._triggers=new Map,this._sources=new Map,this._routes.forEach(r=>{r.in.forEach(o=>{const a=this._triggers.get(o)||[];a.push(r),this._triggers.set(o,a)}),r.out.forEach(o=>{const a=this._sources.get(o)||{};r.in.forEach(i=>a[i]=!0),this._sources.set(o,a)})}),this._routes.forEach(r=>{r.length=Math.max(...r.in.map(o=>yo(o,this._sources,1)))}),this._bus=s}init(t){const e={};for(const n in t)if(this._prev[n]!==t[n]){const s=this._parsers[n];e[n]=s?s(t[n]):t[n]}this._prev=this._prev?{...this._prev,...t}:{...t},this.setState(e),this._bus&&this._bus.exec("init-state",e)}setStateAsync(t){const e=this._setter(t,wo);return this._async?Object.assign(this._async.signals,e):this._async={signals:e,timer:setTimeout(this._applyState.bind(this),1)},e}_applyState(){const t=this._async;if(t){this._async=null,this._triggerUpdates(t.signals,[]);for(const e in t.signals){const n=t.signals[e];n&&n()}}}setState(t,e=[]){const n=this._setter(t);return this._triggerUpdates(n,e),n}_triggerUpdates(t,e){const n=Object.keys(t),s=!e.length;e=e||[];for(let r=0;r<n.length;r++){const o=n[r],a=this._triggers.get(o);a&&a.forEach(i=>{e.indexOf(i)==-1&&e.push(i)})}s&&this._execNext(e)}_execNext(t){for(;t.length;){t.sort((n,s)=>n.length<s.length?1:-1);const e=t[t.length-1];t.splice(t.length-1),e.exec(t)}}};function yo(t,e,n){const s=e.get(t);if(!s)return n;const r=Object.keys(s).map(o=>yo(o,e,n+1));return Math.max(...r)}var Tu=class{constructor(){this._nextHandler=null,this._handlers={},this._tag=new WeakMap,this.exec=this.exec.bind(this)}on(e,n,s){let r=this._handlers[e];r?s&&s.intercept?r.unshift(n):r.push(n):r=this._handlers[e]=[n],s&&s.tag&&this._tag.set(n,s.tag)}intercept(e,n,s){this.on(e,n,{...s,intercept:!0})}detach(e){for(const n in this._handlers){const s=this._handlers[n];for(let r=s.length-1;r>=0;r--)this._tag.get(s[r])===e&&s.splice(r,1)}}async exec(e,n){const s=this._handlers[e];if(s)for(let r=0;r<s.length;r++){const o=s[r](n);if(o===!1||o&&o.then&&await o===!1)return}return this._nextHandler&&await this._nextHandler.exec(e,n),n}setNext(e){return this._nextHandler=e}};function Ru(t){return e=>e[t]}function Du(t){return(e,n)=>e[t]=n}function ht(t,e){return(e.getter||Ru(e.id))(t)}function lr(t,e,n){return(e.setter||Du(e.id))(t,n)}function cr(t,e){const n=document.createElement("a");n.href=URL.createObjectURL(t),n.download=e,document.body.appendChild(n),n.click(),document.body.removeChild(n)}function Tt(t,e){let n=ht(t,e)??"";return e.template&&(n=e.template(n,t,e)),e.optionsMap&&(Array.isArray(n)?n=n.map(s=>e.optionsMap.get(s)):n=e.optionsMap.get(n)),typeof n>"u"?"":n+""}function Iu(t,e){const n=/\n|"|;|,/;let s="";const r=e.rows||`
`,o=e.cols||"	",a=t._columns,i=t.flatData;e.header!==!1&&a[0].header&&(s=ur("header",a,s,o,r));for(let c=0;c<i.length;c++){const u=[];for(let d=0;d<a.length;d++){let f=Tt(i[c],a[d]);n.test(f)&&(f='"'+f.replace(/"/g,'""')+'"'),u.push(f)}s+=(s?r:"")+u.join(o)}return e.footer!==!1&&a[0].footer&&(s=ur("footer",a,s,o,r)),s}function ur(t,e,n,s,r){const o=/\n|"|;|,/;for(let a=0;a<e[0][t].length;a++){const i=[];for(let c=0;c<e.length;c++){let u=(e[c][t][a].text||"")+"";o.test(u)&&(u='"'+u.replace(/"/g,'""')+'"'),i.push(u)}n+=(n?r:"")+i.join(s)}return n}function Pu(t,e,n){const s=[],r=[],o=[];let a=[];const i=t._columns,c=t.flatData,u=t._sizes;for(const f of i)o.push({width:f.flexgrow?u.columnWidth:f.width});let d=0;e.header!==!1&&i[0].header&&(dr("header",i,s,r,d,e,n),a=a.concat(u.headerRowHeights.map(f=>({height:f}))),d+=i[0].header.length);for(let f=0;f<c.length;f++){const m=[];for(let p=0;p<i.length;p++){const g=c[f],x=i[p],w=ht(g,x)??"";let y=Tt(g,x),v;e.cellStyle&&(v=e.cellStyle(w,g,x)),e.cellTemplate&&(y=e.cellTemplate(w,g,x)??y);const b=vo(y,2,v,n);m.push(b)}s.push(m),a.push({height:u.rowHeight})}return d+=c.length,e.footer!==!1&&i[0].footer&&(dr("footer",i,s,r,d,e,n),a=a.concat(u.footerRowHeights.map(f=>({height:f})))),{cells:s,merged:r,rowSizes:a,colSizes:o,styles:n}}function dr(t,e,n,s,r,o,a){for(let i=0;i<e[0][t].length;i++){const c=[];for(let u=0;u<e.length;u++){const d=e[u][t][i],f=d.colspan?d.colspan-1:0,m=d.rowspan?d.rowspan-1:0;(f||m)&&s.push({from:{row:i+r,column:u},to:{row:i+r+m,column:u+f}});let p=d.text??"",g;o.headerCellStyle&&(g=o.headerCellStyle(p,d,e[u],t)),o.headerCellTemplate&&(p=o.headerCellTemplate(p,d,e[u],t)??p);let x;t=="header"?i==e[0][t].length-1?x=1:x=0:i?x=4:x=3;const w=vo(p,x,g,a);c.push(w)}n.push(c)}}function vo(t,e,n,s){let r=e;if(t&&t instanceof Date&&(t=Lu(t),n=n||{},n.format=n.format||"dd/mm/yyyy"),n){n={...s[e],...n};const o=s.findIndex(a=>Jt(a,n));o<0?(s.push(n),r=s.length-1):r=o}return{v:t+"",s:r}}function Au(t){const e={material:"#000000",willow:"#000000","willow-dark":"#ffffff"},n={material:"none",willow:"none","willow-dark":"#2a2b2d"},s={material:"#fafafb",willow:"#f2f3f7","willow-dark":"#20262b"},r={material:"0.5px solid #dfdfdf",willow:"0.5px solid #e6e6e6","willow-dark":"0.5px solid #384047"},o={material:"#dfdfdf",willow:"#e6e6e6","willow-dark":"#384047"},a=e[t],i="0.5px solid "+o[t],c={verticalAlign:"center",align:"left"},u={fontWeight:"bold",color:a,background:s[t],...c,borderBottom:i,borderRight:i};return{cell:{color:a,background:n[t],borderBottom:r[t],borderRight:r[t],...c},header:{...u},footer:{...u}}}function Lu(t){return t?25569+(t.getTime()-t.getTimezoneOffset()*6e4)/(86400*1e3):null}const Hu="portrait",Ou=100,Wu="a4",zu={a3:{width:11.7,height:16.5},a4:{width:8.27,height:11.7},letter:{width:8.5,height:11}};function Fu(t,e){const n=[];let s=[],r=0;const o=t.filter(i=>!i.hidden),a=Vu(e);return o.forEach((i,c)=>{r+i.width<=a?(r+=i.width,s.push(i)):(s.length&&n.push(s),s=[i],r=i.width),c===o.length-1&&s.length&&n.push(s)}),n}function fr(t,e,n){const s=[];return t.forEach((r,o)=>{const a=r[e];for(let i=0;i<n.length;i++){s[i]||(s[i]=[]);const c={...a[i]};if(s[i][o]!==null){if(!o&&!c.rowspan&&!c.colspan){let u=1,d=t[o+u][e][i],f=c.width;for(;!d.rowspan&&!d.colspan;)u++,d=t[o+u][e][i],f+=d.width;c.colspan=u,c.width=f,c.height=n[i]}if(s[i].push(c),!c.collapsed&&c.colspan>1){let u=c.colspan-1;if(c.colspan+o>t.length){const d=c.colspan-(c.colspan+o-t.length);c.colspan=d,c.width=t.slice(o,o+u+1).reduce((f,m)=>f+m.width,0),d>1&&(u=d-1)}for(let d=0;d<u;d++)s[i].push(null)}if(c.rowspan>1){const u=c.rowspan;for(let d=1;d<u;d++)s[i+d]||(s[i+d]=[]),s[i+d].push(null)}}}if(r.collapsed)for(let i=0;i<s.length;i++){const c=s[i],u=c[o];if(u&&u.collapsed){if(c[o]=null,!i)break}else{const d=u||c.findLast(f=>(f==null?void 0:f.colspan)>=1);d&&(d.colspan=d.colspan-1,d.width=d.width-r.width)}}}),s.map(r=>r.filter(o=>o&&o.colspan!==0))}function Vu(t){const{mode:e,ppi:n,paper:s}=t,{width:r,height:o}=zu[s];return Bu(e==="portrait"?r:o,n)}function Bu(t,e){return t*e}function Yu(t={}){const{mode:e,ppi:n,paper:s}=t;return{mode:e||Hu,ppi:n||Ou,paper:s||Wu}}function bo(t,e){return t.flexgrow?`min-width:${e}px;width:auto`:`width:${t.width}px; max-width:${t.width}px; height:${t.height}px`}function Gu(t,e,n){var r;let s=t[n.id];if(n.filter.type==="richselect"&&s){const o=((r=n.filter.config)==null?void 0:r.options)||e.find(({id:a})=>a==n.id).options;o&&(s=o.find(({id:a})=>a==s).label)}return s??""}const hr=["resize-column","hide-column","update-cell"],Uu=["delete-row","update-row","update-cell"],Ku=["move-item"],qu=["resize-column","move-item"];class Qu{constructor(e,n,s){Re(this,"undo",[]);Re(this,"redo",[]);Re(this,"progress",{});Re(this,"in");Re(this,"getState");Re(this,"setState");Re(this,"_previousValues",{});this.in=e,this.getState=n,this.setState=s,this.setHandlers(),this.resetStateHistory()}getHandlers(){return{"add-row":{handler:e=>({action:"delete-row",data:{id:e.id},source:{action:"add-row",data:e}})},"delete-row":{handler:e=>{const{id:n}=e,{data:s}=this.getPrev(),r=s.findIndex(o=>o.id==n);return{action:"add-row",data:{id:n,row:s[r],before:r<s.length-1?s[r+1].id:void 0},source:{action:"delete-row",data:e}}}},"update-cell":{handler:e=>{const{id:n,column:s}=e,r=this.getRow(n),o=this.getColumn(s),a=ht(r,o);return Jt(a,e.value)?null:{action:"update-cell",data:{id:n,column:s,value:a},source:{action:"update-cell",data:e}}}},"update-row":{handler:e=>{const{id:n}=e,s=this.getRow(n);return{action:"update-row",data:{id:n,row:s},source:{action:"update-row",data:e}}}},"resize-column":{handler:e=>{const{id:n,width:s}=e,r=this.getColumn(n),{_sizes:o}=this.getState();return{action:"resize-column",data:{id:n,width:r.width??o.columnWidth},source:{action:"resize-column",data:{id:n,width:s}}}}},"hide-column":{handler:e=>{const{id:n}=e,s=this.getColumn(n);return{action:"hide-column",data:{id:n,mode:s.hidden},source:{action:"hide-column",data:e}}}},"collapse-column":{handler:e=>{const{id:n,row:s,mode:r}=e;return{action:"collapse-column",data:{id:n,row:s,mode:typeof r=="boolean"?!r:r},source:{action:"collapse-column",data:e}}}},"move-item":{handler:e=>{const{id:n,target:s,mode:r}=e,{flatData:o}=this.getPrev(),a=o.findIndex(i=>i.id==n);return{action:"move-item",data:{id:n,target:o[a+(a?-1:1)].id,mode:a?"after":"before"},source:{action:"move-item",data:{id:n,target:s,mode:r}}}}},"open-row":{handler:e=>{const{id:n,nested:s}=e;return{action:"close-row",data:{id:n,nested:s},source:{action:"open-row",data:e}}}},"close-row":{handler:e=>{const{id:n,nested:s}=e;return{action:"open-row",data:{id:n,nested:s},source:{action:"close-row",data:e}}}}}}resetHistory(){this.undo=[],this.redo=[],this.progress={},this.resetStateHistory()}getPrev(){return this._previousValues}setHandlers(){const e=this.getHandlers();for(const n in e)this.in.intercept(n,s=>{if(!(s.eventSource==="undo"||s.eventSource==="redo"||s.skipUndo)){if(qu.includes(n)){(s.inProgress&&!this.progress[n]||typeof s.inProgress!="boolean")&&(Ku.includes(n)&&this.setPrev("flatData"),hr.includes(n)&&this.setPrev("columns")),this.progress[n]=s.inProgress;return}Uu.includes(n)&&this.setPrev("data"),hr.includes(n)&&this.setPrev("columns")}}),this.in.on(n,s=>{if(s.eventSource==="undo"||s.eventSource==="redo"||s.skipUndo||s.inProgress)return;const r=e[n].handler(s);r&&this.addToHistory(r)})}setPrev(e){this._previousValues[e]=ts(this.getState()[e])}addToHistory(e){this.undo.push(e),this.redo=[],this.setStateHistory()}handleUndo(){if(!this.undo.length)return;const e=this.undo.pop();this.redo.push({...e.source,source:e}),this.in.exec(e.action,{...e.data,eventSource:"undo"}),this.setStateHistory()}handleRedo(){if(!this.redo.length)return;const e=this.redo.pop();this.undo.push({...e.source,source:e}),this.in.exec(e.action,{...e.data,eventSource:"redo"}),this.setStateHistory()}resetStateHistory(){this.setState({history:{undo:0,redo:0}})}setStateHistory(){this.setState({history:{undo:this.undo.length,redo:this.redo.length}})}getRow(e){const{data:n}=this.getPrev();return this.getState().tree?this.getTreeRow(n,e):n.find(s=>s.id==e)}getTreeRow(e,n){for(let s=0;s<e.length;s++){if(e[s].id==n)return e[s];if(e[s].data){const r=this.getTreeRow(e[s].data,n);if(r)return r}}return null}getColumn(e){const{columns:n}=this.getPrev();return n.find(s=>s.id==e)}}function Cs(){let t=!0;return t=!1,t}function ko(t,e){return typeof t>"u"||t===null?-1:typeof e>"u"||e===null?1:t===e?0:t>e?1:-1}function Xu(t,e){return-ko(t,e)}function Ju(t,e){const n=t==="asc"?ko:Xu;return function(s,r){return n(ht(s,e),ht(r,e))}}function Zu(t,e){if(!t||!t.length)return;const n=t.map(s=>Ju(s.order,e.find(r=>r.id==s.key)));return t.length===1?n[0]:function(s,r){for(let o=0;o<n.length;o++){const a=n[o](s,r);if(a!==0)return a}return 0}}const un=28,ed=20;function td(){if(typeof document>"u")return"willow";const t=document.querySelector('[class^="wx"][class$="theme"]');return t?t.className.substring(3,t.className.length-6):"willow"}function wn(t,e,n,s,r){const o=document.createElement("div"),a=document.createElement("div"),i=document.body;r=r?`${r}px`:"auto";let c,u;a.className=e,o.classList.add(`wx-${n}-theme`),o.style.cssText=`height:auto;position:absolute;top:0px;left:100px;overflow:hidden;width=${r};white-space:nowrap;`,o.appendChild(a),i.appendChild(o),typeof t!="object"&&(t=[t]);for(let d=0;d<t.length;d++){a.innerText=t[d]+"";const f=o.getBoundingClientRect(),m=Math.ceil(f.width)+(s&&s.length?s[d]:0),p=Math.ceil(f.height);c=Math.max(c||0,m),u=Math.max(u||0,p)}return o.remove(),{width:c,height:u}}function pr(t,e,n,s,r){const o=[];for(let a=0;a<t.length;a++){const i=t[a][e],c=i.length;for(let u=0;u<c;u++){const{text:d,vertical:f,collapsed:m,rowspan:p,css:g}=i[u];if(!d){o[u]=Math.max(o[u]||0,s);continue}let x=0;if(f&&!m){let w=`wx-measure-cell-${e}`;if(w+=g?` ${g}`:"",x=wn(d,w,r).width,(p>1||!i[u+1])&&n>u+1){const y=p||n-u,v=o.slice(u,u+y).reduce((b,S)=>b+S,0);if(v<x){const b=Math.ceil((x-v)/y);for(let S=u;S<u+y;S++)o[S]=(o[S]||s)+b}continue}}o[u]=Math.max(o[u]||s,x)}}return o}function nd(t,e,n){const s=[],r=[];let o="wx-measure-cell-body";o+=t.css?` ${t.css}`:"";for(let a=0;a<e.length;a++){const i=e[a],c=Tt(i,t);c&&(s.push(c),t.treetoggle?r.push(e[a].$level*un+(e[a].$count?un:0)+(t.draggable?un:0)):t.draggable&&r.push(un))}return wn(s,o,n,r).width}function sd(t,e){const n="wx-measure-cell-header",s=t.sort?ed:0;let r=t.header;if(typeof r=="string")return wn(r,n,e).width+s;let o;Array.isArray(r)||(r=[r]);for(let a=0;a<r.length;a++){const i=r[a],c=typeof i=="string"?i:i.text,u=n+(typeof i=="string"?"":` ${i.css}`);let d=wn(c,u,e).width;a===r.length-1&&(d+=s),o=Math.max(o||0,d)}return o}const rd={text:(t,e)=>t?t.toLowerCase().indexOf(e.toLowerCase())!==-1:!e,richselect:(t,e)=>typeof e!="number"&&!e?!0:t==e};function od(t){return rd[t]}class ad extends Nu{constructor(n){super({writable:n,async:!1});Re(this,"in");Re(this,"_router");Re(this,"_branches");Re(this,"_xlsxWorker");Re(this,"_historyManager");const s={rowHeight:37,columnWidth:160,headerHeight:36,footerHeight:36};this._router=new Eu(super.setState.bind(this),[{in:["columns","sizes","_skin"],out:["_columns","_sizes"],exec:o=>{const{columns:a,sizes:i,_skin:c}=this.getState(),u=this.copyColumns(a),d=u.reduce((p,g)=>Math.max(g.header.length,p),0),f=u.reduce((p,g)=>Math.max(g.footer.length,p),0);u.forEach(this.setCollapsibleColumns);const m=this.normalizeSizes(u,i,d,f,c);u.forEach((p,g)=>{this.normalizeColumns(u,g,"header",d,m),this.normalizeColumns(u,g,"footer",f,m)}),this.setState({_columns:u,_sizes:m},o)}},{in:["data","tree","_filterIds"],out:["flatData"],exec:o=>{const{data:a,tree:i,_filterIds:c}=this.getState(),u=i?this.flattenRows(a,[],c):a.filter(d=>!c||c.includes(d.id));this.setState({flatData:u},o)}}],{sizes:o=>({...s,...o})});const r=this.in=new Tu;r.on("close-editor",({ignore:o})=>{const{editor:a}=this.getState();a&&(o||r.exec("update-cell",a),this.setState({editor:null}))}),r.on("open-editor",({id:o,column:a})=>{let i=this.getState().editor;i&&r.exec("close-editor",{});const c=this.getRow(o),u=a?this.getColumn(a):this.getNextEditor(c);if(u!=null&&u.editor){let d=u.editor;if(typeof d=="function"&&(d=d(c,u)),!d)return;i={column:u.id,id:o,value:ht(c,u)??"",renderedValue:Tt(c,u)},typeof d=="object"&&d.config&&(i.config=d.config,d.config.options&&(i.options=d.config.options)),u.options&&!i.options&&(i.options=u.options),this.setState({editor:i})}}),r.on("editor",({value:o})=>{const a=this.getState().editor;a&&(a.value=o,this.setState({editor:a}))}),r.on("add-row",o=>{const a=this.getState();let{data:i}=a;const{select:c,_filterIds:u}=a,{row:d,before:f,after:m,select:p}=o;if(o.id=d.id=o.id||d.id||On(),f||m){const x=f||m,w=i.findIndex(y=>y.id===x);i.splice(w+(m?1:0),0,o.row),i=[...i]}else i=[...i,o.row];const g={data:i};u&&(g._filterIds=[...u,o.id]),this.setState(g),!(typeof p=="boolean"&&!p)&&(p||c)&&r.exec("select-row",{id:d.id,show:!0})}),r.on("delete-row",o=>{const{data:a,selectedRows:i,focusCell:c}=this.getState(),{id:u}=o,d={data:a.filter(f=>f.id!==u)};this.isSelected(u)&&(d.selectedRows=i.filter(f=>f!==u)),this.setState(d),(c==null?void 0:c.row)===u&&this.in.exec("focus-cell",{eventSource:"delete-row"})}),r.on("update-cell",o=>{const a=this.getState();let{data:i}=a;i=[...i];const{tree:c}=a,{id:u,column:d,value:f}=o,m=this.getColumn(d);if(c){const p={...this._branches[u]};lr(p,m,f);const g=this.updateTreeRow(p);p.$parent===0&&(i=g)}else{const p=i.findIndex(x=>x.id==u),g={...i[p]};lr(g,m,f),i[p]=g}this.setState({data:i})}),r.on("update-row",o=>{let{data:a}=this.getState();const{id:i,row:c}=o,u=a.findIndex(d=>d.id==i);a=[...a],a[u]={...a[u],...c},this.setState({data:a})}),r.on("select-row",({id:o,toggle:a,range:i,mode:c,show:u,column:d})=>{const f=this.getState(),{focusCell:m}=f;let{selectedRows:p}=f;if(p.length||(i=a=!1),i){const{data:g}=this.getState();let x=g.findIndex(y=>y.id==p[p.length-1]),w=g.findIndex(y=>y.id==o);x>w&&([x,w]=[w,x]),g.slice(x,w+1).forEach(y=>{p.indexOf(y.id)===-1&&p.push(y.id)})}else if(a&&this.isSelected(o)){if(c===!0)return;p=p.filter(g=>g!==o)}else if(a){if(c===!1)return;p.push(o)}else p=[o];this.setState({selectedRows:p}),(m==null?void 0:m.row)!==o&&this.in.exec("focus-cell",{eventSource:"select-row"}),u&&this.in.exec("scroll",{row:o,column:d})}),this.in.on("focus-cell",o=>{const{row:a,column:i,eventSource:c}=o,{_columns:u,split:d}=this.getState();a&&i?(this.setState({focusCell:{row:a,column:i}}),c!=="click"&&((!d.left||u.findIndex(f=>f.id==o.column)>=d.left)&&(!d.right||u.findIndex(f=>f.id==o.column)<u.length-d.right)?this.in.exec("scroll",{row:a,column:i}):this.in.exec("scroll",{row:a}))):this.setState({focusCell:null})}),r.on("resize-column",o=>{const{id:a,auto:i,maxRows:c,inProgress:u}=o;if(u===!1)return;let d=o.width||0;const f=[...this.getState().columns],m=f.find(p=>p.id==a);if(i){if(i=="data"||i===!0){const{flatData:p,_skin:g}=this.getState();let x=p.length;c&&(x=Math.min(c,x));const w=p.slice(0,x);d=nd(m,w,g)}if(i=="header"||i===!0){const{_skin:p}=this.getState();d=Math.max(sd(m,p),d)}}m.width=Math.max(17,d),delete m.flexgrow,this.setState({columns:f})}),r.on("hide-column",o=>{const{id:a,mode:i}=o,c=[...this.getState().columns],u=c.find(f=>f.id==a),d=c.reduce((f,m)=>f+(m.hidden?0:1),0);!i||d>1?(u.hidden=!u.hidden,this.setState({columns:c})):o.skipUndo=!0}),r.on("sort-rows",o=>{var v;const{key:a,add:i}=o;let{order:c="asc"}=o;const u=this.getState();let d=u.sortMarks;const{columns:f,data:m,tree:p}=u,g=Object.keys(d),x=g.length;d[a]&&(c=d[a].order==="asc"?"desc":"asc"),!i||!x||x===1&&d[a]?d={[a]:{order:c}}:(x===1&&(d[g[0]]={...d[g[0]],index:0}),d={...d,[a]:{order:c,index:((v=d[a])==null?void 0:v.index)??x}});const w=Object.keys(d).sort((b,S)=>d[b].index-d[S].index).map(b=>({key:b,order:d[b].order}));this.setState({sortMarks:d});const y=Zu(w,f);if(y){const b=[...m];p?this.sortTree(b,y):b.sort(y),this.setState({data:b})}}),r.on("filter-rows",o=>{const{value:a,key:i,filter:c}=o;if(!Object.keys(o).length){this.setState({filterValues:{},_filterIds:null});return}const u=this.getState(),{data:d,tree:f}=u;let m=u.filterValues;const p={};i&&(m={...m,[i]:a},p.filterValues=m);const g=c??this.createFilter(m);let x=[];f?x=this.filterTree(d,g,x):d.forEach(w=>{g(w)&&x.push(w.id)}),p._filterIds=x,this.setState(p)}),r.on("collapse-column",o=>{const{id:a,row:i,mode:c}=o,u=[...this.getState().columns],d=this.getColumn(a).header,f=Array.isArray(d)?d[i]:d;typeof f=="object"&&(f.collapsed=c??!f.collapsed,this.setState({columns:u}))}),r.on("move-item",o=>{const{id:a,target:i,mode:c="after",inProgress:u}=o,{data:d,flatData:f,tree:m}=this.getState(),p=f.findIndex(w=>w.id==a),g=f.findIndex(w=>w.id==i);if(p===-1||g===-1||u===!1)return;let x;m?x=this.moveItem(a,i,d,c):x=this.moveItem(a,i,d,c),this.setState({data:m?this.normalizeTreeRows(x):x})}),r.on("open-row",o=>{const{id:a,nested:i}=o;this.toggleBranch(a,!0,i)}),r.on("close-row",o=>{const{id:a,nested:i}=o;this.toggleBranch(a,!1,i)}),r.on("export",o=>new Promise((a,i)=>{const c=o.options||{},u=`${c.fileName||"data"}.${c.format}`;if(c.format=="csv"){const d=Iu(this.getState(),c);c.download!==!1?cr(new Blob(["\uFEFF"+d],{type:"text/csv"}),u):o.result=d,a(!0)}else if(c.format=="xlsx"){let d=c.styles;!d&&d!==!1&&(d=Au(this.getState()._skin));const f=d,m=f?[{...f.header},{...f.lastHeaderCell||f.header},{...f.cell},{...f.firstFooterCell||f.footer},{...f.footer}]:Array(5).fill({}),{cells:p,merged:g,rowSizes:x,colSizes:w,styles:y}=Pu(this.getState(),c,m),v=c.cdn||"https://cdn.dhtmlx.com/libs/json2excel/1.3.2/worker.js";this.getXlsxWorker(v).then(b=>{b.onmessage=S=>{if(S.data.type=="ready"){const C=S.data.blob;c.download!==!1?cr(C,u):o.result=C,a(!0)}},b.postMessage({type:"convert",data:{data:[{name:c.sheetName||"data",cells:p,cols:w,rows:x,merged:g}],styles:y}})})}else i()})),r.on("hotkey",({key:o,event:a,isInput:i})=>{var c,u,d,f,m,p,g,x,w,y,v,b,S;switch(o){case"arrowup":{const{flatData:C,focusCell:k,select:j}=this.getState();if(a.preventDefault(),i)return;const N=k?k.column:(c=this._getFirstVisibleColumn())==null?void 0:c.id,_=k?(u=this.getPrevRow(k.row))==null?void 0:u.id:(d=C[C.length-1])==null?void 0:d.id;N&&_&&(this.in.exec("focus-cell",{row:_,column:N,eventSource:"key"}),j&&this.in.exec("select-row",{id:_}));break}case"arrowdown":{const{flatData:C,focusCell:k,select:j}=this.getState();if(a.preventDefault(),i)return;const N=k?k.column:(f=this._getFirstVisibleColumn())==null?void 0:f.id,_=k?(m=this.getNextRow(k.row))==null?void 0:m.id:(p=C[0])==null?void 0:p.id;N&&_&&(this.in.exec("focus-cell",{row:_,column:N,eventSource:"key"}),j&&this.in.exec("select-row",{id:_}));break}case"arrowright":{const{focusCell:C}=this.getState();if(i)return;if(a.preventDefault(),C){const k=(g=this.getNextColumn(C.column,!0))==null?void 0:g.id;k&&this.in.exec("focus-cell",{row:C.row,column:k,eventSource:"key"})}break}case"arrowleft":{const{focusCell:C}=this.getState();if(i)return;if(a.preventDefault(),C){const k=(x=this.getPrevColumn(C.column,!0))==null?void 0:x.id;k&&this.in.exec("focus-cell",{row:C.row,column:k,eventSource:"key"})}break}case"tab":{const{editor:C,focusCell:k,select:j}=this.getState();if(C){a.preventDefault();const N=C.column;let _=C.id,$=this.getNextEditor(this.getRow(_),this.getColumn(N));if(!$){const M=this.getNextRow(_);M&&(_=M.id,$=this.getNextEditor(M))}$&&(this.in.exec("open-editor",{id:_,column:$.id}),this.in.exec("focus-cell",{row:_,column:$.id,eventSource:"key"}),j&&!this.isSelected(_)&&this.in.exec("select-row",{id:_}))}else k&&this.in.exec("focus-cell",{eventSource:"key"});break}case"shift+tab":{const{editor:C,focusCell:k,select:j}=this.getState();if(C){a.preventDefault();const N=C.column;let _=C.id,$=this.getPrevEditor(this.getRow(_),this.getColumn(N));if(!$){const M=this.getPrevRow(_);M&&(_=M.id,$=this.getPrevEditor(M))}$&&(this.in.exec("open-editor",{id:_,column:$.id}),this.in.exec("focus-cell",{row:_,column:$.id,eventSource:"key"}),j&&!this.isSelected(_)&&this.in.exec("select-row",{id:_}))}else k&&this.in.exec("focus-cell",{eventSource:"key"});break}case"escape":{const{editor:C}=this.getState();C&&(this.in.exec("close-editor",{ignore:!0}),this.in.exec("focus-cell",{row:C.id,column:C.column,eventSource:"key"}));break}case"f2":{const{editor:C,focusCell:k}=this.getState();!C&&k&&this.in.exec("open-editor",{id:k.row,column:k.column});break}case"enter":{const{focusCell:C,tree:k}=this.getState();if(!i&&k&&C&&this.getColumn(C.column).treetoggle){const j=this.getRow(C.row);if(!j.data)return;this.in.exec(j.open?"close-row":"open-row",{id:C.row,nested:!0})}break}case"home":{const{editor:C,focusCell:k}=this.getState();if(!C&&k){a.preventDefault();const j=(w=this._getFirstVisibleColumn())==null?void 0:w.id;this.in.exec("focus-cell",{row:k.row,column:j,eventSource:"key"})}break}case"ctrl+home":{const{editor:C,focusCell:k,flatData:j,select:N}=this.getState();if(!C&&k){a.preventDefault();const _=(y=j[0])==null?void 0:y.id,$=(v=this._getFirstVisibleColumn())==null?void 0:v.id;_&&$&&(this.in.exec("focus-cell",{row:_,column:$,eventSource:"key"}),N&&!this.isSelected(_)&&this.in.exec("select-row",{id:_}))}break}case"end":{const{editor:C,focusCell:k}=this.getState();if(!C&&k){a.preventDefault();const j=(b=this._getLastVisibleColumn())==null?void 0:b.id,N=k.row;this.in.exec("focus-cell",{row:N,column:j,eventSource:"key"})}break}case"ctrl+end":{const{editor:C,focusCell:k,flatData:j,select:N}=this.getState();if(!C&&k){a.preventDefault();const _=j.at(-1).id,$=(S=this._getLastVisibleColumn())==null?void 0:S.id;_&&$&&(this.in.exec("focus-cell",{row:_,column:$,eventSource:"key"}),N&&!this.isSelected(_)&&this.in.exec("select-row",{id:_}))}break}case"ctrl+z":{this.in.exec("undo",{});break}case"ctrl+y":{this.in.exec("redo",{});break}}}),r.on("scroll",o=>{const{_columns:a,split:i,_sizes:c,flatData:u,dynamic:d}=this.getState();let f=-1,m=-1,p=0;if(o.column){f=0;const g=a.findIndex(x=>x.id==o.column);p=a[g].width;for(let x=i.left??0;x<g;x++){const w=a[x];w.hidden||(f+=w.width)}}if(o.row&&!d){const g=u.findIndex(x=>x.id===o.row);g>=0&&(m=c.rowHeight*g)}this.setState({scroll:{top:m,left:f,width:p,height:c.rowHeight}})}),r.on("print",o=>{const a=Yu(o);this.setState({_print:a}),this.setStateAsync({_print:null})}),r.on("undo",()=>{var o;(o=this._historyManager)==null||o.handleUndo()}),r.on("redo",()=>{var o;(o=this._historyManager)==null||o.handleRedo()}),this.initOnce()}getXlsxWorker(n){if(!this._xlsxWorker){const s=window.URL.createObjectURL(new Blob([`importScripts('${n}');`],{type:"text/javascript"}));this._xlsxWorker=new Promise(r=>{const o=new Worker(s);o.addEventListener("message",a=>{a.data.type==="init"&&r(o)})})}return this._xlsxWorker}initOnce(){const n={sortMarks:{},_filterIds:null,data:[],filterValues:{},scroll:null,editor:null,focusCell:null,_print:null,history:{undo:0,redo:0}};this._router.init(n)}init(n){var s;n.hasOwnProperty("_skin")&&!n._skin&&(n._skin=td()),n.columns&&n.columns.forEach(r=>{r.options&&(r.optionsMap=new Map(r.options.map(o=>[o.id,o.label])))}),Jt(this.getState().data,n.data)||(n.tree?(this._branches={0:{data:n.data}},n.data=this.normalizeTreeRows(n.data)):n.data=this.normalizeRows(n.data),this.setState({_filterIds:null,filterValues:{},sortMarks:{}}),this._historyManager&&this._historyManager.resetHistory()),Cs()&&(n.tree&&(n.undo=!1),(s=n.split)!=null&&s.right&&(n.split.right=0)),n.undo&&!this._historyManager&&(this._historyManager=new Qu(this.in,this.getState.bind(this),this.setState.bind(this))),this._router.init({...n})}setState(n,s){return this._router.setState(n,s)}setStateAsync(n){this._router.setStateAsync(n)}getRow(n){const{tree:s}=this.getState();return s?this._branches[n]:this.getState().data.find(r=>r.id==n)}getRowIndex(n,s){return s||(s=this.getState().flatData),s.findIndex(r=>r.id==n)}getNextRow(n){const s=this.getState().flatData,r=this.getRowIndex(n,s);return s[r+1]}getPrevRow(n){const s=this.getState().flatData,r=this.getRowIndex(n,s);return s[r-1]}getColumn(n){return this.getState().columns.find(s=>s.id==n)}getNextColumn(n,s){const r=this.getState()._columns,o=r.findIndex(a=>a.id==n);return s?this._getFirstVisibleColumn(o+1):r[o+1]}getPrevColumn(n,s){const r=this.getState()._columns,o=r.findIndex(a=>a.id==n);return s?this._getLastVisibleColumn(o-1):r[o-1]}_getFirstVisibleColumn(n){var o,a;const s=this.getState()._columns;let r=n??0;for(;r<s.length&&((o=s[r])!=null&&o.hidden||(a=s[r])!=null&&a.collapsed);)r++;return s[r]}_getLastVisibleColumn(n){var o,a;const s=this.getState()._columns;let r=n??s.length-1;for(;r<s.length&&((o=s[r])!=null&&o.hidden||(a=s[r])!=null&&a.collapsed);)r--;return s[r]}isCellEditable(n,s){const{editor:r,hidden:o}=s;return!r||o?!1:typeof r=="function"?r(n,s):!0}getNextEditor(n,s){let r=this.getState().columns;if(s){const o=r.findIndex(a=>a.id==s.id);r=r.slice(o+1)}return r.find(o=>this.isCellEditable(n,o))}getPrevEditor(n,s){let r=this.getState().columns;if(s){const o=r.findLastIndex(a=>a.id==s.id);r=r.slice(0,o)}return r.findLast(o=>this.isCellEditable(n,o))}toggleBranch(n,s,r){var i;let o=this._branches[n],{data:a}=this.getState();if(a=[...a],n!==0){o={...o,open:s};const c=this.updateTreeRow(o);o.$parent===0&&(a=c)}r&&((i=o.data)!=null&&i.length)&&o.data.forEach(c=>{const u=this.toggleKids(c,s,r);n===0&&(a=u)}),this.setState({data:a})}toggleKids(n,s,r){var a;n={...n,open:s};const o=this.updateTreeRow(n);return r&&((a=n.data)!=null&&a.length)&&n.data.forEach(i=>{this.toggleKids(i,s,r)}),o}updateTreeRow(n){const s=n.id;this._branches[s]=n;const r=this._branches[n.$parent],o=r.data.findIndex(a=>a.id==s);return r.data=[...r.data],r.data[o]=n,r.data}isSelected(n){return this.getState().selectedRows.indexOf(n)!==-1}findAndRemove(n,s){for(let r=0;r<n.length;r++){if(n[r].id==s)return n.splice(r,1)[0];if(n[r].data){const o=[...n[r].data],a=this.findAndRemove(o,s);if(a)return n[r]={...n[r],data:o},a}}return null}insertItem(n,s,r,o){for(let a=0;a<n.length;a++){if(n[a].id==s){const i=n[a],c=o==="before"?a:a+1;if(i.data){if(o==="before"){const u=a>0?n[a-1]:null;return u!=null&&u.data&&u.open?n[a-1]={...u,data:[...u.data,r]}:n.splice(c,0,r),!0}else if(i.open)return n[a]={...i,data:[r,...i.data]},!0}return n.splice(c,0,r),!0}if(n[a].data&&(n[a]={...n[a],data:[...n[a].data]},this.insertItem(n[a].data,s,r,o)))return!0}return!1}moveItem(n,s,r,o){const a=[...r],i=this.findAndRemove(a,n);return this.insertItem(a,s,i,o),a}copyColumns(n){const s=[];return n.forEach(r=>{const o={...r};this.copyHeaderFooter(o,"header"),this.copyHeaderFooter(o,"footer"),s.push(o)}),s}copyHeaderFooter(n,s){let r=n[s];r=Array.isArray(r)?[...r]:[r],r.forEach((o,a)=>{r[a]=typeof o=="string"?{text:o}:{...o}}),n[s]=r}setCollapsibleColumns(n,s,r){let o=n.header;for(let a=0;a<o.length;a++){const i=o[a];if(i.collapsible&&i.collapsed){if(i.collapsible!=="first"){n.collapsed=!0,n.width=36,i.vertical=!0;const u=o.length-a;o=o.slice(0,a+1),o[a].rowspan=u}const c=i.colspan;if(c){const u=o[a+1];let d=1;u&&u.colspan&&!u.collapsed&&(d=u.colspan);for(let f=d;f<c;f++){const m=r[s+f];m&&(m.hidden=!0)}}}}}normalizeColumns(n,s,r,o,a){const i=n[s];i.width||(i.width=i.flexgrow?17:a.columnWidth),i._colindex=s+1;const c=i[r],u=a[`${r}RowHeights`];for(let d=0;d<o;d++){const f=c[d];f.id=i.id,d===c.length-1&&(f.rowspan=f.rowspan?Math.min(f.rowspan,o-d):o-d);for(let m=1;m<f.rowspan;m++){c.splice(d+m,0,{_hidden:!0});for(let p=1;p<f.colspan;p++)n[s+p][r].splice(d+m,0,{})}if(f.rowspan){const m=(f.rowspan===o?u:u.slice(d,f.rowspan+d)).reduce((p,g)=>p+g,0);f.height=m,d+f.rowspan!=o&&f.height--}if(f.colspan){let m=i.width,p=i.flexgrow||0;const g=f.colspan;for(let x=1;x<g;x++){const w=n[s+x];w&&(w.hidden?f.colspan-=1:w.flexgrow?p+=w.flexgrow:m+=w.width||a.columnWidth),p?f.flexgrow=p:f.width=m}}else f.width=i.width,f.flexgrow=i.flexgrow;r==="header"&&f.filter&&typeof f.filter=="string"&&(f.filter={type:f.filter})}c.length>o&&(c.length=o),i[r]=c}normalizeRows(n){return n.forEach(s=>{s.id||(s.id=On())}),n}normalizeTreeRows(n,s,r){return n.forEach(o=>{o.id||(o.id=On()),o.$level=s||0,o.$parent=r||0,this._branches[o.id]=o,o.data&&(o.data.length?(o.$count=o.data.length,this.normalizeTreeRows(o.data,o.$level+1,o.id)):(delete o.data,delete o.$count,delete o.open))}),n}sortTree(n,s){n.sort(s),n.forEach(r=>{r.data&&this.sortTree(r.data,s)})}filterTree(n,s,r){return n.forEach(o=>{s(o)&&r.push(o.id),o.data&&this.filterTree(o.data,s,r)}),r}flattenRows(n,s,r){const o=s;return n.forEach(a=>{var i;(!r||r.includes(a.id))&&o.push(a),(i=a.data)!=null&&i.length&&a.open!==!1&&this.flattenRows(a.data,o,r)}),o}createFilter(n){const{_columns:s}=this.getState(),r=[];for(const o in n){const{config:a,type:i}=s.find(u=>u.id==o).header.find(u=>u.filter).filter,c=n[o];r.push(u=>a!=null&&a.handler?a.handler(u[o],c):od(i)(u[o],c))}return o=>{for(let a=0;a<r.length;a++)if(!r[a](o))return!1;return!0}}normalizeSizes(n,s,r,o,a){const i=pr(n,"header",r,s.headerHeight,a),c=pr(n,"footer",o,s.footerHeight,a),u=i.reduce((f,m)=>f+m,0),d=c.reduce((f,m)=>f+m,0);return{...s,headerRowHeights:i,footerRowHeights:c,headerHeight:u,footerHeight:d}}}let id=new Date().valueOf();function On(){return"temp://"+id++}function ld(t,e="data-id"){let n=t;for(!n.tagName&&t.target&&(n=t.target);n;){if(n.getAttribute&&n.getAttribute(e))return n;n=n.parentNode}return null}new Date().valueOf();function js(t,{keys:e,exec:n}){for(const r in e){const o=r.toLowerCase().replace(/ /g,"");o!==r&&(e[o]=e[r])}function s(r){var c;let o=r.code.replace("Key","").toLowerCase();o===" "&&(o="space");const a=`${r.ctrlKey||r.metaKey?"ctrl+":""}${r.shiftKey?"shift+":""}${r.altKey?"alt+":""}${o.replace(/^key/,"")}`,i=e[a];if(typeof i<"u"){const u=r.target.tagName==="INPUT"||r.target.tagName==="TEXTAREA"||((c=ld(r.target,"data-header-id"))==null?void 0:c.classList.contains("wx-filter"))||!!r.target.closest(".wx-cell.wx-editor");typeof i=="function"?i({key:a,event:r,node:t,isInput:u}):i&&n({key:a,event:r,node:t,isInput:u})}}return t.addEventListener("keydown",s),{destroy:()=>{t.removeEventListener("keydown",s)}}}function cd(t,e){let n=null;e.scroll.subscribe(s=>{if(!s||s===n)return;n=s;const{left:r,top:o,height:a,width:i}=s,c=e.getHeight(),u=e.getWidth(),d=e.getScrollMargin();if(o>=0){const f=t.scrollTop;o<f?t.scrollTop=o:o+a>f+c&&(t.scrollTop=o-c+a)}if(r>=0){const f=t.scrollLeft;r<f?t.scrollLeft=r:r+i>f+u-d&&(t.scrollLeft=r-u+i+d)}})}const ud={grid:{"Add before":"Add before","Add after":"Add after",Copy:"Copy",Delete:"Delete"}};function So(t,e){return t.map(n=>{const s=e(n);return n.data&&n.data.length&&(s.data=So(n.data,e)),s})}function Co(t,e){const n=[];return t.forEach(s=>{if(s.data){const r=Co(s.data,e);r.length&&n.push({...s,data:r})}else e(s)&&n.push(s)}),n}let dd=1;function fd(t){return So(t,e=>{const n={...e,id:e.id||dd++};return n.type&&(n.comp=n.type),n})}const hd={};function pd(t){return hd[t]||t}function md({onClick:t,onShow:e,option:n}){const s=l.useRef(null),r=l.useCallback(()=>{e(n.data?n.id:!1,s.current)},[e,n]),o=l.useMemo(()=>n&&n.comp?pd(n.comp):null,[n]);return h.jsxs("div",{ref:s,className:`wx-cDCz9rZQ wx-option ${n.css||""}`,"data-id":n.id,onMouseEnter:r,onClick:t,children:[n.icon?h.jsx("i",{className:`wx-cDCz9rZQ wx-icon ${n.icon}`}):null,n.comp?o?h.jsx(o,{item:n,option:n}):null:h.jsxs("span",{className:"wx-cDCz9rZQ wx-value",children:[" ",n.text," "]}),n.subtext?h.jsx("span",{className:"wx-cDCz9rZQ wx-subtext",children:n.subtext}):null,n.data?h.jsx("i",{className:"wx-cDCz9rZQ wx-sub-icon wxi-angle-right"}):null]})}function Ms({options:t,left:e=0,top:n=0,at:s="bottom",parent:r=null,mount:o=null,context:a=null,css:i="",onClick:c}){const[u,d]=l.useState(-1e4),[f,m]=l.useState(-1e4),[p,g]=l.useState(20),[x,w]=l.useState(),y=l.useRef(null),[v,b]=l.useState(!1),[S,C]=l.useState(null),k=l.useCallback(()=>{const M=hi(y.current,r,s,e,n);M&&(d(M.x),m(M.y),g(M.z),w(M.width))},[r,s,e,n]);l.useEffect(()=>{o&&o(k)},[]);const j=l.useCallback(()=>{b(!1)},[]),N=l.useCallback(()=>{c&&c({action:null,option:null})},[c]),_=l.useCallback((M,E)=>{b(M),C(E)},[]),$=l.useMemo(()=>fd(t),[t]);return l.useEffect(()=>{k()},[r,k]),l.useEffect(()=>{if(y.current)return qt(y.current,{callback:N,modal:!0}).destroy},[N]),h.jsx("div",{ref:y,"data-wx-menu":"true",className:`wx-XMmAGqVx wx-menu ${i}`,style:{position:"absolute",top:f+"px",left:u+"px",width:x,zIndex:p},onMouseLeave:j,children:$.map(M=>h.jsxs(l.Fragment,{children:[M.comp==="separator"?h.jsx("div",{className:"wx-XMmAGqVx wx-separator"}):h.jsx(md,{option:M,onShow:_,onClick:E=>{if(!M.data&&!E.defaultPrevented){const L={context:a,action:M,option:M,event:E};M.handler&&M.handler(L),c&&c(L),E.stopPropagation()}}}),M.data&&v===M.id?h.jsx(Ms,{css:i,options:M.data,at:"right-overlap",parent:S,context:a,onClick:c}):null]},M.id))})}const xd=l.forwardRef(function(t,e){const{options:n,at:s="bottom",resolver:r=null,dataKey:o="contextId",filter:a=null,css:i="",children:c,onClick:u}=t,[d,f]=l.useState(null),[m,p]=l.useState(null),[g,x]=l.useState(0),[w,y]=l.useState(0),v=l.useMemo(()=>d!==null&&a?Co(n,k=>a(k,d)):n,[d,a,n]),b=l.useCallback(k=>{p(null),u&&u(k)},[u]),S=l.useCallback((k,j)=>{let N=null;for(;k&&k.dataset&&!N;)N=k.dataset[j],k=k.parentNode;return N?$t(N):null},[]),C=l.useCallback((k,j)=>{if(!k){p(null);return}if(k.defaultPrevented)return;const N=k.target;if(N&&N.dataset&&N.dataset.menuIgnore)return;x(k.clientX+1),y(k.clientY+1);let _=typeof j<"u"?j:S(N,o);r&&(_=r(_,k),!_)||(f(_),p(N),k.preventDefault())},[o,S,r]);return l.useImperativeHandle(e,()=>({show:C}),[C]),h.jsxs(h.Fragment,{children:[c?h.jsx("span",{onClick:C,"data-menu-ignore":"true",children:typeof c=="function"?c():c}):null,m?h.jsx(zr,{children:h.jsx(Ms,{css:i,at:s,top:w,left:g,parent:m,context:d,onClick:b,options:v},m)}):null]})});l.forwardRef(function(t,e){const{options:n,at:s="bottom",css:r="",children:o,onClick:a}=t,[i,c]=l.useState(null);function u(g){c(null),a&&a(g)}const d=l.useCallback(g=>{c(g.target),g.preventDefault()},[]);l.useImperativeHandle(e,()=>({show:d}),[d]);function f(g){let x=g.target;for(;!x.dataset.menuIgnore;)c(x),x=x.parentNode}const m=l.useRef(0),p=l.useRef(i);return l.useEffect(()=>{p.current!==i&&(m.current+=1,p.current=i)},[i]),h.jsxs(h.Fragment,{children:[h.jsx("span",{onClick:f,"data-menu-ignore":"true",children:o}),i?h.jsx(zr,{children:h.jsx(Ms,{css:r,at:s,parent:i,options:n,onClick:u},m.current)}):null]})});const gd=l.forwardRef(function(t,e){const{options:n,at:s="bottom",resolver:r=null,dataKey:o="contextId",filter:a=null,css:i="",children:c}=t,u=t.onClick??t.onclick,d=l.useRef(null),f=l.useCallback((m,p)=>{d.current.show(m,p)},[]);return l.useImperativeHandle(e,()=>({show:f}),[f]),h.jsxs(h.Fragment,{children:[c?h.jsx("span",{onContextMenu:f,"data-menu-ignore":"true",children:c}):null,h.jsx(xd,{css:i,at:s,options:n,resolver:r,dataKey:o,filter:a,ref:d,onClick:u})]})});var wd=Array.isArray,yd=Object.defineProperty;function vd(t){for(var e=0;e<t.length;e++)t[e]()}var $r,Nr,mr=(Nr=($r=globalThis.process)==null?void 0:$r.env)==null?void 0:Nr.NODE_ENV,jo=mr&&!mr.toLowerCase().startsWith("prod");function bd(t){if(jo){const e=new Error(`rune_outside_svelte
The \`${t}\` rune is only available inside \`.svelte\` and \`.svelte.js/ts\` files
https://svelte.dev/e/rune_outside_svelte`);throw e.name="Svelte error",e}else throw new Error("https://svelte.dev/e/rune_outside_svelte")}var kt=[];function kd(){var t=kt;kt=[],vd(t)}function Sd(t){if(kt.length===0){var e=kt;queueMicrotask(()=>{e===kt&&kd()})}kt.push(t)}function Cd(t){try{return t()}finally{}}function jd(t,e,n,s={}){function r(o){if(s.capture||_d.call(e,o),!o.cancelBubble)return Cd(()=>n==null?void 0:n.call(this,o))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?Sd(()=>{e.addEventListener(t,r,s)}):e.addEventListener(t,r,s),r}function Md(t,e,n,s={}){var r=jd(e,t,n,s);return()=>{t.removeEventListener(e,r,s)}}var xr=null;function _d(t){var w;var e=this,n=e.ownerDocument,s=t.type,r=((w=t.composedPath)==null?void 0:w.call(t))||[],o=r[0]||t.target;xr=t;var a=0,i=xr===t&&t.__root;if(i){var c=r.indexOf(i);if(c!==-1&&(e===document||e===window)){t.__root=e;return}var u=r.indexOf(e);if(u===-1)return;c<=u&&(a=c)}if(o=r[a]||t.target,o!==e){yd(t,"currentTarget",{configurable:!0,get(){return o||n}});try{for(var d,f=[];o!==null;){var m=o.assignedSlot||o.parentNode||o.host||null;try{var p=o["__"+s];if(p!=null&&(!o.disabled||t.target===o))if(wd(p)){var[g,...x]=p;g.apply(o,[t,...x])}else p.call(o,t)}catch(y){d?f.push(y):d=y}if(t.cancelBubble||m===e||m===null)break;o=m}if(d){for(let y of f)queueMicrotask(()=>{throw y});throw d}}finally{t.__root=e,delete t.currentTarget}}}if(jo){let t=function(e){if(!(e in globalThis)){let n;Object.defineProperty(globalThis,e,{configurable:!0,get:()=>{if(n!==void 0)return n;bd(e)},set:s=>{n=s}})}};t("$state"),t("$effect"),t("$derived"),t("$inspect"),t("$props"),t("$bindable")}var $d={addEvent:Md};const Oe=l.createContext(null);function Nd(t,e){const n=new ResizeObserver(s=>{requestAnimationFrame(()=>e(s[0].contentRect))});return n.observe(t.parentNode),{destroy(){n.disconnect()}}}const gr=5,Ed=700;function Td(t){return $t(t.getAttribute("data-id"))}function dn(t){const e=t.getBoundingClientRect(),n=document.body,s=e.top+n.scrollTop-n.clientTop||0,r=e.left+n.scrollLeft-n.clientLeft||0;return{y:Math.round(s),x:Math.round(r),width:t.offsetWidth,height:t.offsetHeight}}function ns(t,e){const n=dn(e);return{x:t.clientX-n.x,y:t.clientY-n.y}}function Rd(t,e){const n=e.current;let s=null,r,o,a=!1,i=!1;const c=document.createElement("DIV");c.className="wx-drag-zone",c.setAttribute("tabindex",-1);function u(){clearTimeout(r),r=null}function d(j){const N=Le(j);N&&(s={container:c,sourceNode:j.target,from:Td(N),pos:ns(j,t)},o=s.pos,f(j))}function f(j){var _;if(!s)return;const N=s.pos=ns(j,t);if(!a){if(!i&&!((_=j==null?void 0:j.target)!=null&&_.getAttribute("draggable-data"))&&Math.abs(o.x-N.x)<gr&&Math.abs(o.y-N.y)<gr)return;if(C(j)===!1)return k()}if(i){const $=window.scrollX||document.documentElement.scrollLeft||document.body.scrollLeft,M=window.scrollY||document.documentElement.scrollTop||document.body.scrollTop;s.targetNode=document.elementFromPoint(j.pageX-$,j.pageY-M)}else s.targetNode=j.target;n.move&&n.move(j,s),c.style.left=-(s.offset?s.offset.x:0)+"px",c.style.top=s.pos.y+(s.offset?s.offset.y:0)+"px"}function m(j){c.parentNode&&c.parentNode.removeChild(c),c.innerHTML="",a&&n.end&&n.end(j,s),s=o=null,k()}function p(j){n.getReorder&&!n.getReorder()||j.button===0&&(S(j),window.addEventListener("mousemove",g),window.addEventListener("mouseup",x),d(j))}function g(j){f(j)}function x(j){m(j)}function w(j){if(n.getReorder&&!n.getReorder())return;r=setTimeout(()=>{i=!0,d(j.touches[0])},Ed),S(j);function N(){r&&u(),j.target.removeEventListener("touchmove",y),j.target.removeEventListener("touchend",N),m(j)}j.target.addEventListener("touchmove",y),j.target.addEventListener("touchend",N),t.addEventListener("contextmenu",v)}function y(j){a?(j.preventDefault(),f(j.touches[0])):r&&u()}function v(j){if(a||r)return j.preventDefault(),!1}function b(j){j.preventDefault()}function S(j){if(!n.getDraggableInfo)return;const{hasDraggable:N}=n.getDraggableInfo();(!N||j.target.getAttribute("draggable-data"))&&(document.body.style.userSelect="none",document.body.style.webkitUserSelect="none")}function C(j){if(a=!0,n.start){if(n.start(j,s)===!1)return!1;t.appendChild(c),document.body.style.cursor="move"}}function k(j){a=i=!1,document.body.style.cursor="",document.body.style.userSelect="",document.body.style.webkitUserSelect="",window.removeEventListener("mousemove",g),window.removeEventListener("mouseup",x),j&&(t.removeEventListener("mousedown",p),t.removeEventListener("touchstart",w),t.removeEventListener("dragstart",b))}return t.addEventListener("mousedown",p),t.addEventListener("touchstart",w),t.addEventListener("dragstart",b),{destroy(){k(!0)}}}const Dd=.004;function Id(){return{dirX:0,dirY:0,scrollSpeedFactor:1}}function Pd(t,e,n,s){const{node:r,left:o,top:a,bottom:i,sense:c,xScroll:u,yScroll:d}=s,f=ns(t,r);n.scrollState||(n.scrollState=Id());let m=0,p=0;f.x<o+c?m=-1:f.x>e.width-c&&(m=1),f.y<a+Math.round(c/2)?p=-1:f.y>e.height-i-Math.round(c/2)&&(p=1),(n.scrollState.dirX!==m||n.scrollState.dirY!==p)&&(Mo(n),n.scrollState.dirX=m,n.scrollState.dirY=p),(u&&n.scrollState.dirX!==0||d&&n.scrollState.dirY!==0)&&Ad(n,s,{x:n.scrollState.dirX,y:n.scrollState.dirY})}function Ad(t,e,n){t.autoScrollTimer||(t.autoScrollTimer=setTimeout(()=>{t.activeAutoScroll=setInterval(Ld,15,t,e,n)},250))}function Mo(t){t.scrollSpeedFactor=1,t.autoScrollTimer&&(t.autoScrollTimer=clearTimeout(t.autoScrollTimer),t.activeAutoScroll=clearInterval(t.activeAutoScroll))}function Ld(t,e,n){const{x:s,y:r}=n;t.scrollSpeedFactor+=Dd,s!==0&&Od(t,e,s),r!==0&&Hd(t,e,r)}function Hd(t,e,n){const s=e.node.scrollTop;_o(s+Math.round(e.sense/3)*t.scrollSpeedFactor*n,"scrollTop",e)}function Od(t,e,n){const s=e.node.scrollLeft;_o(s+Math.round(e.sense/3)*t.scrollSpeedFactor*n,"scrollLeft",e)}function _o(t,e,n){n.node[e]=t}function Wd(t){return{tab:!0,"shift+tab":!0,arrowup:!0,arrowdown:!0,arrowright:!0,arrowleft:!0,enter:!0,escape:!0,f2:!0,home:!0,end:!0,"ctrl+home":!0,"ctrl+end":!0,"ctrl+z":t.undo,"ctrl+y":t.undo}}function Nn(t,e,n,s,r,o){const a={};return t&&(a.width=`${t}px`,a.minWidth=`${t}px`),e&&(a.flexGrow=e),o&&(a.height=`${o}px`),n&&(a.position="sticky",n.left&&(a.left=`${s}px`),n.right&&(a.right=`${r}px`)),a}function $o(t,e,n){let s="";if(t.fixed)for(const r in t.fixed)s+=t.fixed[r]===-1?"wx-shadow ":"wx-fixed ";return s+=e.rowspan>1?"wx-rowspan ":"",s+=e.colspan>1?"wx-colspan ":"",s+=e.vertical?"wx-vertical ":"",s+=n?n(t)+" ":"",s}function zd(t){const{row:e,column:n,cellStyle:s=null,columnStyle:r=null,children:o,reorder:a}=t,[i,c]=ke(t.focusable),u=l.useContext(Oe),d=ne(u,"focusCell"),f=l.useMemo(()=>Nn(n.width,n.flexgrow,n.fixed,n.left,n.right),[n.width,n.flexgrow,n.fixed,n.left,n.right]);function m(b,S){let C="wx-cell";return C+=n.fixed?" "+(n.fixed===-1?"wx-shadow":"wx-fixed"):"",C+=b?" "+b(n):"",C+=S?" "+S(e,n):"",C+=n.treetoggle?" wx-tree-cell":"",C}const p=l.useMemo(()=>m(r,s),[r,s,n,e]),g=l.useMemo(()=>typeof n.draggable=="function"?n.draggable(e,n)!==!1:n.draggable,[n,e]),x=l.useRef(null);l.useEffect(()=>{const b=(d==null?void 0:d.row)===e.id&&(d==null?void 0:d.column)===n.id;x.current&&i&&b&&x.current.focus()},[d,i,e.id,n.id]);const w=l.useCallback(()=>{i&&!d&&u.exec("focus-cell",{row:e.id,column:n.id,eventSource:"focus"})},[u,i,d,e.id,n.id]);l.useEffect(()=>()=>{i&&d&&(u.exec("focus-cell",{eventSource:"destroy"}),c(!1))},[u,c]);const y=l.useMemo(()=>{const b=n.fixed&&n.fixed.left===-1||n.fixed.right===-1,S=n.fixed&&n.fixed.right;return[p,b?"wx-shadow":"",S?"wx-fixed-right":""].filter(Boolean).join(" ")},[p,n]),v=n.cell;return h.jsxs("div",{className:"wx-TSCaXsGV "+y,ref:x,onFocus:w,style:f,"data-row-id":e.id,"data-col-id":n.id,tabIndex:i?"0":"-1",role:"gridcell","aria-colindex":n._colindex,"aria-readonly":n.editor?void 0:!0,children:[a&&n.draggable?g?h.jsx("i",{"draggable-data":"true",className:"wx-TSCaXsGV wx-draggable wxi-drag"}):h.jsx("i",{className:"wx-TSCaXsGV wx-draggable-stub"}):null,n.treetoggle?h.jsxs(h.Fragment,{children:[h.jsx("span",{style:{marginLeft:`${e.$level*28}px`}}),e.$count?h.jsx("i",{"data-action":"toggle-row",className:`wx-TSCaXsGV wx-table-tree-toggle wxi-menu-${e.open!==!1?"down":"right"}`}):null]}):null,v?h.jsx(v,{api:u,row:e,column:n,onAction:({action:b,data:S})=>u.exec(b,S)}):o?o():Tt(e,n)]})}function wr(t,e){let n,s;function r(i){n=i.clientX,t.style.opacity=1,document.body.style.cursor="ew-resize",document.body.style.userSelect="none",window.addEventListener("mousemove",o),window.addEventListener("mouseup",a),e&&e.down&&e.down(t)}function o(i){s=i.clientX-n,e&&e.move&&e.move(s)}function a(){t.style.opacity="",document.body.style.cursor="",document.body.style.userSelect="",e&&e.up&&e.up(s),window.removeEventListener("mousemove",o),window.removeEventListener("mouseup",a)}return t.addEventListener("mousedown",r),{destroy(){t.removeEventListener("mousedown",r)}}}function Fd({filter:t,column:e,action:n,filterValue:s}){function r({value:o}){n({value:o,key:e.id})}return h.jsx(Sn,{...t.config??{},value:s,onChange:r})}function Vd({filter:t,column:e,action:n,filterValue:s}){const r=l.useContext(Oe),o=ne(r,"flatData"),a=l.useMemo(()=>{var f;return((f=t==null?void 0:t.config)==null?void 0:f.options)||(e==null?void 0:e.options)||c()},[t,e,o]),i=l.useMemo(()=>{var f;return(f=t==null?void 0:t.config)==null?void 0:f.template},[t]);function c(){const f=[];return o.forEach(m=>{const p=ht(m,e);f.includes(p)||f.push(p)}),f.map(m=>({id:m,label:m}))}function u({value:f}){n({value:f,key:e.id})}function d(f){f.key!=="Tab"&&f.preventDefault()}return h.jsx("div",{style:{width:"100%"},onKeyDown:d,children:h.jsx(Or,{placeholder:"",clear:!0,...(t==null?void 0:t.config)??{},options:a,value:s,onChange:u,children:f=>i?i(f):f.label})})}const Bd={text:Fd,richselect:Vd};function Yd({filter:t,column:e}){const n=l.useContext(Oe),s=ne(n,"filterValues");function r(a){n.exec("filter-rows",a)}const o=l.useMemo(()=>Bd[t.type],[t.type]);return h.jsx(o,{filter:t,column:e,action:r,filterValue:s[e.id]})}function Gd(t){const{cell:e,column:n,row:s,lastRow:r,sortRow:o,columnStyle:a,bodyHeight:i,hasSplit:c}=t,u=l.useContext(Oe),d=ne(u,"sortMarks"),f=l.useMemo(()=>d?d[n.id]:void 0,[d,n.id]),m=l.useRef(),p=l.useCallback(P=>{m.current=e.flexgrow?P.parentNode.clientWidth:e.width},[e.flexgrow,e.width]),g=l.useCallback((P,W)=>{u.exec("resize-column",{id:e.id,width:Math.max(1,(m.current||0)+P),inProgress:W})},[u,e.id]),x=l.useCallback(P=>g(P,!0),[g]),w=l.useCallback(P=>g(P,!1),[g]),y=l.useCallback(P=>{!n.sort||e.filter||u.exec("sort-rows",{key:e.id,add:P.ctrlKey})},[u,e.id,e.filter,n.sort]),v=l.useCallback(P=>{P&&P.stopPropagation(),u.exec("collapse-column",{id:e.id,row:s})},[u,e.id,s]),b=l.useCallback(P=>{P.key==="Enter"&&v()},[v]),S=l.useCallback(P=>{P.key==="Enter"&&!e.filter&&y(P)},[y,e.filter]),C=l.useMemo(()=>e.collapsed&&n.collapsed,[e.collapsed,n.collapsed]),k=l.useMemo(()=>C&&!c&&e.collapsible!=="header",[C,c,e.collapsible]),j=l.useMemo(()=>k?{top:-i/2,position:"absolute"}:{},[k,i]),N=l.useMemo(()=>Nn(e.width,e.flexgrow,n.fixed,n.left,e.right??n.right,e.height+(C&&k?i:0)),[e.width,e.flexgrow,n.fixed,n.left,e.right,n.right,e.height,C,k,i]),_=l.useMemo(()=>$o(n,e,a),[n,e,a]),$=l.useCallback(()=>Object.fromEntries(Object.entries(e).filter(([P])=>P!=="cell")),[e]),M=`wx-cell ${_} ${e.css||""} wx-collapsed`,E=["wx-cell",_,e.css||"",e.filter?"wx-filter":"",n.fixed&&n.fixed.right?"wx-fixed-right":""].filter(Boolean).join(" "),L=l.useRef(null);return l.useEffect(()=>{const P=L.current;if(!P)return;const W=wr(P,{down:p,move:x,up:w});return()=>{typeof W=="function"&&W()}},[p,x,w,wr]),C?h.jsx("div",{className:"wx-RsQD74qC "+M,style:N,role:"button","aria-label":`Expand column ${e.text||""}`,"aria-expanded":!e.collapsed,tabIndex:0,onKeyDown:b,onClick:v,"data-header-id":n.id,children:h.jsx("div",{className:"wx-RsQD74qC wx-text",style:j,children:e.text||""})}):h.jsxs("div",{className:"wx-RsQD74qC "+E,style:N,onClick:y,"data-header-id":n.id,tabIndex:!e._hidden&&n.sort&&!e.filter?0:void 0,role:"columnheader","aria-colindex":e._colindex,"aria-colspan":e.colspan>1?e.colspan:void 0,"aria-rowspan":e.rowspan>1?e.rowspan:void 0,"aria-sort":!(f!=null&&f.order)||e.filter?"none":(f==null?void 0:f.order)==="asc"?"ascending":"descending",onKeyDown:S,children:[e.collapsible?h.jsx("div",{className:"wx-RsQD74qC wx-collapse",role:"button","aria-label":e.collapsed?"Expand column":"Collapse column","aria-expanded":!e.collapsed,tabIndex:0,onKeyDown:b,onClick:v,children:h.jsx("i",{className:`wx-RsQD74qC wxi-angle-${e.collapsed?"down":"right"}`})}):null,e.cell?(()=>{const P=e.cell;return h.jsx(P,{api:u,cell:$(),column:n,row:s,onAction:({action:W,data:V})=>u.exec(W,V)})})():e.filter?h.jsx(Yd,{filter:e.filter,column:n}):h.jsx("div",{className:"wx-RsQD74qC wx-text",children:e.text||""}),n.resize&&r&&!e._hidden?h.jsx("div",{className:"wx-RsQD74qC wx-grip",role:"presentation","aria-label":"Resize column",ref:L,onClick:P=>P.stopPropagation(),children:h.jsx("div",{})}):null,o?h.jsx("div",{className:"wx-RsQD74qC wx-sort",children:f?h.jsxs(h.Fragment,{children:[typeof f.index<"u"?h.jsx("div",{className:"wx-RsQD74qC wx-order",children:f.index+1}):null,h.jsx("i",{className:`wx-RsQD74qC wxi-arrow-${f.order==="asc"?"up":"down"}`})]}):null}):null]})}function Ud({cell:t,column:e,row:n,columnStyle:s}){const r=l.useContext(Oe),o=l.useMemo(()=>Nn(t==null?void 0:t.width,t==null?void 0:t.flexgrow,e==null?void 0:e.fixed,e==null?void 0:e.left,(t==null?void 0:t.right)??(e==null?void 0:e.right),t==null?void 0:t.height),[t==null?void 0:t.width,t==null?void 0:t.flexgrow,e==null?void 0:e.fixed,e==null?void 0:e.left,t==null?void 0:t.right,e==null?void 0:e.right,t==null?void 0:t.height]),a=l.useMemo(()=>$o(e,t,s),[e,t,s]),i=l.useCallback(()=>Object.fromEntries(Object.entries(t||{}).filter(([u])=>u!=="cell")),[t]),c=`wx-6Sdi3Dfd wx-cell ${a||""} ${(t==null?void 0:t.css)||""}`+(e!=null&&e.fixed&&(e!=null&&e.fixed.right)?" wx-fixed-right":"");return h.jsx("div",{className:c,style:o,children:!(e!=null&&e.collapsed)&&!(t!=null&&t.collapsed)?t!=null&&t.cell?Na.createElement(t.cell,{api:r,cell:i(),column:e,row:n,onAction:({action:u,data:d})=>r.exec(u,d)}):h.jsx("div",{className:"wx-6Sdi3Dfd wx-text",children:(t==null?void 0:t.text)||""}):null})}function yr({deltaLeft:t,contentWidth:e,columns:n,type:s="header",columnStyle:r,bodyHeight:o}){const a=l.useContext(Oe),i=ne(a,"_sizes"),c=ne(a,"split"),u=l.useMemo(()=>i==null?void 0:i[`${s}RowHeights`],[i,s]),d=l.useMemo(()=>{let x=[];if(n&&n.length){const w=n[0][s].length;for(let y=0;y<w;y++){let v=0;x.push([]),n.forEach((b,S)=>{const C={...b[s][y]};if(v||x[y].push(C),C.colspan>1){if(v=C.colspan-1,!Cs()&&b.right){let k=b.right;for(let j=1;j<C.colspan;j++)k-=n[S+j].width;C.right=k}}else v&&v--})}}return x},[n,s]),f=l.useMemo(()=>(c==null?void 0:c.left)||(c==null?void 0:c.right),[c]);function m(x){return n.find(w=>w.id===x)}function p(x,w){let y=w;return x.rowspan&&(y+=x.rowspan-1),y===d.length-1}function g(x,w,y){if(!y.sort)return!1;for(let v=d.length-1;v>=0;v--){const b=y.header[v];if(!b.filter&&!b._hidden)return w===v}return p(x,w)}return h.jsx("div",{className:`wx-sAsPVaUK wx-${s}`,style:{paddingLeft:`${t}px`,width:`${e}px`},role:"rowgroup",children:d.map((x,w)=>h.jsx("div",{className:s==="header"?"wx-sAsPVaUK wx-h-row":"wx-sAsPVaUK wx-f-row",style:{height:`${u==null?void 0:u[w]}px`,display:"flex"},role:"row",children:x.map(y=>{const v=m(y.id);return s==="header"?h.jsx(Gd,{cell:y,columnStyle:r,column:v,row:w,lastRow:p(y,w),bodyHeight:o,sortRow:g(y,w,v),hasSplit:f},y.id):h.jsx(Ud,{cell:y,columnStyle:r,column:m(y.id),row:w},y.id)})},w))})}function Kd({overlay:t}){const e=l.useContext(Oe);function n(r){return typeof r=="function"}const s=t;return h.jsx("div",{className:"wx-1ty666CQ wx-overlay",children:n(t)?h.jsx(s,{onAction:({action:r,data:o})=>e.exec(r,o)}):t})}function qd(t){const{actions:e,editor:n}=t,[s,r]=l.useState((n==null?void 0:n.value)||""),o=l.useRef(null);l.useEffect(()=>{o.current&&o.current.focus()},[]);function a(){o.current&&(r(o.current.value),e.updateValue(o.current.value))}function i({key:c}){c==="Enter"&&e.save()}return h.jsx("input",{className:"wx-e7Ao5ejY wx-text",onInput:a,onKeyDown:i,ref:o,type:"text",value:s})}function Qd({actions:t,editor:e,onAction:n}){const[s,r]=l.useState(e==null?void 0:e.value),[o,a]=l.useState(e==null?void 0:e.renderedValue),[i,c]=l.useState((e==null?void 0:e.options)||[]),u=l.useMemo(()=>{var v;return(v=e==null?void 0:e.config)==null?void 0:v.template},[e]),d=l.useMemo(()=>{var v;return(v=e==null?void 0:e.config)==null?void 0:v.cell},[e]),f=l.useMemo(()=>(i||[]).findIndex(v=>v.id===s),[i,s]),m=l.useRef(null),p=l.useRef(null),g=l.useCallback(v=>{m.current=v.navigate,p.current=v.keydown,m.current(f)},[f,m]),x=l.useCallback(v=>{var C;const b=((C=v==null?void 0:v.target)==null?void 0:C.value)??"";a(b);const S=b?((e==null?void 0:e.options)||[]).filter(k=>(k.label||"").toLowerCase().includes(b.toLowerCase())):(e==null?void 0:e.options)||[];c(S),S.length?m.current(-1/0):m.current(null)},[e]),w=l.useRef(null);l.useEffect(()=>{w.current&&w.current.focus()},[]),l.useEffect(()=>{r(e==null?void 0:e.value),a(e==null?void 0:e.renderedValue),c((e==null?void 0:e.options)||[])},[e]);const y=l.useCallback(({id:v})=>{t.updateValue(v),t.save()},[t]);return h.jsxs(h.Fragment,{children:[h.jsx("input",{className:"wx-0UYfSd1x wx-input",ref:w,value:o??"",onChange:x,onKeyDown:v=>p.current?p.current(v,f):void 0}),h.jsx(kn,{items:i,onReady:g,onSelect:y,children:({option:v})=>u?u(v):d?h.jsx(d,{data:v,onAction:n}):v.label})]})}function Xd({actions:t,editor:e,onAction:n}){var c;const[s]=l.useState(()=>e.value||new Date),[r]=l.useState(()=>{var u;return(u=e.config)==null?void 0:u.template}),[o]=l.useState(()=>{var u;return(u=e.config)==null?void 0:u.cell});function a({value:u}){t.updateValue(u),t.save()}const i=l.useRef(null);return l.useEffect(()=>{i.current&&i.current.focus(),typeof window<"u"&&window.getSelection&&window.getSelection().removeAllRanges()},[]),h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"wx-lNWNYUb6 wx-value",ref:i,tabIndex:0,onClick:()=>t.cancel(),onKeyDown:u=>u.preventDefault(),children:r?r(s):o?h.jsx(o,{data:e.value,onAction:n}):h.jsx("span",{className:"wx-lNWNYUb6 wx-text",children:e.renderedValue})}),h.jsx(Et,{width:"auto",children:h.jsx(Hr,{value:s,onChange:a,buttons:(c=e.config)==null?void 0:c.buttons})})]})}function Jd(t){const{actions:e,editor:n}=t,s=t.onAction??t.onaction,r=n.config||{},[o]=l.useState(n.options.find(x=>x.id===n.value)),[a]=l.useState(n.value),[i]=l.useState(n.options),c=l.useMemo(()=>i.findIndex(x=>x.id===a),[i,a]);function u({id:x}){e.updateValue(x),e.save()}let d;const[f,m]=l.useState();function p(x){d=x.navigate,m(()=>x.keydown),d(c)}const g=l.useRef(null);return l.useEffect(()=>{g.current&&g.current.focus(),typeof window<"u"&&window.getSelection&&window.getSelection().removeAllRanges()},[]),h.jsxs(h.Fragment,{children:[h.jsx("div",{ref:g,className:"wx-ywGRk611 wx-value",tabIndex:0,onClick:()=>e.cancel(),onKeyDown:x=>{f(x,c),x.preventDefault()},children:r.template?r.template(o):r.cell?(()=>{const x=r.cell;return h.jsx(x,{data:o,onAction:s})})():h.jsx("span",{className:"wx-ywGRk611 wx-text",children:n.renderedValue})}),h.jsx(kn,{items:i,onReady:p,onSelect:u,children:({option:x})=>r.template?r.template(x):r.cell?(()=>{const w=r.cell;return h.jsx(w,{data:x,onAction:s})})():x.label})]})}const Zd={text:qd,combo:Qd,datepicker:Xd,richselect:Jd};function ef({column:t,row:e}){const n=l.useContext(Oe),s=ne(n,"editor"),r=l.useCallback((g,x)=>{n.exec("close-editor",{ignore:g}),x&&n.exec("focus-cell",{...x,eventSource:"click"})},[n]),o=l.useCallback(g=>{const x=g?null:{row:s==null?void 0:s.id,column:s==null?void 0:s.column};r(!1,x)},[s,r]),a=l.useCallback(()=>{r(!0,{row:s==null?void 0:s.id,column:s==null?void 0:s.column})},[s,r]),i=l.useCallback(g=>{n.exec("editor",{value:g})},[n]),c=l.useCallback(g=>{g.key==="Enter"&&s&&a()},[s,a]),u=l.useMemo(()=>Nn(t.width,t.flexgrow,t.fixed,t.left,t.right),[t.width,t.flexgrow,t.fixed,t.left,t.right]),d=l.useMemo(()=>{let g=t.editor;typeof g=="function"&&(g=g(e,t));let x=typeof g=="string"?g:g.type;return Zd[x]},[t,e]),f=l.useRef(null);l.useEffect(()=>{if(!f.current)return;const g=qt(f.current,()=>o(!0));return()=>{typeof g=="function"&&g()}},[o]),l.useEffect(()=>{f.current&&typeof u=="string"&&f.current.setAttribute("style",u)},[u]);const m=typeof e.$parent<"u"?"gridcell":"cell",p=typeof e.$parent<"u"?!t.editor:void 0;return h.jsx("div",{className:"wx-8l724t2g wx-cell wx-editor",ref:f,style:typeof u=="object"&&u!==null?u:void 0,role:m,"aria-readonly":p,tabIndex:-1,onClick:g=>g.stopPropagation(),onDoubleClick:g=>g.stopPropagation(),onKeyDown:c,children:d?h.jsx(d,{editor:s,actions:{save:o,cancel:a,updateValue:i},onAction:({action:g,data:x})=>n.exec(g,x)}):null})}function vr(t){const{columns:e,type:n,columnStyle:s}=t,r=l.useContext(Oe),{filterValues:o,_columns:a,_sizes:i}=r.getState();function c(u){return s?" "+s(u):""}return h.jsx(h.Fragment,{children:e.map((u,d)=>h.jsx("tr",{children:u.map(f=>{const m=a.find(x=>x.id==f.id),p=`wx-print-cell-${n}${c(m)}${f.filter?" wx-print-cell-filter":""}${f.vertical?" wx-vertical":""}`,g=f.cell;return h.jsx("th",{style:Pr(bo(f,i.columnWidth)),className:"wx-Gy81xq2u "+p,rowSpan:f.rowspan,colSpan:f.colspan,children:g?h.jsx(g,{api:r,cell:Object.fromEntries(Object.entries(f).filter(([x])=>x!=="cell")),column:m,row:d}):f.filter?h.jsx("div",{className:"wx-Gy81xq2u wx-print-filter",children:Gu(o,a,f)}):h.jsx("div",{className:"wx-Gy81xq2u wx-text",children:f.text??""})},f.id)})},d))})}function tf(t){const{columns:e,rowStyle:n,columnStyle:s,cellStyle:r,header:o,footer:a,reorder:i}=t,c=l.useContext(Oe),{flatData:u,_sizes:d}=c.getState(),f=o&&fr(e,"header",d.headerRowHeights),m=a&&fr(e,"footer",d.footerRowHeights);function p(x,w){let y="";return y+=s?" "+s(w):"",y+=r?" "+r(x,w):"",y}function g(x,w){return typeof w.draggable=="function"?w.draggable(x,w)!==!1:w.draggable}return h.jsxs("table",{className:`wx-8NTMLH0z wx-print-grid ${e.some(x=>x.flexgrow)?"wx-flex-columns":""}`,children:[o?h.jsx("thead",{children:h.jsx(vr,{columns:f,type:"header",columnStyle:s})}):null,h.jsx("tbody",{children:u.map((x,w)=>h.jsx("tr",{className:"wx-8NTMLH0z wx-row"+(n?" "+n(x):""),children:e.map(y=>y.collapsed?null:h.jsxs("td",{className:`wx-8NTMLH0z wx-print-cell wx-cell ${p(x,y)}`,style:Pr(bo(y,d.columnWidth)),children:[i&&y.draggable?h.jsx("span",{className:"wx-8NTMLH0z wx-print-draggable",children:g(x,y)?h.jsx("i",{className:"wx-8NTMLH0z wxi-drag"}):null}):null,y.treetoggle?h.jsxs(h.Fragment,{children:[h.jsx("span",{style:{marginLeft:x.$level*28+"px"}}),x.$count?h.jsx("i",{className:`wx-8NTMLH0z wx-print-grid-tree-toggle wxi-menu-${x.open!==!1?"down":"right"}`}):null]}):null,y.cell?(()=>{const v=y.cell;return h.jsx(v,{api:c,row:x,column:y})})():h.jsx("span",{children:Tt(x,y)})]},y.id))},w))}),a?h.jsx("tfoot",{children:h.jsx(vr,{columns:m,type:"footer",columnStyle:s})}):null]})}function nf(t){const{config:e,...n}=t,s=l.useContext(Oe),{_skin:r,_columns:o}=s.getState(),a=l.useMemo(()=>Fu(o,e),[]),i=l.useRef(null);return l.useEffect(()=>{const c=document.body;c.classList.add("wx-print");const u=i.current;if(!u)return;const d=u.cloneNode(!0);c.appendChild(d);const f=`@media print { @page { size: ${e.paper} ${e.mode}; }`,m=document.createElement("style");m.setAttribute("type","text/css"),m.setAttribute("media","print"),document.getElementsByTagName("head")[0].appendChild(m),m.appendChild(document.createTextNode(f)),window.print(),m.remove(),c.classList.remove("wx-print"),d.remove()},[]),h.jsx("div",{className:`wx-4zwCKA7C wx-${r}-theme wx-print-container`,ref:i,children:a.map((c,u)=>h.jsx("div",{className:"wx-4zwCKA7C wx-print-grid-wrapper",children:h.jsx(tf,{columns:c,...n})},u))})}function sf(t){const{header:e,footer:n,overlay:s,multiselect:r,reorder:o,onreorder:a,rowStyle:i,columnStyle:c,cellStyle:u,autoRowHeight:d,resize:f,clientWidth:m,clientHeight:p,responsiveLevel:g}=t,x=l.useContext(Oe),w=ne(x,"dynamic"),y=ne(x,"_columns"),v=ne(x,"flatData"),b=ne(x,"split"),S=ne(x,"_sizes"),[C,k]=pn(x,"selectedRows"),j=ne(x,"select"),N=ne(x,"editor"),_=ne(x,"tree"),$=ne(x,"focusCell"),M=ne(x,"_print"),E=ne(x,"undo"),[L,P]=l.useState(0);l.useEffect(()=>{P(ka())},[]);const[W,V]=l.useState(0),[ee,O]=l.useState(0),H=l.useMemo(()=>(y||[]).some(R=>!R.hidden&&R.flexgrow),[y]),z=l.useMemo(()=>(S==null?void 0:S.rowHeight)||0,[S]),I=l.useRef(null),[X,G]=l.useState(null),[ce,J]=l.useState(null),se=l.useMemo(()=>{let R=[],Y=0;return b&&b.left&&(R=(y||[]).slice(0,b.left).filter(re=>!re.hidden).map(re=>({...re})),R.forEach(re=>{re.fixed={left:1},re.left=Y,Y+=re.width}),R.length&&(R[R.length-1].fixed={left:-1})),{columns:R,width:Y}},[b,y]),F=l.useMemo(()=>{let R=[],Y=0;if(b&&b.right){R=(y||[]).slice(b.right*-1).filter(re=>!re.hidden).map(re=>({...re}));for(let re=R.length-1;re>=0;re--){const he=R[re];he.fixed={right:1},he.right=Y,Y+=he.width}R.length&&(R[0].fixed={right:-1})}return{columns:R,width:Y}},[b,y]),A=l.useMemo(()=>{const R=(y||[]).slice((b==null?void 0:b.left)||0,(y||[]).length-((b==null?void 0:b.right)??0)).filter(Y=>!Y.hidden);return R.forEach(Y=>{Y.fixed=0}),R},[y,b]),B=l.useMemo(()=>(y||[]).reduce((R,Y)=>(Y.hidden||(R+=Y.width),R),0),[y]),Q=1;function te(R,Y,re){let he=Y,je=R;if(A.length){let ye=A.length;for(let ie=R;ie>=0;ie--)A[ie][re].forEach($e=>{$e.colspan>1&&ie>R-$e.colspan&&ie<ye&&(ye=ie)});if(ye!==A.length&&ye<R){for(let ie=ye;ie<R;ie++)he-=A[ie].width;je=ye}}return{index:je,delta:he}}const U=l.useMemo(()=>{let R,Y,re;const he=W,je=W+(m||0);let ye=0,ie=0,$e=0,Xe=0;A.forEach((lt,gt)=>{he>$e&&(ye=gt,Xe=$e),$e=$e+lt.width,je>$e&&(ie=gt+Q)});const et={header:0,footer:0};for(let lt=ie;lt>=ye;lt--)["header","footer"].forEach(gt=>{A[lt]&&A[lt][gt].forEach(Ma=>{const Pn=Ma.colspan;if(Pn&&Pn>1){const Ds=Pn-(ie-lt+1);Ds>0&&(et[gt]=Math.max(et[gt],Ds))}})});const xt=te(ye,Xe,"header"),tn=te(ye,Xe,"footer"),Pt=xt.delta,nn=xt.index,sn=tn.delta,In=tn.index;return H&&B>(m||0)?R=Y=re=[...se.columns,...A,...F.columns]:(R=[...se.columns,...A.slice(ye,ie+1),...F.columns],Y=[...se.columns,...A.slice(nn,ie+et.header+1),...F.columns],re=[...se.columns,...A.slice(In,ie+et.footer+1),...F.columns]),{data:R||[],header:Y||[],footer:re||[],d:Xe,df:sn,dh:Pt}},[A,se,F,W,m,H,B]),we=l.useMemo(()=>e&&(S==null?void 0:S.headerHeight)||0,[e,S]),pe=l.useMemo(()=>n&&(S==null?void 0:S.footerHeight)||0,[n,S]),be=l.useMemo(()=>m&&p?B>=m:!1,[m,p,B]),Ee=l.useMemo(()=>(p||0)-we-pe-(be?L:0),[p,we,pe,be,L]),D=l.useMemo(()=>Math.ceil((Ee||0)/(z||1))+1,[Ee,z]),Z=l.useRef([]),[ue,le]=l.useState(0),[de,Me]=l.useState(void 0),ve=l.useMemo(()=>{let R=0,Y=0;if(d){let je=ee;for(;je>0;)je-=Z.current[R]||z,R++;Y=ee-je;for(let ye=Math.max(0,R-2-1);ye<R;ye++)Y-=Z.current[R-ye]||z;R=Math.max(0,R-2)}else R=Math.floor(ee/(z||1)),R=Math.max(0,R-2),Y=R*(z||0);const re=w?w.rowCount:(v||[]).length,he=Math.min(re,R+(D||0)+2);return{d:Y,start:R,end:he}},[d,ee,z,w,v,D]),Te=l.useMemo(()=>{const R=w?w.rowCount:(v||[]).length,Y=R*(z||0);return d?ue+ve.d+(R-(de||0))*(z||0):Y},[w,v,z,d,ue,ve.d,de]),Se=l.useMemo(()=>m&&p?Te+we+pe>=p-(B>=(m||0)?L:0):!1,[m,p,Te,we,pe,B,L]),me=l.useMemo(()=>H&&B<=(m||0)?(m||0)-0-(Se?L:0):B,[H,B,m,Se,L,be]),Be=l.useMemo(()=>H&&B<=(m||0)?m||0:me<(m||0)?B+(Se?L:0):-1,[H,B,m,me,Se,L]),Ye=l.useRef({});l.useEffect(()=>{if(w&&(Ye.current.start!==ve.start||Ye.current.end!==ve.end)){const{start:R,end:Y}=ve;Ye.current={start:R,end:Y},x&&x.exec&&x.exec("request-data",{row:{start:R,end:Y}})}},[w,ve,x]);const T=l.useMemo(()=>w?v||[]:(v||[]).slice(ve.start,ve.end),[w,v,ve]),K=l.useMemo(()=>(C||[]).filter(R=>(T||[]).some(Y=>Y.id===R)),[k,T]),q=l.useMemo(()=>ve.start,[ve.start]),oe=l.useCallback(R=>{O(R.target.scrollTop),V(R.target.scrollLeft)},[]),xe=l.useCallback(R=>{R.shiftKey&&R.preventDefault(),I.current&&I.current.focus&&I.current.focus()},[]),fe=l.useCallback(()=>!!(y||[]).find(R=>!!R.draggable),[y]),Ce=l.useRef(null),_e=l.useRef(null),It=l.useRef({dblclick:(R,Y)=>{const re={id:R,column:Bn(Y,"data-col-id")};x.exec("open-editor",re)},click:(R,Y)=>{if(Ce.current)return;const re=Bn(Y,"data-col-id"),he=x.getState().focusCell;if((!he||he.row!==R||he.column!==re)&&x.exec("focus-cell",{row:R,column:re,eventSource:"click"}),j===!1)return;const je=r&&Y.ctrlKey,ye=r&&Y.shiftKey,ie=x.getState().selectedRows;(ie.length!==1||ie[0]!==R)&&j&&x.exec("select-row",{id:R,toggle:je,range:ye})},"toggle-row":R=>{const Y=x.getRow(R);x.exec(Y.open!==!1?"close-row":"open-row",{id:R})},"ignore-click":()=>!1}),Zt=l.useMemo(()=>({top:we,bottom:pe,left:se.width,xScroll:be,yScroll:Se,sense:d&&ce?ce.offsetHeight:Math.max((S==null?void 0:S.rowHeight)||0,40),node:I.current&&I.current.firstElementChild}),[we,pe,se.width,be,Se,d,ce,S]);function ya(R,Y){const{container:re,sourceNode:he,from:je}=Y;if(fe()&&!he.getAttribute("draggable-data"))return!1;G(je),x.getRow(je).open&&x.exec("close-row",{id:je,nested:!0});const ye=Le(he,"data-id"),ie=ye.cloneNode(!0);ie.classList.remove("wx-selected"),ie.querySelectorAll("[tabindex]").forEach(xt=>xt.setAttribute("tabindex","-1")),re.appendChild(ie),J(ie);const $e=W-U.d,Xe=Se?L:0;re.style.width=Math.min((m||0)-Xe,H&&B<=(m||0)?me:me-Xe)+$e+"px";const et=dn(ye);Y.offset={x:$e,y:-Math.round(et.height/2)},_e.current||(_e.current=R.clientY)}function va(R,Y){const{from:re}=Y,he=Y.pos,je=dn(I.current);he.x=je.x;const ye=Zt.top;if(he.y<ye)he.y=ye;else{const ie=je.height-(be&&L>0?L:Math.round(Zt.sense/2))-Zt.bottom;he.y>ie&&(he.y=ie)}if(I.current.contains(Y.targetNode)){const ie=Le(Y.targetNode,"data-id"),$e=$t(ie==null?void 0:ie.getAttribute("data-id"));if($e&&$e!==re){Y.to=$e;const Xe=d?ce==null?void 0:ce.offsetHeight:S==null?void 0:S.rowHeight;if(ee===0||he.y>ye+Xe-1){const et=ie.getBoundingClientRect(),xt=dn(ce).y,tn=et.y,Pt=xt>tn?-1:1,nn=Pt===1?"after":"before",sn=Math.abs(x.getRowIndex(re)-x.getRowIndex($e)),In=sn!==1?nn==="before"?"after":"before":nn;if(sn===1&&(Pt===-1&&R.clientY>_e.current||Pt===1&&R.clientY<_e.current))return;_e.current=R.clientY,x.exec("move-item",{id:re,target:$e,mode:In,inProgress:!0})}}a&&a({event:R,context:Y})}Pd(R,je,Y,Zt)}function ba(R,Y){const{from:re,to:he}=Y;x.exec("move-item",{id:re,target:he,inProgress:!1}),Ce.current=setTimeout(()=>{Ce.current=0},1),G(null),J(null),_e.current=null,Mo(Y)}function ka(){const R=document.createElement("div");R.style.cssText="position:absolute;left:-1000px;width:100px;padding:0px;margin:0px;min-height:100px;overflow-y:scroll;",document.body.appendChild(R);const Y=R.offsetWidth-R.clientWidth;return document.body.removeChild(R),Y}const Sa=l.useMemo(()=>Be>0?{width:`${Be}px`}:void 0,[Be]),Ns=l.useRef(null);function Ca(){Promise.resolve().then(()=>{let R=0,Y=q;const re=Ns.current;re&&(Array.from(re.children).forEach((he,je)=>{Z.current[q+je]=he.offsetHeight,R+=he.offsetHeight,Y++}),le(R),Me(Y))})}l.useEffect(()=>{T&&d&&Ca()},[T,d,q]);let[Ge,Dn]=l.useState();l.useEffect(()=>{if($&&(!j||!K.length||K.includes($.row)))Dn({...$});else if(T.length&&U.data.length){if(!Ge||K.length&&!K.includes(Ge.row)||T.findIndex(R=>R.id==Ge.row)===-1||U.data.findIndex(R=>R.id==Ge.column&&!R.collapsed)===-1){const R=K[0]||T[0].id,Y=U.data.findIndex(re=>!re.collapsed);Dn(Y!==-1?{row:R,column:U.data[Y].id}:null)}}else Dn(null)},[$]);const Es=l.useRef(null);l.useEffect(()=>{const R=I.current;if(!R)return;const Y=Nd(R,f);return()=>{typeof Y=="function"&&Y()}},[f]);const Ts=l.useRef({});Object.assign(Ts.current,{start:ya,move:va,end:ba,getReorder:()=>o,getDraggableInfo:()=>({hasDraggable:fe()})}),l.useEffect(()=>{const R=I.current;return R?Rd(R,Ts).destroy:void 0},[o,I.current]),l.useEffect(()=>{const R=I.current;return R?js(R,{keys:Wd({undo:E}),exec:Y=>x.exec("hotkey",Y)}).destroy:void 0},[x,E]);const en=l.useRef({scroll:x.getReactiveState().scroll});en.current.getWidth=()=>(m||0)-(Se?L:0),en.current.getHeight=()=>Ee,en.current.getScrollMargin=()=>se.width+F.width,l.useEffect(()=>{cd(Es.current,en.current)},[]);const Rs=l.useRef(null);l.useEffect(()=>{const R=Rs.current;if(!R)return;const Y=[];return Y.push(qt(R,()=>x.exec("focus-cell",{eventSource:"click"})).destroy),Y.push(bi(R,It.current)),()=>Y.forEach(re=>re())},[]);const ja=`wx-grid ${g?`wx-responsive-${g}`:""}`;return h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"wx-4VuBwK2D "+ja,style:{"--header-height":`${we}px`,"--footer-height":`${pe}px`,"--split-left-width":`${se.width}px`,"--split-right-width":`${F.width}px`},children:h.jsx("div",{ref:I,className:"wx-4VuBwK2D wx-table-box",style:Sa,role:_?"treegrid":"grid","aria-colcount":U.data.length,"aria-rowcount":T.length,"aria-multiselectable":_&&r?!0:void 0,tabIndex:-1,children:h.jsxs("div",{ref:Es,className:"wx-4VuBwK2D wx-scroll",style:{overflowX:be?"scroll":"hidden",overflowY:Se?"scroll":"hidden"},onScroll:oe,children:[e?h.jsx("div",{className:"wx-4VuBwK2D wx-header-wrapper",children:h.jsx(yr,{contentWidth:me,deltaLeft:U.dh,columns:U.header,columnStyle:c,bodyHeight:Ee-+n})}):null,h.jsxs("div",{ref:Rs,className:"wx-4VuBwK2D wx-body",style:{width:`${me}px`,height:`${Te}px`},onMouseDown:R=>xe(R),children:[s?h.jsx(Kd,{overlay:s}):null,h.jsx("div",{ref:Ns,className:"wx-4VuBwK2D wx-data",style:{paddingTop:`${ve.d}px`,paddingLeft:`${U.d}px`},children:T.map((R,Y)=>{const re=C.indexOf(R.id)!==-1,he=X===R.id,je="wx-row"+(d?" wx-autoheight":"")+(i?" "+i(R):"")+(re?" wx-selected":"")+(he?" wx-inactive":""),ye=d?{minHeight:`${z}px`}:{height:`${z}px`};return h.jsx("div",{className:"wx-4VuBwK2D "+je,"data-id":R.id,"data-context-id":R.id,style:ye,role:"row","aria-rowindex":Y,"aria-expanded":R.open,"aria-level":_?R.$level+1:void 0,"aria-selected":_?re:void 0,tabIndex:-1,children:U.data.map(ie=>ie.collapsed?h.jsx("div",{className:"wx-4VuBwK2D wx-cell wx-collapsed"},ie.id):(N==null?void 0:N.id)===R.id&&N.column==ie.id?h.jsx(ef,{row:R,column:ie},ie.id):h.jsx(zd,{row:R,column:ie,columnStyle:c,cellStyle:u,reorder:o,focusable:(Ge==null?void 0:Ge.row)===R.id&&(Ge==null?void 0:Ge.column)==ie.id},ie.id))},R.id)})})]}),n&&(v||[]).length?h.jsx(yr,{type:"footer",contentWidth:me,deltaLeft:U.df,columns:U.footer,columnStyle:c}):null]})})}),M?h.jsx(nf,{config:M,rowStyle:i,columnStyle:c,cellStyle:u,header:e,footer:n,reorder:o}):null]})}const rf=t=>t.split("-").map(e=>e?e.charAt(0).toUpperCase()+e.slice(1):"").join(""),of=l.forwardRef(function({data:t=[],columns:e=[],rowStyle:n=null,columnStyle:s=null,cellStyle:r=null,selectedRows:o,select:a=!0,multiselect:i=!1,header:c=!0,footer:u=!1,dynamic:d=null,overlay:f=null,reorder:m=!1,onReorder:p=null,autoRowHeight:g=!1,sizes:x,split:w,tree:y=!1,autoConfig:v=!1,init:b=null,responsive:S=null,sortMarks:C,undo:k=!1,...j},N){const _=l.useRef();_.current=j;const $=l.useMemo(()=>new ad(Ar),[]),M=l.useMemo(()=>$.in,[$]),E=l.useRef(null);E.current===null&&(E.current=new Fr((A,B)=>{const Q="on"+rf(A);_.current&&_.current[Q]&&_.current[Q](B)}),M.setNext(E.current));const L=l.useMemo(()=>({getState:$.getState.bind($),getReactiveState:$.getReactive.bind($),getStores:()=>({data:$}),exec:M.exec,setNext:A=>(E.current=E.current.setNext(A),E.current),intercept:M.intercept.bind(M),on:M.on.bind(M),detach:M.detach.bind(M),getRow:$.getRow.bind($),getRowIndex:$.getRowIndex.bind($),getColumn:$.getColumn.bind($)}),[$,M]),[P,W]=l.useState(0),[V,ee]=l.useState(0),[O,H]=l.useState(null),[z,I]=l.useState(null),X=l.useMemo(()=>{if(v&&!e.length&&t.length){const A=t[0],B=[];for(let Q in A)if(Q!=="id"&&Q[0]!=="$"){let te={id:Q,header:Q[0].toUpperCase()+Q.slice(1)};typeof v=="object"&&(te={...te,...v}),B.push(te)}return B}return(z&&z.columns)??e},[v,e,t,z]),G=l.useMemo(()=>(z&&z.sizes)??x,[z,x]),ce=l.useCallback(A=>{if(W(A.width),ee(A.height),S){const B=Object.keys(S).map(Number).sort((Q,te)=>Q-te).find(Q=>A.width<=Q)??null;B!==O&&(I(S[B]),H(B))}},[S,O]),J=l.useMemo(()=>{let A=!y;return Cs()||(A=!0),A?m:!1},[y,m]),se=l.useContext(He.theme),F=l.useRef(0);return l.useEffect(()=>{if(!F.current)b&&b(L);else{const A=$.getState();$.init({data:t,columns:X,split:w||A.split,sizes:G||A.sizes,selectedRows:o||A.selectedRows,dynamic:d,tree:y,sortMarks:C||A.sortMarks,undo:k,_skin:se,_select:a})}F.current++},[$,t,X,w,G,o,d,y,C,k,se,a,b,L]),F.current===0&&$.init({data:t,columns:X,split:w||{left:0},sizes:G||{},selectedRows:o||[],dynamic:d,tree:y,sortMarks:C||{},undo:k,_skin:se,select:a}),l.useImperativeHandle(N,()=>({...L}),[L]),h.jsx(Oe.Provider,{value:L,children:h.jsx(Xt,{words:ud,optional:!0,children:h.jsx(sf,{header:c,footer:u,overlay:f,rowStyle:n,columnStyle:s,cellStyle:r,reorder:J,onReorder:p,multiselect:i,autoRowHeight:g,clientWidth:P,clientHeight:V,responsiveLevel:O,resize:ce})})})});fs($d);const No={};function af(t){return No[t]||t}function Rt(t,e){No[t]=e}function Eo({menu:t=!1}){return h.jsx("div",{className:`wx-z1qpqrvg wx-separator${t?"-menu":""}`,children:"Â "})}function To(){return h.jsx("div",{className:"wx-1IhFzpJV wx-spacer"})}const lf=({key:t,text:e,...n})=>n;function _s(t){const{item:e={},menu:n=!1,values:s,onClick:r,onChange:o}=t,a=l.useMemo(()=>af(e.comp||"label"),[e]),i=l.useCallback(()=>{e&&e.handler&&e.handler(e),r&&r({item:e})},[e,r]),c=l.useMemo(()=>e&&e.key&&s?s[e.key]:void 0,[e,s]),u=l.useCallback(({value:f})=>{e&&e.handler&&e.handler(e,f),o&&o({value:f,item:e})},[e,o]),d=l.useMemo(()=>n?e?e.menuText||e.text:void 0:e?e.text:void 0,[n,e]);if(e&&e.comp=="spacer")return h.jsx(To,{});if(e&&e.comp=="separator")return h.jsx(Eo,{menu:n});{const f=a,m=["wx-tb-element",e&&e.css?e.css:"",e&&e.spacer?"wx-spacer":"",n?"wx-menu":""].filter(Boolean).join(" ");return h.jsx("div",{className:"wx-KVAsgMam "+m,"data-id":e?e.id:void 0,children:h.jsx(f,{value:c,onChange:u,onClick:i,text:d,menu:n,...lf(e)})})}}function yn({item:t,values:e=null,menu:n=!1,onChange:s,onClick:r}){const[o,a]=l.useState(!0),i=()=>a(!0),c=()=>a(!1),u=f=>{i(),r&&r(f)},d=["wx-wSVFAGym","wx-tb-group",t.css||"",t.layout=="column"?"wx-column":"",t.collapsed&&!n?"wx-group-collapsed":""].filter(Boolean).join(" ");return h.jsx("div",{className:d,children:t.collapsed&&!n?h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"wx-wSVFAGym wx-collapsed",onClick:c,children:[t.icon?h.jsx("i",{className:`wx-wSVFAGym icon ${t.icon}`}):null,t.text?h.jsx("div",{className:"wx-wSVFAGym wx-label-text",children:t.text}):null,t.text&&!t.icon?h.jsx("i",{className:"wx-wSVFAGym wx-label-arrow wxi-angle-down"}):null]}),o?null:h.jsx(Et,{width:"",oncancel:i,children:h.jsx("div",{className:"wx-wSVFAGym wx-drop-group",children:h.jsx(yn,{item:{...t,text:"",collapsed:!1},values:e,menu:n,onChange:s,onClick:u})})})]}):h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"wx-wSVFAGym wx-tb-body",children:t.items.map((f,m)=>f.items?h.jsx(yn,{item:f,values:e,onClick:u,onChange:s},f.id||m):h.jsx(_s,{item:f,values:e,onClick:u,onChange:s},f.id||m))}),t.text?h.jsx("div",{className:"wx-wSVFAGym wx-label",children:t.text}):null]})})}function cf({items:t=[],css:e,values:n,width:s,onClick:r,onChange:o}){const[a,i]=l.useState(void 0),c=l.useRef(null);function u(){i(null)}function d(){i(!0)}function f(m){u(),r&&r(m)}return h.jsxs("div",{className:`wx-Yo6BuX0p wx-menu ${e||""}`,ref:c,"data-id":"$menu",children:[h.jsx(dt,{icon:"wxi-dots-h",onClick:d}),a?h.jsx(Et,{width:`${s}px`,onCancel:u,children:h.jsx("div",{className:"wx-Yo6BuX0p wx-drop-menu",children:t.map((m,p)=>m.items?h.jsx(yn,{item:m,values:n,menu:!0,onClick:f,onChange:o},m.id||p):h.jsx(_s,{item:m,values:n,menu:!0,onClick:f,onChange:o},m.id||p))})}):null]})}function uf(t){return t.forEach(e=>{e.id||(e.id=Qe())}),t}function ss(t){const{items:e,menuCss:n="",css:s="",values:r,overflow:o="menu",onClick:a,onChange:i}=t,[c,u]=ke(e||[]),[d,f]=ke(r||null),m=l.useMemo(()=>uf(c),[c]),p=l.useRef(null),g=l.useRef(-1),[x,w]=l.useState([]),y=l.useRef(m);l.useEffect(()=>{y.current=m},[c]);const v=l.useRef(o);l.useEffect(()=>{v.current=o},[o]);const b=l.useRef(x);l.useEffect(()=>{b.current=x},[x]);const S=l.useRef(!1);function C($){d&&(d[$.item.key]=$.value,f({...d})),i&&i($)}function k(){const $=p.current;if(!$)return 0;const M=$.children,E=y.current||[];let L=0;for(let P=0;P<E.length;P++)E[P].comp!=="spacer"&&(L+=M[P].clientWidth,E[P].comp==="separator"&&(L+=8));return L}function j(){const $=p.current,M=y.current||[];if($){for(let E=M.length-1;E>=0;E--)if(M[E].items&&!M[E].collapsed){M[E].collapsed=!0,M[E].$width=$.children[E].offsetWidth,S.current=!0,u([...M]);return}}}function N($){const M=p.current,E=y.current||[];if(M){for(let L=0;L<E.length;L++)if(E[L].collapsed&&E[L].$width){E[L].$width-M.children[L].offsetWidth<$+10&&(E[L].collapsed=!1,S.current=!0),u([...E]);return}}}function _(){const $=p.current;if(!$)return;const M=y.current||[],E=v.current;if(E==="wrap")return;const L=$.clientWidth;if($.scrollWidth>L){if(E==="collapse")return j();const P=$.children;let W=0;for(let V=0;V<M.length;V++){if(W+=P[V].clientWidth,M[V].comp==="separator"&&(W+=8),W>L-40){if(g.current===V)return;g.current=V;const ee=[];for(let O=V;O<M.length;O++)ee.push(M[O]),P[O].style.visibility="hidden";V>0&&M[V-1].comp==="separator"&&(P[V-1].style.visibility="hidden"),w(ee);break}P[V].style.visibility=""}}else{const P=L-k();if(P<=0)return;if(E==="collapse")return N(P);if((b.current||[]).length){g.current=null;const W=$.children;for(let V=0;V<M.length;V++)W[V].style.visibility="";w([])}}}return l.useEffect(()=>{S.current&&(S.current=!1,_())},[c]),l.useEffect(()=>{const $=new ResizeObserver(()=>_());return p.current&&$.observe(p.current),()=>{$.disconnect()}},[]),h.jsxs("div",{className:`wx-VdPSJj8y wx-toolbar ${s||""} ${o==="wrap"?"wx-wrap":""}`,ref:p,children:[m.map($=>$.items?h.jsx(yn,{item:$,values:d,onClick:a,onChange:C},$.id):h.jsx(_s,{item:$,values:d,onClick:a,onChange:C},$.id)),!!x.length&&h.jsx(cf,{items:x,css:n,values:d,onClick:a,onChange:C})]})}function df(t){const{icon:e,text:n="",css:s,type:r,disabled:o,menu:a,onClick:i}=t;return a?h.jsxs("div",{className:"wx-HXpG4gnx wx-item",onClick:i,children:[h.jsx("i",{className:`wx-HXpG4gnx ${e||"wxi-empty"} ${s||""}`}),n]}):h.jsx(dt,{icon:e,type:r,css:s,text:n,disabled:o,onClick:i})}function ff(t){const{text:e,value:n,children:s}=t;return s?h.jsx("div",{className:"wx-PTEZGYcj wx-label",children:s()}):h.jsx("div",{className:"wx-PTEZGYcj wx-label",children:n||e})}function hf(t){const{icon:e,text:n,css:s,type:r,disabled:o,menu:a,onClick:i}=t;return a?h.jsxs("div",{className:"wx-3cuSqONJ wx-item",onClick:i,children:[e?h.jsx("i",{className:`wx-3cuSqONJ ${e||""} ${s||""}`}):null,n]}):h.jsx(dt,{icon:e,type:r,css:s,title:n,disabled:o,onClick:i})}function pf({id:t="",text:e="",css:n="",icon:s="",onClick:r}){function o(){r&&r({id:t})}return h.jsxs("div",{className:`wx-U0Bx7pIR wx-label ${n}`,onClick:o,children:[s?h.jsx("i",{className:"wx-U0Bx7pIR "+s}):null,e]})}Rt("button",df);Rt("separator",Eo);Rt("spacer",To);Rt("label",ff);Rt("item",pf);Rt("icon",hf);const rs={};function br(t){return typeof t<"u"?rs[t]||t:rs.text}function Ve(t,e){rs[t]=e}const mf={editor:{}};function Wn(t){const{editors:e,data:n,css:s="",errors:r,focus:o=!1,onClick:a,children:i,onChange:c}=t,u=l.useRef(null);l.useEffect(()=>{if(o){const p=document.activeElement;if(p&&u.current&&u.current.contains(p))return;const g=u.current?u.current.querySelector("input:not([disabled]), textarea:not([disabled]), select:not([disabled])"):null;g&&setTimeout(()=>{typeof g.select=="function"&&g.select(),typeof g.focus=="function"&&g.focus()},300)}},[]);const d=l.useContext(He.i18n),f=l.useMemo(()=>d.getGroup("editor"),[d]),m=l.useMemo(()=>e.config[0].comp==="readonly"&&e.config.every(p=>!Object.keys(n).includes(p.key)),[e,n]);return h.jsxs("div",{className:"wx-s2aE1xdZ wx-sections "+s,ref:u,children:[i,m?h.jsx("div",{className:"wx-s2aE1xdZ wx-overlay",children:f("No data")}):null,e.config.map(p=>{if(!p.hidden){const{key:g,onChange:x,...w}=p;if(p.comp==="readonly"||p.comp==="section"){const y=br(p.comp);return h.jsx(y,{fieldKey:g,label:p.label,value:n[g],...w,onClick:a},g)}else{const y=br(p.comp);return h.jsxs("div",{children:[h.jsx(Yt,{label:p.labelTemplate?p.labelTemplate(n[g]):p.label??"",required:p.required,children:({id:v})=>h.jsx(y,{fieldKey:g,...w,onChange:x||(b=>{c&&c({value:b.value,key:g,input:b.input})}),id:v,label:void 0,error:r&&r[g],value:n[g]},g)}),r&&r[g]&&p.validationMessage?h.jsx("div",{className:"wx-s2aE1xdZ wx-message",children:p.validationMessage}):null]},g)}}return null})]})}function xf(t){if(typeof t=="string"&&t.includes(".")){const e=t.split(".");return n=>{let s=n;return e.forEach(r=>{s=s[r]}),s}}return e=>e[t]}function gf(t){if(typeof t=="string"&&t.includes(".")){const e=t.split(".");return(n,s)=>{let r=n;e.forEach((o,a)=>{a===e.length-1?r[o]=s:r=r[o]})}}return(e,n)=>e[t]=n}function wf(t){const e=t.map(a=>{const i={...a};return a.config&&Object.assign(i,a.config),i.key=a.key||rl(),i.setter=a.setter||gf(a.key),i.getter=a.getter||xf(a.key),i}),n=a=>{const i={};return e.forEach(c=>{c.comp!=="section"&&(c.getter?i[c.key]=c.getter(a):i[c.key]=a[c.key])}),i},s=(a,i,c)=>((c.length?c.map(u=>e.find(d=>d.key===u)):e).forEach(u=>{u.setter?u.setter(a,i[u.key]):a[u.key]=i[u.key]}),a),r=(a,i)=>{const c=n(a),u=[];return e.forEach(d=>{const f=c[d.key],m=i[d.key];!jn(f,m)&&(f!==void 0||m)&&u.push(d.key)}),u},o=(a,i,c)=>{let u=0;const d={};return(i!=null&&i.length?i.map(f=>e.find(m=>m.key===f)):e).forEach(f=>{f.required&&!a[f.key]?(d[f.key]={errorType:"required"},f.validationMessage=f.validationMessage??c("This field is required"),u++):f.validation&&!f.validation(a[f.key])&&(d[f.key]={errorType:"validation"},f.validationMessage=f.validationMessage??c("Invalid value"),u++)}),u>0?d:null};return{config:e.filter(a=>a.comp!=="hidden"),getValues:n,setValues:s,diff:r,validateValues:o}}function yf({values:t,items:e,css:n,activeBatch:s,autoSave:r,focus:o,readonly:a,topBar:i=!0,bottomBar:c=!0,layout:u="default",placement:d="inline",view:f,children:m,onChange:p,onSave:g,onAction:x,onValidation:w}){const y=l.useContext(He.i18n).getGroup("editor"),[v,b]=ke(t),[S,C]=l.useState(null),k=l.useMemo(()=>{const z=wf(e);S&&z.config.forEach(G=>{G.comp==="section"&&G.key===S&&(G.sectionMode==="accordion"?G.activeSection||(z.config.forEach(ce=>{ce.comp==="section"&&ce.key!==G.key&&(ce.activeSection=!1)}),G.activeSection=!0):G.activeSection=!G.activeSection)});let I=new Set,X=null;return z.config.forEach(G=>{G.sectionMode==="exclusive"&&G.activeSection&&(X=G.key),G.activeSection&&I.add(G.key)}),z.config.forEach(G=>{G.hidden=G.hidden||s&&s!==G.batch||X&&G.key!=X&&G.section!==X||G.section&&!I.has(G.section)}),a?{...z,config:z.config.map(G=>({...G,comp:"readonly"})),diff:()=>[]}:z},[e,S,s,a]),[j,N]=l.useState({}),[_,$]=l.useState({});l.useEffect(()=>{v!==void 0&&(N(mn(v)),$(mn(v)))},[v]);const M=v,[E,L]=l.useState([]);l.useEffect(()=>{v&&L([])},[v]);function P(z){return[...new Set(z)]}function W(z){const I=k.validateValues(j,z,y);return jn(I,M.errors)||w&&w({errors:I,values:j}),I}function V(z,I){if(r&&!M.errors){const X=k.setValues(v,I??_,z);b(X),g&&g({changes:z,values:X})}else L(z)}function ee({value:z,key:I,input:X}){let G={..._||{},[I]:z};const ce={key:I,value:z,update:G};if(X&&(ce.input=X),p&&p(ce),!v)return;G=ce.update,$(G);const J=k.diff(v,G),se=k.setValues({...j||{}},G,P([...J,I]));if(N(se),J.length){const F=r?[]:P([...J,...Object.keys(M.errors??{}),I]);M.errors=W(F),V(J,G)}else{const F=Object.keys(M.errors??{});F.length&&(M.errors=W(F)),L([])}}function O(){if(E.length&&(r||(M.errors=W()),!M.errors)){g&&g({changes:E,values:j});const z=k.setValues(v,_,E);b(z),L([]),b({...j})}}function H({item:z}){z.id==="save"?O():z.id==="toggle-section"&&C(z.key),x&&x({item:z,values:j,changes:E})}return h.jsx(f,{topBar:i,bottomBar:c,placement:d,layout:u,readonly:a,autoSave:r,css:n,data:_,editors:k,focus:o,errors:M.errors,onClick:H,onKeyDown:H,onChange:ee,children:m})}function vf(t,{keys:e,action:n}){function s(r){let o=r.code.replace("Key","").toLowerCase();const a=`${r.ctrlKey||r.metaKey?"ctrl+":""}${o}`,i=e[a];if(!i)return;const c=r.target.closest(".wx-combo")||r.target.closest(".wx-multicombo")||r.target.closest(".wx-richselect");c&&c.querySelector(".wx-list")||(r.preventDefault(),n(i))}return t.addEventListener("keydown",s),{destroy:()=>{t.removeEventListener("keydown",s)}}}function bf(t){const{editors:e,data:n,layout:s,errors:r,focus:o,onClick:a,onChange:i}=t,c=l.useMemo(()=>{let u=[];if(s==="columns"&&(u=[{...e,config:[]},{...e,config:[]}],e.config.forEach(d=>{const f=d.column==="left"?0:1;u[f].config.push(d)}),u[0].config.length)){const d=u[0].config[0];d.comp==="text"&&(u[0][0]={...d,css:"title",label:""})}return u},[s,e]);return s==="columns"?h.jsxs("div",{className:"wx-bNrSbszs wx-cols",children:[h.jsx("div",{className:"wx-bNrSbszs wx-left",children:h.jsx(Wn,{editors:c[0],data:n,errors:r,onClick:a,onChange:i})}),h.jsx("div",{className:"wx-bNrSbszs wx-right",children:h.jsx(Wn,{editors:c[1],data:n,focus:o,errors:r,onClick:a,onChange:i})})]}):h.jsx(Wn,{editors:e,data:n,focus:o,errors:r,onClick:a,onChange:i})}function kr({items:t,values:e=null,top:n=!0,onClick:s,onChange:r}){const o=l.useCallback(({item:a,value:i})=>{r&&r({key:a.key,value:i})},[r]);return t.length?h.jsx("div",{className:`wx-66OW1j0R wx-editor-toolbar ${n?"wx-topbar":"wx-bottom"}`,children:h.jsx(ss,{items:t,values:e,onClick:s,onChange:o})}):null}const Ot=()=>({comp:"spacer"}),zn=t=>({comp:"button",text:t("Cancel"),id:"cancel"}),Fn=t=>({type:"primary",comp:"button",text:t("Save"),id:"save"}),Sr=()=>({comp:"icon",icon:"wxi-close",id:"close"});function Vn(t){const{data:e,editors:n,focus:s,css:r,topBar:o,bottomBar:a,layout:i,placement:c,errors:u,readonly:d,autoSave:f,children:m,onClick:p,onKeyDown:g,onChange:x}=t,w=l.useContext(He.i18n),y=l.useMemo(()=>w.getGroup("editor"),[w]),v=l.useMemo(()=>o===!0&&a===!0,[o,a]),b=l.useMemo(()=>{let j=o&&o.items?o.items.map(N=>({...N})):[];return v&&(d?j=[Ot(),Sr()]:(f?j=[Ot(),Sr()]:c!=="modal"&&(j=[Ot(),zn(y),Fn(y)]),i==="columns"&&!j.length&&(j=[Ot(),Fn(y),zn(y)]))),j},[o,v,d,f,c,i,y]),S=l.useMemo(()=>{let j=a&&a.items?a.items.map(N=>({...N})):[];return v&&(d||(c==="modal"&&!f&&(j=[Ot(),Fn(y),zn(y)]),i==="columns"&&b.length&&(j=[]))),j},[a,v,d,c,f,i,b,y]),C=l.useMemo(()=>[...b,...S],[b,S]),k=l.useRef(null);return l.useEffect(()=>{const j=k.current;if(!j)return;const N=vf(j,{keys:{"ctrl+s":C.find(_=>_.id==="save"),escape:C.find(_=>_.id==="cancel"||_.id==="close"),"ctrl+d":C.find(_=>_.id==="delete")},action:_=>{g&&g({item:_})}});return()=>{typeof N=="function"&&N()}},[C,g]),h.jsxs("div",{className:r?"wx-85HDaNoA "+r:"wx-85HDaNoA",ref:k,children:[h.jsx(kr,{...o&&typeof o=="object"?o:{},items:b,values:e,onClick:p,onChange:x}),h.jsxs("div",{className:`wx-85HDaNoA wx-content${i==="columns"?" wx-layout-columns":""}`,children:[m,h.jsx(bf,{editors:n,layout:i,data:e,focus:s,errors:u,onClick:p,onChange:x}),h.jsx(kr,{...a&&typeof a=="object"?a:{},items:S,values:e,top:!1,onClick:p,onChange:x})]})]})}function kf(t){const{css:e,onClick:n,placement:s,...r}=t;function o(){n&&n({item:{id:"close"}})}return s==="modal"?h.jsx(Zi,{children:h.jsx(Vn,{css:`wx-panel ${e}`,onClick:n,placement:s,...r})}):s==="sidebar"?h.jsx(el,{onCancel:o,children:h.jsx(Vn,{css:`wx-panel ${e}`,onClick:n,placement:s,...r})}):h.jsx(Vn,{css:`wx-inline-form ${e}`,onClick:n,placement:s,...r})}function Sf(t){const{values:e={},items:n=[],css:s="",activeBatch:r=null,topBar:o=!0,bottomBar:a=!0,focus:i=!1,autoSave:c=!1,layout:u="default",readonly:d=!1,placement:f="inline",children:m,...p}=t,g=Object.keys(p).reduce((x,w)=>{if(/^on[a-z]/.test(w)){const y="on"+w.charAt(2).toUpperCase()+w.slice(3);y in p?x[w]=p[w]:x[y]=p[w]}else x[w]=p[w];return x},{});return h.jsx(Xt,{words:mf,optional:!0,children:h.jsx(yf,{view:kf,values:e,items:n,css:s,activeBatch:r,topBar:o,bottomBar:a,focus:i,autoSave:c,layout:u,readonly:d,placement:f,...g,children:m})})}function Cf({value:t,options:e,label:n}){const s=l.useContext(He.i18n).getGroup("editor"),r=l.useMemo(()=>{let o=t;if(typeof t=="boolean"&&(o=s(t?"Yes":"No")),e){const a=e.find(i=>i.id===t);a&&(o=a.label)}return o},[t,e,s]);return r||r===0?h.jsx(Yt,{label:n,children:r}):null}function jf({fieldKey:t,label:e,activeSection:n,onClick:s}){return h.jsxs("div",{className:`wx-OmgQq65I wx-section${n?" wx-section-active":""}`,onClick:()=>s&&s({item:{id:"toggle-section",key:n?null:t}}),children:[h.jsx("h3",{children:e}),h.jsx("i",{className:`wx-OmgQq65I wxi-angle-${n?"down":"right"} wx-icon`})]})}Ve("text",Sn);Ve("textarea",Mi);Ve("checkbox",_i);Ve("readonly",Cf);Ve("section",jf);fs(Pe);const ot=l.createContext(null);function Vt(t){const e=t.getAttribute("data-id"),n=parseInt(e);return isNaN(n)||n.toString()!=e?e:n}function Mf(t,e,n){const s=t.getBoundingClientRect(),r=e.querySelector(".wx-body").getBoundingClientRect();return{top:s.top-r.top,left:s.left-r.left,dt:s.bottom-n.clientY,db:n.clientY-s.top}}function Cr(t){return t&&t.getAttribute("data-context-id")}const jr=5;function _f(t,e){let n,s,r,o,a,i,c,u,d;function f(k){o=k.clientX,a=k.clientY,i={...Mf(n,t,k),y:e.getTask(r).$y},document.body.style.userSelect="none"}function m(k){n=Le(k),Cr(n)&&(r=Vt(n),d=setTimeout(()=>{u=!0,e&&e.touchStart&&e.touchStart(),f(k.touches[0])},500),t.addEventListener("touchmove",v),t.addEventListener("contextmenu",p),window.addEventListener("touchend",b))}function p(k){if(u||d)return k.preventDefault(),!1}function g(k){k.which===1&&(n=Le(k),Cr(n)&&(r=Vt(n),t.addEventListener("mousemove",y),window.addEventListener("mouseup",S),f(k)))}function x(k){t.removeEventListener("mousemove",y),t.removeEventListener("touchmove",v),document.body.removeEventListener("mouseup",S),document.body.removeEventListener("touchend",b),document.body.style.userSelect="",k&&(t.removeEventListener("mousedown",g),t.removeEventListener("touchstart",m))}function w(k){const j=k.clientX-o,N=k.clientY-a;if(!s){if(Math.abs(j)<jr&&Math.abs(N)<jr||e&&e.start&&e.start({id:r,e:k})===!1)return;s=n.cloneNode(!0),s.style.pointerEvents="none",s.classList.add("wx-reorder-task"),s.style.position="absolute",s.style.left=i.left+"px",s.style.top=i.top+"px",n.style.visibility="hidden",n.parentNode.insertBefore(s,n)}if(s){const _=Math.round(Math.max(0,i.top+N));if(e&&e.move&&e.move({id:r,top:_,detail:c})===!1)return;const $=e.getTask(r),M=$.$y;if(!i.start&&i.y==M)return C();i.start=!0,i.y=$.$y-4,s.style.top=_+"px";const E=document.elementFromPoint(k.clientX,k.clientY),L=Le(E);if(L&&L!==n){const P=Vt(L),W=L.getBoundingClientRect(),V=W.top+W.height/2,ee=k.clientY+i.db>V&&L.nextElementSibling!==n,O=k.clientY-i.dt<V&&L.previousElementSibling!==n;(c==null?void 0:c.after)==P||(c==null?void 0:c.before)==P?c=null:ee?c={id:r,after:P}:O&&(c={id:r,before:P})}}}function y(k){w(k)}function v(k){u?(k.preventDefault(),w(k.touches[0])):d&&(clearTimeout(d),d=null)}function b(){u=null,d&&(clearTimeout(d),d=null),C()}function S(){C()}function C(){n&&(n.style.visibility=""),s&&(s.parentNode.removeChild(s),e&&e.end&&e.end({id:r,top:i.top})),r=n=s=i=c=null,x()}return t.style.position!=="absolute"&&(t.style.position="relative"),t.addEventListener("mousedown",g),t.addEventListener("touchstart",m),{destroy(){x(!0)}}}function $f({row:t,column:e}){function n(r,o){return{justifyContent:o.align,paddingLeft:`${(r.$level-1)*20}px`}}const s=e&&e._cell;return h.jsxs("div",{className:"wx-pqc08MHU wx-content",style:n(t,e),children:[t.data||t.lazy?h.jsx("i",{className:`wx-pqc08MHU wx-toggle-icon wxi-menu-${t.open?"down":"right"}`,"data-action":"open-task"}):h.jsx("i",{className:"wx-pqc08MHU wx-toggle-placeholder"}),h.jsx("div",{className:"wx-pqc08MHU wx-text",children:s?h.jsx(s,{row:t,column:e}):t.text})]})}function Mr({column:t,cell:e}){const n=l.useMemo(()=>t.id,[t==null?void 0:t.id]);return e||t.id=="add-task"?h.jsx("div",{style:{textAlign:t.align},children:h.jsx("i",{className:"wx-9DAESAHW wx-action-icon wxi-plus","data-action":n})}):null}function Nf(t){const{readonly:e,compactMode:n,width:s=0,display:r="all",columnWidth:o=0,onTableAPIChange:a}=t,[i,c]=ke(o),[u,d]=l.useState(),f=l.useContext(He.i18n),m=l.useMemo(()=>f.getGroup("gantt"),[f]),p=l.useContext(ot),g=ne(p,"scrollTop"),x=ne(p,"cellHeight"),w=ne(p,"_scrollTask"),y=ne(p,"_selected"),v=ne(p,"area"),b=ne(p,"_tasks"),S=ne(p,"_scales"),C=ne(p,"columns"),k=ne(p,"_sort"),j=ne(p,"durationUnit"),N=l.useRef(null),_=l.useRef(!0),[$,M]=l.useState(null),E=l.useMemo(()=>!b||!v?[]:b.slice(v.start,v.end),[b,v]),L=l.useCallback((T,K)=>{if(K==="add-task")p.exec(K,{target:T,task:{text:m("New Task")},mode:"child",show:!0});else if(K==="open-task"){const q=E.find(oe=>oe.id===T);(q!=null&&q.data||q!=null&&q.lazy)&&p.exec(K,{id:T,mode:!q.open})}},[E]),P=l.useCallback(T=>{const K=Bt(T),q=T.target.dataset.action;q&&T.preventDefault(),K?q==="add-task"||q==="open-task"?L(K,q):p.exec("select-task",{id:K,toggle:T.ctrlKey||T.metaKey,range:T.shiftKey,show:!0}):q==="add-task"&&L(null,q)},[p,L]),W=l.useRef(null),V=l.useRef(null),[ee,O]=l.useState(0),[H,z]=l.useState(!1);l.useEffect(()=>{const T=V.current;if(!T||typeof ResizeObserver>"u")return;const K=()=>O(T.clientWidth);K();const q=new ResizeObserver(K);return q.observe(T),()=>q.disconnect()},[]);const I=l.useRef(null),X=l.useCallback(T=>{var _e;const K=T.id,{before:q,after:oe}=T,xe=T.onMove;let fe=q||oe,Ce=q?"before":"after";if(xe){if(Ce==="after"){const It=p.getTask(fe);(_e=It.data)!=null&&_e.length&&It.open&&(Ce="before",fe=It.data[0].id)}I.current={id:K,[Ce]:fe}}else I.current=null;p.exec("move-task",{id:K,mode:Ce,target:fe,inProgress:xe})},[p]),G=l.useMemo(()=>(v==null?void 0:v.from)??0,[v]),ce=l.useMemo(()=>(S==null?void 0:S.height)??0,[S]),J=l.useMemo(()=>!n&&r!=="grid"?(i??0)>(s??0):(i??0)>(ee??0),[n,r,i,s,ee]),se=l.useMemo(()=>{const T={};return J&&r==="all"||r==="grid"&&J?T.width=i:r==="grid"&&(T.width="100%"),T},[J,r,i]),F=l.useMemo(()=>$&&!E.find(T=>T.id===$.id)?[...E,$]:E,[E,$]),A=l.useMemo(()=>{let T=(C||[]).map(oe=>{oe={...oe};const xe=oe.header;if(typeof xe=="object"){const fe=xe.text&&m(xe.text);oe.header={...xe,text:fe}}else oe.header=m(xe);return oe});const K=T.findIndex(oe=>oe.id==="text"),q=T.findIndex(oe=>oe.id==="add-task");if(K!==-1&&(T[K].cell&&(T[K]._cell=T[K].cell),T[K].cell=$f),q!==-1){T[q].cell=T[q].cell||Mr;const oe=T[q].header;if(typeof oe!="object"&&(T[q].header={text:oe}),T[q].header.cell=oe.cell||Mr,e)T.splice(q,1);else if(n){const[xe]=T.splice(q,1);T.unshift(xe)}}return T.length>0&&(T[T.length-1].resize=!1),T},[C,m,e,n]),B=l.useMemo(()=>r==="all"?`${s}px`:r==="grid"?"calc(100% - 4px)":A.find(T=>T.id==="add-task")?"50px":"0",[r,s,A]),Q=l.useMemo(()=>{if(F&&(k!=null&&k.length)){const T={};return k.forEach(({key:K,order:q},oe)=>{T[K]={order:q,...k.length>1&&{index:oe}}}),T}return{}},[F,k]),te=l.useCallback(()=>A.some(T=>T.flexgrow&&!T.hidden),[]),U=l.useMemo(()=>te(),[te,H]),we=l.useMemo(()=>{let T=r==="chart"?A.filter(q=>q.id==="add-task"):A;const K=r==="all"?s:ee;if(!U){let q=i,oe=!1;if(A.some(xe=>xe.$width)){let xe=0;q=A.reduce((fe,Ce)=>(Ce.hidden||(xe+=Ce.width,fe+=Ce.$width||Ce.width),fe),0),xe>q&&q>K&&(oe=!0)}if(oe||q<K){let xe=1;return oe||(xe=(K-50)/(q-50||1)),T.map(fe=>(fe.id!=="add-task"&&!fe.hidden&&(fe.$width||(fe.$width=fe.width),fe.width=fe.$width*xe),fe))}}return T},[r,A,U,i,s,ee]),pe=l.useCallback(T=>{if(!te()){const K=we.reduce((q,oe)=>(T&&oe.$width&&(oe.$width=oe.width),q+(oe.hidden?0:oe.width)),0);K!==i&&c(K)}z(!0),z(!1)},[te,we,i,c]),be=l.useCallback(()=>{A.filter(T=>T.flexgrow&&!T.hidden).length===1&&A.forEach(T=>{T.$width&&!T.flexgrow&&!T.hidden&&(T.width=T.$width)})},[]),Ee=l.useCallback(T=>{var K;if(!e){const q=Bt(T),oe=Bn(T,"data-col-id");!((K=oe&&A.find(xe=>xe.id==oe))!=null&&K.editor)&&q&&p.exec("show-editor",{id:q})}},[p,e]),D=l.useCallback(()=>{_.current=!1},[]),Z=l.useCallback(T=>{_.current=!0,N.current=T.touches[0].clientY+(g??0)},[g]),ue=l.useCallback(T=>{if(_.current){const K=(N.current??0)-T.touches[0].clientY;return p.exec("scroll-chart",{top:K}),T.preventDefault(),!1}},[p]),le=l.useMemo(()=>Array.isArray(y)?y.map(T=>T.id):[],[y]);l.useEffect(()=>{const T=()=>D();return window.addEventListener("touchend",T),()=>window.removeEventListener("touchend",T)},[D]);const de=l.useCallback(()=>{if(W.current&&F!==null){const T=W.current.querySelector(".wx-body");T&&(T.style.top=-((g??0)-(G??0))+"px")}V.current&&(V.current.scrollTop=0)},[F,g,G]);l.useEffect(()=>{W.current&&de()},[g,G,de]),l.useEffect(()=>{const T=W.current;if(!T)return;const K=T.querySelector(".wx-table-box .wx-body");if(!K||typeof ResizeObserver>"u")return;const q=new ResizeObserver(()=>{de()});return q.observe(K),()=>{q.disconnect()}},[we,se,r,B,F,de]),l.useEffect(()=>{if(!w||!u)return;const{id:T}=w,K=u.getState().focusCell;K&&K.row!==T&&W.current&&W.current.contains(document.activeElement)&&u.exec("focus-cell",{row:T,column:K.column})},[w,u]);const Me=l.useCallback(({id:T})=>{if(e)return!1;p.getTask(T).open&&p.exec("open-task",{id:T,mode:!1});const K=p.getState()._tasks.find(q=>q.id===T);if(M(K||null),!K)return!1},[p,e]),ve=l.useCallback(({id:T,top:K})=>{I.current?X({...I.current,onMove:!1}):p.exec("drag-task",{id:T,top:K+(G??0),inProgress:!1}),M(null)},[p,X,G]),Te=l.useCallback(({id:T,top:K,detail:q})=>{q&&X({...q,onMove:!0}),p.exec("drag-task",{id:T,top:K+(G??0),inProgress:!0})},[p,X,G]);l.useEffect(()=>{const T=W.current;return T?_f(T,{start:Me,touchStart:D,end:ve,move:Te,getTask:p.getTask}).destroy:void 0},[p,Me,D,ve,Te]);const Se=l.useCallback(T=>{const{key:K,isInput:q}=T;if(!q&&(K==="arrowup"||K==="arrowdown"))return T.eventSource="grid",p.exec("hotkey",T),!1;if(K==="enter"){const oe=u==null?void 0:u.getState().focusCell;if(oe){const{row:xe,column:fe}=oe;fe==="add-task"?L(xe,"add-task"):fe==="text"&&L(xe,"open-task")}}},[p,L,u]),me=l.useRef(null),Be=()=>{me.current={setTableAPI:d,handleHotkey:Se,sortVal:k,api:p,adjustColumns:be,setColumnWidth:pe,tasks:E,durationUnitVal:j,onTableAPIChange:a}};Be(),l.useEffect(()=>{Be()},[d,Se,k,p,be,pe,E,j,a]);const Ye=l.useCallback(T=>{d(T),T.intercept("hotkey",K=>me.current.handleHotkey(K)),T.intercept("scroll",()=>!1),T.intercept("select-row",()=>!1),T.intercept("sort-rows",K=>{const q=me.current.sortVal,{key:oe,add:xe}=K,fe=q?q.find(_e=>_e.key===oe):null;let Ce="asc";return fe&&(Ce=!fe||fe.order==="asc"?"desc":"asc"),p.exec("sort-tasks",{key:oe,order:Ce,add:xe}),!1}),T.on("resize-column",()=>{me.current.setColumnWidth(!0)}),T.on("hide-column",K=>{K.mode||me.current.adjustColumns(),me.current.setColumnWidth()}),T.intercept("update-cell",K=>{const{id:q,column:oe,value:xe}=K,fe=me.current.tasks.find(Ce=>Ce.id===q);if(fe){const Ce={...fe};let _e=xe;_e&&!isNaN(_e)&&!(_e instanceof Date)&&(_e*=1),Ce[oe]=_e,Kt(Ce,me.current.durationUnitVal,!0,oe),p.exec("update-task",{id:q,task:Ce})}return!1}),a&&a(T)},[]);return h.jsx("div",{className:"wx-rHj6070p wx-table-container",style:{flex:`0 0 ${B}`},ref:V,children:h.jsx("div",{ref:W,style:se,className:"wx-rHj6070p wx-table",onTouchStart:Z,onTouchMove:ue,onClick:P,onDoubleClick:Ee,children:h.jsx(of,{init:Ye,sizes:{rowHeight:x,headerHeight:(ce??0)-1},rowStyle:T=>T.$reorder?"wx-rHj6070p wx-reorder-task":"wx-rHj6070p",columnStyle:T=>`wx-rHj6070p wx-text-${T.align}${T.id==="add-task"?" wx-action":""}`,data:F,columns:we,selectedRows:[...le],sortMarks:Q})})})}function Ef({borders:t=""}){const e=l.useContext(ot),n=ne(e,"cellWidth"),s=ne(e,"cellHeight"),r=l.useRef(null),[o,a]=l.useState("#e4e4e4");l.useEffect(()=>{if(typeof getComputedStyle<"u"&&r.current){const c=getComputedStyle(r.current).getPropertyValue("--wx-gantt-border");a(c?c.substring(c.indexOf("#")):"#1d1e261a")}},[]);const i={width:"100%",height:"100%",background:n!=null&&s!=null?`url(${wu(n,s,o,t)})`:void 0,position:"absolute"};return h.jsx("div",{ref:r,style:i})}function Tf(t){const{readonly:e,taskTemplate:n}=t,s=l.useContext(ot),[r,o]=pn(s,"_tasks"),[a,i]=pn(s,"_links"),c=ne(s,"area"),u=ne(s,"_scales"),d=ne(s,"taskTypes"),f=ne(s,"baselines"),m=ne(s,"_selected"),p=ne(s,"_scrollTask"),g=l.useMemo(()=>{if(!c||!Array.isArray(r))return[];const D=c.start??0,Z=c.end??0;return r.slice(D,Z).map(ue=>({...ue}))},[o,c]),x=l.useMemo(()=>u.lengthUnitWidth,[u]),w=l.useRef(!1),[y,v]=l.useState(void 0),[b,S]=l.useState(null),C=l.useRef(null),[k,j]=l.useState(void 0),N=l.useRef(null),[_,$]=l.useState(0),M=l.useRef(null),E=l.useMemo(()=>{const D=M.current;return!!(m.length&&D&&D.contains(document.activeElement))},[m,M.current]),L=l.useMemo(()=>{var D;return E&&((D=m[m.length-1])==null?void 0:D.id)},[E,m]);l.useEffect(()=>{var D;if(p&&E&&p){const{id:Z}=p,ue=(D=M.current)==null?void 0:D.querySelector(`.wx-bar[data-id='${Z}']`);ue&&ue.focus({preventScroll:!0})}},[p]),l.useEffect(()=>{const D=M.current;if(D&&($(D.offsetWidth||0),typeof ResizeObserver<"u")){const Z=new ResizeObserver(ue=>{ue[0]&&$(ue[0].contentRect.width)});return Z.observe(D),()=>Z.disconnect()}},[M.current]);const P=l.useCallback(()=>{document.body.style.userSelect="none"},[]),W=l.useCallback(()=>{document.body.style.userSelect=""},[]),V=l.useCallback((D,Z,ue)=>{if(ue||(ue=s.getTask(Vt(D))),ue.type==="milestone"||ue.type=="summary")return"";const le=D.getBoundingClientRect(),de=(Z.clientX-le.left)/le.width;let Me=.2/(le.width>200?le.width/200:1);return de<Me?"start":de>1-Me?"end":""},[s]),ee=l.useCallback((D,Z)=>{const{clientX:ue}=Z,le=Vt(D),de=s.getTask(le),Me=Z.target.classList;if(!e){if(Me.contains("wx-progress-marker")){const{progress:ve}=s.getTask(le);C.current={id:le,x:ue,progress:ve,dx:0,node:D,marker:Z.target},Z.target.classList.add("wx-progress-in-drag")}else{const ve=V(D,Z,de)||"move";S({id:le,mode:ve,x:ue,dx:0,l:de.$x,w:de.$w})}P()}},[s,e,V,P]),O=l.useCallback(D=>{if(D.button!==0)return;const Z=Le(D);Z&&ee(Z,D)},[e,x,_,b,y]),H=l.useCallback(D=>{const Z=Le(D);Z&&(N.current=setTimeout(()=>{j(!0),ee(Z,D.touches[0])},300))},[e]),z=l.useCallback(()=>{if(C.current){const{dx:D,id:Z,marker:ue,value:le}=C.current;C.current=null,typeof le<"u"&&D&&s.exec("update-task",{id:Z,task:{progress:le}}),ue.classList.remove("wx-progress-in-drag"),w.current=!0,W()}else if(b){const{id:D,mode:Z,dx:ue,l:le,w:de,start:Me}=b;if(S(null),Me){const ve=Math.round(ue/x);if(!ve)s.exec("drag-task",{id:D,width:de,left:le,inProgress:!1});else{let Te={},Se=s.getTask(D);Z=="move"?(Te.start=Se.start,Te.end=Se.end):Te[Z]=Se[Z],s.exec("update-task",{id:D,task:Te,diff:ve})}w.current=!0}W()}},[s,W,b,x]),I=l.useCallback((D,Z)=>{const{clientX:ue}=Z;if(!e)if(C.current){const{node:le,x:de,id:Me}=C.current,ve=C.current.dx=ue-de,Te=Math.round(ve/le.offsetWidth*100);let Se=C.current.progress+Te;C.current.value=Se=Math.min(Math.max(0,Se),100),s.exec("update-task",{id:Me,task:{progress:Se},inProgress:!0})}else if(b){const{mode:le,l:de,w:Me,x:ve,id:Te,start:Se}=b,me=ue-ve;if(!Se&&Math.abs(me)<20||le==="start"&&Me-me<x||le==="end"&&Me+me<x||le=="move"&&(me<0&&de+me<0||me>0&&de+Me+me>_))return;const Be={...b,dx:me};let Ye,T;le==="start"?(Ye=de+me,T=Me-me):le==="end"?(Ye=de,T=Me+me):le==="move"&&(Ye=de+me,T=Me);let K={id:Te,width:T,left:Ye,inProgress:!0};s.exec("drag-task",K);const q=s.getTask(Te);if(!Be.start&&(le=="move"&&q.$x==de||le!="move"&&q.$w==Me)){w.current=!0,z();return}Be.start=!0,S(Be)}else{const le=Le(D);if(le){const de=V(le,Z);le.style.cursor=de&&!e?"col-resize":"pointer"}}},[s,e,b,x,_,V]),X=l.useCallback(D=>{I(D,D)},[I]),G=l.useCallback(D=>{k?(D.preventDefault(),I(D,D.touches[0])):N.current&&(clearTimeout(N.current),N.current=null)},[k,I]),ce=l.useCallback(()=>{z()},[z]),J=l.useCallback(()=>{j(null),N.current&&(clearTimeout(N.current),N.current=null),z()},[z]);l.useEffect(()=>(window.addEventListener("mouseup",ce),()=>{window.removeEventListener("mouseup",ce)}),[ce]);const se=l.useCallback(D=>{if(!e){const Z=Bt(D.target);Z&&!D.target.classList.contains("wx-link")&&s.exec("show-editor",{id:Z})}},[s,e]),F=["e2s","s2s","e2e","s2e"],A=l.useCallback((D,Z)=>F[(D?1:0)+(Z?0:2)],[]),B=l.useCallback((D,Z)=>{const ue=y.id,le=y.start;return D===ue?!0:!!a.find(de=>de.target==D&&de.source==ue&&de.type===A(le,Z))},[y,i,A]),Q=l.useCallback(()=>{y&&v(null)},[y]),te=l.useCallback(D=>{if(w.current){w.current=!1;return}const Z=Bt(D.target);if(Z){const ue=D.target.classList;if(ue.contains("wx-link")){const le=ue.contains("wx-left");if(!y){v({id:Z,start:le});return}y.id!==Z&&!B(Z,le)&&s.exec("add-link",{link:{source:y.id,target:Z,type:A(y.start,le)}})}else s.exec("select-task",{id:Z,toggle:D.ctrlKey||D.metaKey,range:D.shiftKey})}Q()},[s,y,i]),U=l.useCallback(D=>({left:`${D.$x}px`,top:`${D.$y}px`,width:`${D.$w}px`,height:`${D.$h}px`}),[]),we=l.useCallback(D=>({left:`${D.$x_base}px`,top:`${D.$y_base}px`,width:`${D.$w_base}px`,height:`${D.$h_base}px`}),[]),pe=l.useCallback(D=>{if(k||N.current)return D.preventDefault(),!1},[k]),be=l.useCallback(D=>{let Z=d.some(ue=>D===ue.id)?D:"task";return Z!=="task"&&Z!=="milestone"&&Z!=="summary"&&(Z=`task ${Z}`),Z},[d]),Ee=l.useCallback(D=>{s.exec(D.action,D.data)},[s]);return h.jsx("div",{className:"wx-GKbcLEGA wx-bars",style:{lineHeight:`${g.length?g[0].$h:0}px`},ref:M,onContextMenu:pe,onMouseDown:O,onMouseMove:X,onTouchStart:H,onTouchMove:G,onTouchEnd:J,onClick:te,onDoubleClick:se,onDragStart:D=>(D.preventDefault(),!1),children:g.map(D=>{if(D.$skip&&D.$skip_baseline)return null;const Z=`wx-bar wx-${be(D.type)}`+(k&&b&&D.id===b.id?" wx-touch":"")+(y&&y.id===D.id?" wx-selected":"")+(D.$reorder?" wx-reorder-task":""),ue="wx-link wx-left"+(y?" wx-visible":"")+(!y||!B(D.id,!0)?" wx-target":"")+(y&&y.id===D.id&&y.start?" wx-selected":""),le="wx-link wx-right"+(y?" wx-visible":"")+(!y||!B(D.id,!1)?" wx-target":"")+(y&&y.id===D.id&&!y.start?" wx-selected":"");return h.jsxs(l.Fragment,{children:[!D.$skip&&h.jsxs("div",{className:"wx-GKbcLEGA "+Z,style:U(D),"data-tooltip-id":D.id,"data-id":D.id,tabIndex:L===D.id?0:-1,children:[e?null:h.jsx("div",{className:"wx-GKbcLEGA "+ue,children:h.jsx("div",{className:"wx-GKbcLEGA wx-inner"})}),D.type!=="milestone"?h.jsxs(h.Fragment,{children:[D.progress?h.jsx("div",{className:"wx-GKbcLEGA wx-progress-wrapper",children:h.jsx("div",{className:"wx-GKbcLEGA wx-progress-percent",style:{width:`${D.progress}%`}})}):null,e?null:h.jsx("div",{className:"wx-GKbcLEGA wx-progress-marker",style:{left:`calc(${D.progress}% - 10px)`},children:D.progress}),n?h.jsx(n,{data:D,api:s,onAction:Ee}):h.jsx("div",{className:"wx-GKbcLEGA wx-content",children:D.text||""})]}):h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"wx-GKbcLEGA wx-content"}),n?h.jsx(n,{data:D,api:s,onAction:Ee}):h.jsx("div",{className:"wx-GKbcLEGA wx-text-out",children:D.text})]}),e?null:h.jsx("div",{className:"wx-GKbcLEGA "+le,children:h.jsx("div",{className:"wx-GKbcLEGA wx-inner"})})]}),f&&!D.$skip_baseline?h.jsx("div",{className:"wx-GKbcLEGA wx-baseline"+(D.type==="milestone"?" wx-milestone":""),style:we(D)}):null]},D.id)})})}function Rf(){const t=l.useContext(ot),e=ne(t,"_links");return h.jsx("svg",{className:"wx-dkx3NwEn wx-links",children:(e||[]).map(n=>h.jsx("polyline",{className:"wx-dkx3NwEn wx-line",points:n.$p},n.id))})}function Df(t){const{highlightTime:e}=t,n=l.useContext(ot),s=ne(n,"_scales"),r={width:`${(s&&s.width)!=null?s.width:0}px`};return h.jsx("div",{className:"wx-ZkvhDKir wx-scale",style:r,children:((s==null?void 0:s.rows)||[]).map((o,a)=>h.jsx("div",{className:"wx-ZkvhDKir wx-row",style:{height:`${o.height}px`},children:(o.cells||[]).map((i,c)=>{const u=e?e(i.date,i.unit):"",d=["wx-cell",i.css,u].filter(Boolean).join(" ");return h.jsx("div",{className:"wx-ZkvhDKir "+d,style:{width:`${i.width}px`},children:i.value},c)})},a))})}function If(t){var ee;const{readonly:e,fullWidth:n,fullHeight:s,taskTemplate:r,cellBorders:o,highlightTime:a}=t,i=l.useContext(ot),[c,u]=pn(i,"_selected"),d=ne(i,"scrollLeft"),f=ne(i,"scrollTop"),m=ne(i,"cellHeight"),p=ne(i,"cellWidth"),g=ne(i,"_scales"),x=ne(i,"_markers"),w=ne(i,"_scrollTask"),y=ne(i,"zoom"),[v,b]=l.useState(),S=l.useRef(null),C=1+(((ee=g==null?void 0:g.rows)==null?void 0:ee.length)||0),k=l.useMemo(()=>{const O=[];return c&&c.length&&m&&c.forEach(H=>{O.push({height:`${m}px`,top:`${H.$y-3}px`})}),O},[u,m]),j=l.useMemo(()=>Math.max(v||0,s),[v,s]);l.useEffect(()=>{const O=S.current;O&&typeof f=="number"&&(O.scrollTop=f)},[f]);const N=()=>{_()};function _(O){const H=S.current;if(!H)return;const z={};z.left=H.scrollLeft,i.exec("scroll-chart",z)}function $(){const O=S.current,H=Math.ceil((v||0)/(m||1))+1,z=Math.floor((O&&O.scrollTop||0)/(m||1)),I=Math.max(0,z-C),X=z+H+C,G=I*(m||0);i.exec("render-data",{start:I,end:X,from:G})}l.useEffect(()=>{$()},[v,f,d]);const M=l.useCallback(O=>{if(!O)return;const{id:H,mode:z}=O;if(z.toString().indexOf("x")<0)return;const I=S.current;if(!I)return;const{clientWidth:X}=I,G=i.getTask(H);if(G.$x+G.$w<I.scrollLeft)i.exec("scroll-chart",{left:G.$x-(p||0)}),I.scrollLeft=G.$x-(p||0);else if(G.$x>=X+I.scrollLeft){const ce=X<G.$w?p||0:G.$w;i.exec("scroll-chart",{left:G.$x-X+ce}),I.scrollLeft=G.$x-X+ce}},[i,p,d]);l.useEffect(()=>{M(w)},[w]);function E(O){if(y&&(O.ctrlKey||O.metaKey)){O.preventDefault();const H=S.current,z=-Math.sign(O.deltaY),I=O.clientX-(H?H.getBoundingClientRect().left:0);i.exec("zoom-scale",{dir:z,offset:I})}}function L(O){const H=a(O.date,O.unit);return H?{css:H,width:O.width}:null}const P=l.useMemo(()=>g&&(g.minUnit==="hour"||g.minUnit==="day")&&a?g.rows[g.rows.length-1].cells.map(L):null,[g,a]),W=l.useCallback(O=>{O.eventSource="chart",i.exec("hotkey",O)},[i]);l.useEffect(()=>{const O=S.current;if(!O)return;const H=()=>b(O.clientHeight);H();const z=new ResizeObserver(()=>H());return z.observe(O),()=>{z.disconnect()}},[S.current]);const V=l.useRef(null);return l.useEffect(()=>{const O=S.current;if(O&&!V.current)return V.current=js(O,{keys:{arrowup:!0,arrowdown:!0},exec:H=>W(H)}),()=>{var H;(H=V.current)==null||H.destroy(),V.current=null}},[]),l.useEffect(()=>{const O=S.current;if(!O)return;const H=E;return O.addEventListener("wheel",H),()=>{O.removeEventListener("wheel",H)}},[E]),h.jsxs("div",{className:"wx-mR7v2Xag wx-chart",tabIndex:-1,ref:S,onScroll:N,children:[h.jsx(Df,{highlightTime:a,scales:g}),x&&x.length?h.jsx("div",{className:"wx-mR7v2Xag wx-markers",style:{height:`${j}px`},children:x.map((O,H)=>h.jsx("div",{className:`wx-mR7v2Xag wx-marker ${O.css||"wx-default"}`,style:{left:`${O.left}px`},children:h.jsx("div",{className:"wx-mR7v2Xag wx-content",children:O.text})},H))}):null,h.jsxs("div",{className:"wx-mR7v2Xag wx-area",style:{width:`${n}px`,height:`${j}px`},children:[P?h.jsx("div",{className:"wx-mR7v2Xag wx-gantt-holidays",style:{height:"100%"},children:P.map((O,H)=>O?h.jsx("div",{className:"wx-mR7v2Xag "+O.css,style:{width:`${O.width}px`,left:`${H*O.width}px`}},H):null)}):null,h.jsx(Ef,{borders:o}),c&&c.length?c.map((O,H)=>O.$y?h.jsx("div",{className:"wx-mR7v2Xag wx-selected","data-id":O.id,style:k[H]},O.id):null):null,h.jsx(Rf,{}),h.jsx(Tf,{readonly:e,taskTemplate:r})]})]})}function Pf(t){const{position:e="after",size:n=4,dir:s="x",minValue:r=0,maxValue:o=0,onMove:a,onDisplayChange:i,compactMode:c}=t,[u,d]=ke(t.value??0),[f,m]=ke(t.display??"all");function p(M){let E=0;e=="center"?E=n/2:e=="before"&&(E=n);const L={size:[n+"px","auto"],p:[M-E+"px","0px"],p2:["auto","0px"]};if(s!="x")for(let P in L)L[P]=L[P].reverse();return L}const[g,x]=l.useState(!1),w=l.useRef(0),y=l.useRef();function v(M){return s=="x"?M.clientX:M.clientY}const b=l.useCallback(M=>{const E=y.current+v(M)-w.current;(!r||r<=E)&&(!o||o>=E)&&(d(E),a(E))},[]),S=l.useCallback(()=>{document.body.style.cursor="",document.body.style.userSelect="",x(!1),window.removeEventListener("mousemove",b),window.removeEventListener("mouseup",S)},[b]),C=l.useMemo(()=>f!=="all"?"auto":s=="x"?"ew-resize":"ns-resize",[f,s]),k=l.useCallback(M=>{w.current=v(M),y.current=u,x(!0),document.body.style.cursor=C,document.body.style.userSelect="none",window.addEventListener("mousemove",b),window.addEventListener("mouseup",S)},[C,b,S,u]);function j(){let M;c?M=f==="chart"?"grid":"chart":M=f==="all"?"chart":"all",m(M),i(M)}function N(){let M;c?M=f==="grid"?"chart":"grid":M=f==="all"?"grid":"all",m(M),i(M)}const _=l.useMemo(()=>p(u),[u,e,n,s]),$=["wx-resizer",`wx-resizer-${s}`,`wx-resizer-display-${f}`,g?"wx-resizer-active":""].filter(Boolean).join(" ");return h.jsxs("div",{className:"wx-pFykzMlT "+$,onMouseDown:k,style:{width:_.size[0],height:_.size[1],cursor:C},children:[h.jsxs("div",{className:"wx-pFykzMlT wx-button-expand-box",children:[h.jsx("div",{className:"wx-pFykzMlT wx-button-expand-content wx-button-expand-left",children:h.jsx("i",{className:"wx-pFykzMlT wxi-menu-left",onClick:j})}),h.jsx("div",{className:"wx-pFykzMlT wx-button-expand-content wx-button-expand-right",children:h.jsx("i",{className:"wx-pFykzMlT wxi-menu-right",onClick:N})})]}),h.jsx("div",{className:"wx-pFykzMlT wx-resizer-line"})]})}const Af=650;function Ro(t){let e;function n(){e=new ResizeObserver(r=>{for(let o of r)if(o.target===document.body){let a=o.contentRect.width<=Af;t(a)}}),e.observe(document.body)}function s(){e&&(e.disconnect(),e=null)}return{observe:n,disconnect:s}}function Lf(t){const{taskTemplate:e,readonly:n,cellBorders:s,highlightTime:r,onTableAPIChange:o}=t,a=l.useContext(ot),i=ne(a,"_tasks"),c=ne(a,"_scales"),u=ne(a,"cellHeight"),d=ne(a,"columns"),f=ne(a,"_scrollTask"),[m,p]=l.useState(!1);let[g,x]=l.useState(0);const[w,y]=l.useState(void 0),[v,b]=l.useState(void 0),[S,C]=l.useState(void 0),[k,j]=l.useState("all"),N=l.useRef(null),_=l.useCallback(J=>{p(se=>(J!==se&&(J?(N.current=k,k==="all"&&j("grid")):(!N.current||N.current==="all")&&j("all")),J))},[k]);l.useEffect(()=>{const J=Ro(_);return J.observe(),()=>{J.disconnect()}},[_]);const $=l.useMemo(()=>{var se;let J;return d.every(F=>F.width&&!F.flexgrow)?J=d.reduce((F,A)=>F+parseInt(A.width),0):m&&k==="chart"?J=parseInt((se=d.find(F=>F.id==="action"))==null?void 0:se.width)||50:J=440,g=J,J},[d,m,k]);l.useEffect(()=>{x($)},[$]);const M=l.useMemo(()=>(w??0)-(S??0),[w,S]),E=l.useMemo(()=>c.width,[c]),L=l.useMemo(()=>i.length*u,[i,u]),P=l.useMemo(()=>c.height+L+M,[c,L,M]),W=l.useMemo(()=>g+E,[g,E]),V=l.useRef(null),ee=l.useCallback(()=>{Promise.resolve().then(()=>{if((w??0)>(W??0)){const J=(w??0)-g;a.exec("expand-scale",{minWidth:J})}})},[w,W,g,a]);l.useEffect(()=>{let J;return V.current&&(J=new ResizeObserver(ee),J.observe(V.current)),()=>{J&&J.disconnect()}},[V.current,ee]);const O=l.useRef(null),H=l.useRef(null),z=l.useCallback(()=>{const J=O.current;J&&a.exec("scroll-chart",{top:J.scrollTop})},[a]),I=l.useRef({rTasks:[],rScales:{height:0},rCellHeight:0,scrollSize:0,ganttDiv:null,ganttHeight:0});l.useEffect(()=>{I.current={rTasks:i,rScales:c,rCellHeight:u,scrollSize:M,ganttDiv:O.current,ganttHeight:v??0}},[i,c,u,M,v]);const X=l.useCallback(J=>{if(!J)return;const{rTasks:se,rScales:F,rCellHeight:A,scrollSize:B,ganttDiv:Q,ganttHeight:te}=I.current;if(!Q)return;const{id:U}=J,we=se.findIndex(pe=>pe.id===U);if(we>-1){const pe=te-F.height,be=we*A,Ee=Q.scrollTop;let D=null;be<Ee?D=be:be+A>Ee+pe&&(D=be-pe+A+B),D!==null&&(a.exec("scroll-chart",{top:Math.max(D,0)}),O.current.scrollTop=Math.max(D,0))}},[a]);l.useEffect(()=>{X(f)},[f]),l.useEffect(()=>{const J=O.current;if(!J)return;const se=()=>{b(J.offsetHeight),y(J.offsetWidth)};se();const F=new ResizeObserver(se);return F.observe(J),()=>F.disconnect()},[O.current]),l.useEffect(()=>{const J=H.current;if(!J)return;const se=()=>{C(J.offsetWidth)};se();const F=new ResizeObserver(se);return F.observe(J),()=>F.disconnect()},[H.current]);const G=l.useRef(null),ce=l.useRef(null);return l.useEffect(()=>{if(ce.current)return;const J=G.current;if(J)return ce.current=js(J,{keys:{"ctrl+c":!0,"ctrl+v":!0,"ctrl+x":!0,"ctrl+d":!0,backspace:!0},exec:se=>{se.isInput||a.exec("hotkey",se)}}),()=>{var se;(se=ce.current)==null||se.destroy(),ce.current=null}},[]),h.jsx("div",{className:"wx-jlbQoHOz wx-gantt",ref:O,onScroll:z,children:h.jsx("div",{className:"wx-jlbQoHOz wx-pseudo-rows",style:{height:P,width:"100%"},ref:H,children:h.jsx("div",{className:"wx-jlbQoHOz wx-stuck",style:{height:v,width:S},children:h.jsxs("div",{tabIndex:0,className:"wx-jlbQoHOz wx-layout",ref:G,children:[d.length?h.jsxs(h.Fragment,{children:[h.jsx(Nf,{display:k,compactMode:m,columnWidth:$,width:g,readonly:n,fullHeight:L,onTableAPIChange:o}),h.jsx(Pf,{value:g,display:k,compactMode:m,minValue:"50",maxValue:"800",onMove:J=>x(J),onDisplayChange:J=>j(J)})]}):null,h.jsx("div",{className:"wx-jlbQoHOz wx-content",ref:V,children:h.jsx(If,{readonly:n,fullWidth:E,fullHeight:L,taskTemplate:e,cellBorders:s,highlightTime:r})})]})})})})}const Hf=t=>t.split("-").map(e=>e?e.charAt(0).toUpperCase()+e.slice(1):"").join(""),Of=[{unit:"month",step:1,format:"MMMM yyy"},{unit:"day",step:1,format:"d"}],Wf=l.forwardRef(function({taskTemplate:t=null,markers:e=[],taskTypes:n=_u,tasks:s=[],selected:r=[],activeTask:o=null,links:a=[],scales:i=Of,columns:c=du,start:u=null,end:d=null,lengthUnit:f="day",durationUnit:m="day",cellWidth:p=100,cellHeight:g=38,scaleHeight:x=36,readonly:w=!1,cellBorders:y="full",zoom:v=!1,baselines:b=!1,highlightTime:S=null,init:C=null,autoScale:k=!0,unscheduledTasks:j=!1,...N},_){const $=l.useRef();$.current=N;const M=l.useMemo(()=>new gu(Ar),[]),E=l.useMemo(()=>M.in,[M]),L=l.useRef(null);L.current===null&&(L.current=new Fr((H,z)=>{const I="on"+Hf(H);$.current&&$.current[I]&&$.current[I](z)}),E.setNext(L.current));const[P,W]=l.useState(null),V=l.useRef(null);V.current=P;const ee=l.useMemo(()=>({getState:M.getState.bind(M),getReactiveState:M.getReactive.bind(M),getStores:()=>({data:M}),exec:E.exec,setNext:H=>(L.current=L.current.setNext(H),L.current),intercept:E.intercept.bind(E),on:E.on.bind(E),detach:E.detach.bind(E),getTask:M.getTask.bind(M),serialize:M.serialize.bind(M),getTable:H=>H?new Promise(z=>setTimeout(()=>z(V.current),1)):V.current}),[M,E]);l.useImperativeHandle(_,()=>({...ee}),[ee]);const O=l.useRef(0);return l.useEffect(()=>{O.current?M.init({tasks:s,links:a,start:u,columns:c,end:d,lengthUnit:f,cellWidth:p,cellHeight:g,scaleHeight:x,scales:i,taskTypes:n,zoom:v,selected:r,activeTask:o,baselines:b,autoScale:k,unscheduledTasks:j,markers:e,durationUnit:m}):C&&C(ee),O.current++},[s,a,u,c,d,f,p,g,x,i,n,v,r,o,b,k,j,e,m]),O.current===0&&M.init({tasks:s,links:a,start:u,columns:c,end:d,lengthUnit:f,cellWidth:p,cellHeight:g,scaleHeight:x,scales:i,taskTypes:n,zoom:v,selected:r,activeTask:o,baselines:b,autoScale:k,unscheduledTasks:j,markers:e,durationUnit:m}),h.jsx(Xt,{words:Cn,optional:!0,children:h.jsx(ot.Provider,{value:ee,children:h.jsx(Lf,{taskTemplate:t,readonly:w,cellBorders:y,highlightTime:S,onTableAPIChange:W})})})});function zf({api:t=null,items:e=[...es]}){const n=l.useContext(He.i18n),s=l.useMemo(()=>n||Nt(Cn),[n]),r=l.useMemo(()=>s.getGroup("gantt"),[s]),o=yt(t,"_selected"),a=yt(t,"_tasks"),i=l.useMemo(()=>e.map(u=>{let d={...u,disabled:!1};return d.handler=ks(es,d.id)?f=>bt(t,f.id,null,r):d.handler,d.text&&(d.text=r(d.text)),d.menuText&&(d.menuText=r(d.menuText)),d}),[e,t,r]),c=l.useMemo(()=>t&&(o!=null&&o.length)?i.map(u=>{if(!u.check)return u;const d=o.some(f=>!u.check(f,a));return{...u,disabled:d}}):[{...i[0],disabled:!1}],[t,o,a,i]);return n?h.jsx(ss,{items:c}):h.jsx(He.i18n.Provider,{value:s,children:h.jsx(ss,{items:c})})}l.forwardRef(function({options:t,api:e=null,resolver:n=null,filter:s=null,at:r="point",children:o,onClick:a,css:i},c){var L;const u=l.useMemo(()=>t??[...ir],[t]),[d]=ke(u),f=l.useRef(null),m=l.useRef(null),p=l.useContext(He.i18n),g=l.useMemo(()=>p||Nt({...Cn,...bn}),[p]),x=l.useMemo(()=>g.getGroup("gantt"),[g]),w=yt(e,"taskTypes"),y=yt(e,"_tasks"),v=yt(e,"selected"),b=yt(e,"_selected");l.useEffect(()=>{e&&(e.on("scroll-chart",()=>{f.current&&f.current.show&&f.current.show()}),e.on("drag-task",()=>{f.current&&f.current.show&&f.current.show()}))},[e]);function S(P){return P.map(W=>(W={...W},W.text&&(W.text=x(W.text)),W.subtext&&(W.subtext=x(W.subtext)),W.data&&(W.data=S(W.data)),W))}function C(){const P=d.find(W=>W.id==="convert-task");return P&&(P.data=[],(w||[]).forEach(W=>{P.data.push(P.dataFactory(W))})),S(d)}const k=l.useMemo(()=>e?C():null,[e,d,w,x]),j=l.useMemo(()=>b&&b.length?b:[],[b]),N=l.useCallback((P,W)=>{let V=P?e==null?void 0:e.getTask(P):null;if(n){const ee=n(P,W);V=ee===!0?V:ee}return V&&(m.current=V.id,(!Array.isArray(v)||!v.includes(V.id))&&e&&e.exec&&e.exec("select-task",{id:V.id})),V},[e,n,v]),_=l.useCallback(P=>{const W=P.action;W&&(ks(ir,W.id)&&bt(e,W.id,m.current,x),a&&a(P))},[e,x,a]),$=l.useCallback((P,W)=>{const V=j.length?j:W?[W]:[];let ee=s?s(P,W):!0;if(P.check&&ee){const O=V.some(H=>!P.check(H,y));P.css=O?"wx-disabled":""}return ee},[s,j,y]);l.useImperativeHandle(c,()=>({show:(P,W)=>{f.current&&f.current.show&&f.current.show(P,W)}}));const M=l.useCallback(P=>{f.current&&f.current.show&&f.current.show(P)},[]),E=h.jsxs(h.Fragment,{children:[h.jsx(gd,{filter:$,options:k,dataKey:"id",resolver:N,onClick:_,at:r,ref:f,css:i}),h.jsx("span",{onContextMenu:M,"data-menu-ignore":"true",children:typeof o=="function"?o():o})]});if(!p&&((L=He.i18n)!=null&&L.Provider)){const P=He.i18n.Provider;return h.jsx(P,{value:g,children:E})}return E});function Ff({api:t,autoSave:e,onLinksChange:n}){const s=l.useContext(He.i18n).getGroup("gantt"),r=ne(t,"activeTask"),o=ne(t,"_links"),[a,i]=l.useState();function c(){if(r){const m=o.filter(g=>g.target==r).map(g=>({link:g,task:t.getTask(g.source)})),p=o.filter(g=>g.source==r).map(g=>({link:g,task:t.getTask(g.target)}));return[{title:s("Predecessors"),data:m},{title:s("Successors"),data:p}]}}l.useEffect(()=>{i(c())},[r,o]);const u=l.useMemo(()=>[{id:"e2s",label:s("End-to-start")},{id:"s2s",label:s("Start-to-start")},{id:"e2e",label:s("End-to-end")},{id:"s2e",label:s("Start-to-end")}],[s]);function d(m){e?t.exec("delete-link",{id:m}):(i(p=>(p||[]).map(g=>({...g,data:g.data.filter(x=>x.link.id!==m)}))),n&&n({id:m,action:"delete-link",data:{id:m}}))}function f(m,p){const g=m.value;e?t.exec("update-link",{id:p,link:{type:g}}):(i(x=>(x||[]).map(w=>({...w,data:w.data.map(y=>y.link.id===p?{...y,link:{...y.link,type:g}}:y)}))),n&&n({id:p,action:"update-link",data:{id:p,link:{type:g}}}))}return h.jsx(h.Fragment,{children:(a||[]).map((m,p)=>m.data.length?h.jsx("div",{className:"wx-j93aYGQf wx-links",children:h.jsx(Yt,{label:m.title,position:"top",children:h.jsx("table",{children:h.jsx("tbody",{children:m.data.map(g=>h.jsxs("tr",{children:[h.jsx("td",{className:"wx-j93aYGQf wx-cell",children:h.jsx("div",{className:"wx-j93aYGQf wx-task-name",children:g.task.text||""})}),h.jsx("td",{className:"wx-j93aYGQf wx-cell",children:h.jsx("div",{className:"wx-j93aYGQf wx-wrapper",children:h.jsx(Ei,{value:g.link.type,placeholder:s("Select link type"),options:u,onChange:x=>f(x,g.link.id),children:({option:x})=>x.label})})}),h.jsx("td",{className:"wx-j93aYGQf wx-cell",children:h.jsx("i",{className:"wx-j93aYGQf wxi-delete wx-delete-icon",onClick:()=>d(g.link.id),role:"button"})})]},g.link.id))})})})},p):null)})}function Vf(t){const{value:e,time:n,format:s,onchange:r,onChange:o,...a}=t,i=o??r;function c(u){const d=new Date(u.value);d.setHours(e.getHours()),d.setMinutes(e.getMinutes()),i&&i({value:d})}return h.jsxs("div",{className:"wx-hFsbgDln date-time-controll",children:[h.jsx(Gi,{...a,value:e,onChange:c,format:s,buttons:["today"],clear:!1}),n?h.jsx(Ji,{value:e,onChange:i,format:s}):null]})}Ve("select",Or);Ve("date",Vf);Ve("twostate",Wr);Ve("slider",Gn);Ve("counter",Ui);Ve("links",Ff);function Bf({api:t,items:e=Mu,css:n="",layout:s="default",readonly:r=!1,placement:o="sidebar",bottomBar:a=!0,topBar:i=!0,autoSave:c=!0,focus:u=!1}){const d=l.useContext(He.i18n),f=l.useMemo(()=>d||Nt({...Cn,...bn}),[d]),m=l.useMemo(()=>f.getGroup("gantt"),[f]),p=f.getRaw(),g=l.useMemo(()=>{var B,Q;const A=((B=p.gantt)==null?void 0:B.dateFormat)||((Q=p.formats)==null?void 0:Q.dateFormat);return St(A,p.calendar)},[p]),x=l.useMemo(()=>{if(i===!0&&!r){const A=[{comp:"icon",icon:"wxi-close",id:"close"},{comp:"spacer"},{comp:"button",type:"danger",text:m("Delete"),id:"delete"}];return c?{items:A}:{items:[...A,{comp:"button",type:"primary",text:m("Save"),id:"save"}]}}return i},[i,r,c,m]),[w,y]=l.useState(!1),v=l.useMemo(()=>w?"wx-full-screen":"",[w]),b=l.useCallback(A=>{y(A)},[]);l.useEffect(()=>{const A=Ro(b);return A.observe(),()=>{A.disconnect()}},[b]);const S=ne(t,"_activeTask"),C=l.useMemo(()=>S==null?void 0:S.id,[S]),k=ne(t,"durationUnit"),j=ne(t,"unscheduledTasks"),N=ne(t,"taskTypes"),[_,$]=ke(S==null?void 0:S.type),M=l.useMemo(()=>S==null?void 0:S.unscheduled,[S]),[E,L]=l.useState({});l.useEffect(()=>{L({})},[C]);const P=l.useMemo(()=>_==="milestone",[_]),W=l.useMemo(()=>_==="summary",[_]);function V(A,B){const Q={start:1,end:1,duration:1};return A.map(te=>{var we;const U={...te};if(te.config&&(U.config={...U.config}),U.comp==="links"&&t&&(U.api=t,U.autoSave=c,U.onLinksChange=z),U.comp==="select"&&U.key==="type"){let pe=U.options??(N||[]);U.options=pe.map(be=>({...be,label:m(be.label)}))}return U.comp==="slider"&&U.key==="progress"&&(U.labelTemplate=pe=>`${m(U.label)} ${pe}%`),U.label&&(U.label=m(U.label)),(we=U.config)!=null&&we.placeholder&&(U.config.placeholder=m(U.config.placeholder)),j&&Q[U.key]&&(B?U.disabled=!0:delete U.disabled),U})}function ee(A){return A.filter(({comp:B,key:Q,options:te})=>{switch(B){case"date":return(!P||Q!=="end"&&Q!=="base_end")&&!W;case"select":return te.length>1;case"twostate":return j&&!W;case"counter":return!W&&!P;case"slider":return!P;default:return!0}})}const O=l.useMemo(()=>{const A=V(e,M);return ee(A)},[e,M,P,W,j,N,m,t,c]),H=l.useMemo(()=>{if(r&&S){let A={};return O.forEach(({key:B,comp:Q})=>{if(Q!=="links"){const te=S[B];Q==="date"&&te instanceof Date?A[B]=g(te):Q==="slider"&&B==="progress"?A[B]=`${te}%`:A[B]=te}}),A}return S?{...S}:null},[r,S,O,g]);function z({id:A,action:B,data:Q}){L(te=>({...te,[A]:{action:B,data:Q}}))}const I=l.useCallback(()=>{for(let A in E){const{action:B,data:Q}=E[A];t.exec(B,Q)}},[t,E]),X=l.useCallback(()=>{t.exec("delete-task",{id:C})},[t,C]),G=l.useCallback(()=>{t.exec("show-editor",{id:null})},[t]),ce=l.useCallback(A=>{const{item:B,changes:Q}=A;B.id==="delete"&&X(),B.id==="save"&&(Q.length?G():I()),B.comp&&G()},[t,C,c,I,X,G]),J=l.useCallback((A,B)=>(j&&A.type==="summary"&&(A.unscheduled=!1),Kt(A,k,!0,B),A),[j,k]),se=l.useCallback(A=>{let{update:B,key:Q,value:te}=A;A.update=J({...B},Q),c||Q==="type"&&$(te)},[t,c]),F=l.useCallback(A=>{let{values:B}=A;B={...B,unscheduled:j&&B.unscheduled&&B.type!=="summary"},delete B.links,delete B.data,t.exec("update-task",{id:C,task:B}),c||I()},[t,C,j,c,I]);return H?h.jsx(Xt,{children:h.jsx(Sf,{css:`wx-XkvqDXuw wx-gantt-editor ${v} ${n}`,items:O,values:H,topBar:x,bottomBar:a,placement:o,layout:s,readonly:r,autoSave:c,focus:u,onAction:ce,onSave:F,onChange:se})}):null}function Yf({fonts:t=!0,children:e}){return e?h.jsx(Us,{fonts:t,children:e}):h.jsx(Us,{fonts:t})}const Gf="/assets/index.css";function _r(t,[e,n]){return Math.min(n,Math.max(e,t))}function Uf(t){const e=Kf(t),n=l.forwardRef((s,r)=>{const{children:o,...a}=s,i=l.Children.toArray(o),c=i.find(Qf);if(c){const u=c.props.children,d=i.map(f=>f===c?l.Children.count(u)>1?l.Children.only(null):l.isValidElement(u)?u.props.children:null:f);return h.jsx(e,{...a,ref:r,children:l.isValidElement(u)?l.cloneElement(u,void 0,d):null})}return h.jsx(e,{...a,ref:r,children:o})});return n.displayName=`${t}.Slot`,n}function Kf(t){const e=l.forwardRef((n,s)=>{const{children:r,...o}=n;if(l.isValidElement(r)){const a=Jf(r),i=Xf(o,r.props);return r.type!==l.Fragment&&(i.ref=s?Ia(s,a):a),l.cloneElement(r,i)}return l.Children.count(r)>1?l.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var qf=Symbol("radix.slottable");function Qf(t){return l.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===qf}function Xf(t,e){const n={...e};for(const s in e){const r=t[s],o=e[s];/^on[A-Z]/.test(s)?r&&o?n[s]=(...i)=>{const c=o(...i);return r(...i),c}:r&&(n[s]=r):s==="style"?n[s]={...r,...o}:s==="className"&&(n[s]=[r,o].filter(Boolean).join(" "))}return{...t,...n}}function Jf(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var Do=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Zf="VisuallyHidden",eh=l.forwardRef((t,e)=>h.jsx(Ae.span,{...t,ref:e,style:{...Do,...t.style}}));eh.displayName=Zf;var th=[" ","Enter","ArrowUp","ArrowDown"],nh=[" ","Enter"],pt="Select",[En,Tn,sh]=Da(pt),[Dt]=Ea(pt,[sh,Er]),Rn=Er(),[rh,at]=Dt(pt),[oh,ah]=Dt(pt),Io=t=>{const{__scopeSelect:e,children:n,open:s,defaultOpen:r,onOpenChange:o,value:a,defaultValue:i,onValueChange:c,dir:u,name:d,autoComplete:f,disabled:m,required:p,form:g}=t,x=Rn(e),[w,y]=l.useState(null),[v,b]=l.useState(null),[S,C]=l.useState(!1),k=Ra(u),[j,N]=Is({prop:s,defaultProp:r??!1,onChange:o,caller:pt}),[_,$]=Is({prop:a,defaultProp:i,onChange:c,caller:pt}),M=l.useRef(null),E=w?g||!!w.closest("form"):!0,[L,P]=l.useState(new Set),W=Array.from(L).map(V=>V.props.value).join(";");return h.jsx(za,{...x,children:h.jsxs(rh,{required:p,scope:e,trigger:w,onTriggerChange:y,valueNode:v,onValueNodeChange:b,valueNodeHasChildren:S,onValueNodeHasChildrenChange:C,contentId:ds(),value:_,onValueChange:$,open:j,onOpenChange:N,dir:k,triggerPointerDownPosRef:M,disabled:m,children:[h.jsx(En.Provider,{scope:e,children:h.jsx(oh,{scope:t.__scopeSelect,onNativeOptionAdd:l.useCallback(V=>{P(ee=>new Set(ee).add(V))},[]),onNativeOptionRemove:l.useCallback(V=>{P(ee=>{const O=new Set(ee);return O.delete(V),O})},[]),children:n})}),E?h.jsxs(ra,{"aria-hidden":!0,required:p,tabIndex:-1,name:d,autoComplete:f,value:_,onChange:V=>$(V.target.value),disabled:m,form:g,children:[_===void 0?h.jsx("option",{value:""}):null,Array.from(L)]},W):null]})})};Io.displayName=pt;var Po="SelectTrigger",Ao=l.forwardRef((t,e)=>{const{__scopeSelect:n,disabled:s=!1,...r}=t,o=Rn(n),a=at(Po,n),i=a.disabled||s,c=qe(e,a.onTriggerChange),u=Tn(n),d=l.useRef("touch"),[f,m,p]=aa(x=>{const w=u().filter(b=>!b.disabled),y=w.find(b=>b.value===a.value),v=ia(w,x,y);v!==void 0&&a.onValueChange(v.value)}),g=x=>{i||(a.onOpenChange(!0),p()),x&&(a.triggerPointerDownPosRef.current={x:Math.round(x.pageX),y:Math.round(x.pageY)})};return h.jsx(Fa,{asChild:!0,...o,children:h.jsx(Ae.button,{type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:i,"data-disabled":i?"":void 0,"data-placeholder":oa(a.value)?"":void 0,...r,ref:c,onClick:Ne(r.onClick,x=>{x.currentTarget.focus(),d.current!=="mouse"&&g(x)}),onPointerDown:Ne(r.onPointerDown,x=>{d.current=x.pointerType;const w=x.target;w.hasPointerCapture(x.pointerId)&&w.releasePointerCapture(x.pointerId),x.button===0&&x.ctrlKey===!1&&x.pointerType==="mouse"&&(g(x),x.preventDefault())}),onKeyDown:Ne(r.onKeyDown,x=>{const w=f.current!=="";!(x.ctrlKey||x.altKey||x.metaKey)&&x.key.length===1&&m(x.key),!(w&&x.key===" ")&&th.includes(x.key)&&(g(),x.preventDefault())})})})});Ao.displayName=Po;var Lo="SelectValue",Ho=l.forwardRef((t,e)=>{const{__scopeSelect:n,className:s,style:r,children:o,placeholder:a="",...i}=t,c=at(Lo,n),{onValueNodeHasChildrenChange:u}=c,d=o!==void 0,f=qe(e,c.onValueNodeChange);return st(()=>{u(d)},[u,d]),h.jsx(Ae.span,{...i,ref:f,style:{pointerEvents:"none"},children:oa(c.value)?h.jsx(h.Fragment,{children:a}):o})});Ho.displayName=Lo;var ih="SelectIcon",Oo=l.forwardRef((t,e)=>{const{__scopeSelect:n,children:s,...r}=t;return h.jsx(Ae.span,{"aria-hidden":!0,...r,ref:e,children:s||"â¼"})});Oo.displayName=ih;var lh="SelectPortal",Wo=t=>h.jsx(Pa,{asChild:!0,...t});Wo.displayName=lh;var mt="SelectContent",zo=l.forwardRef((t,e)=>{const n=at(mt,t.__scopeSelect),[s,r]=l.useState();if(st(()=>{r(new DocumentFragment)},[]),!n.open){const o=s;return o?us.createPortal(h.jsx(Fo,{scope:t.__scopeSelect,children:h.jsx(En.Slot,{scope:t.__scopeSelect,children:h.jsx("div",{children:t.children})})}),o):null}return h.jsx(Vo,{...t,ref:e})});zo.displayName=mt;var Fe=10,[Fo,it]=Dt(mt),ch="SelectContentImpl",uh=Uf("SelectContent.RemoveScroll"),Vo=l.forwardRef((t,e)=>{const{__scopeSelect:n,position:s="item-aligned",onCloseAutoFocus:r,onEscapeKeyDown:o,onPointerDownOutside:a,side:i,sideOffset:c,align:u,alignOffset:d,arrowPadding:f,collisionBoundary:m,collisionPadding:p,sticky:g,hideWhenDetached:x,avoidCollisions:w,...y}=t,v=at(mt,n),[b,S]=l.useState(null),[C,k]=l.useState(null),j=qe(e,F=>S(F)),[N,_]=l.useState(null),[$,M]=l.useState(null),E=Tn(n),[L,P]=l.useState(!1),W=l.useRef(!1);l.useEffect(()=>{if(b)return Aa(b)},[b]),La();const V=l.useCallback(F=>{const[A,...B]=E().map(U=>U.ref.current),[Q]=B.slice(-1),te=document.activeElement;for(const U of F)if(U===te||(U==null||U.scrollIntoView({block:"nearest"}),U===A&&C&&(C.scrollTop=0),U===Q&&C&&(C.scrollTop=C.scrollHeight),U==null||U.focus(),document.activeElement!==te))return},[E,C]),ee=l.useCallback(()=>V([N,b]),[V,N,b]);l.useEffect(()=>{L&&ee()},[L,ee]);const{onOpenChange:O,triggerPointerDownPosRef:H}=v;l.useEffect(()=>{if(b){let F={x:0,y:0};const A=Q=>{var te,U;F={x:Math.abs(Math.round(Q.pageX)-(((te=H.current)==null?void 0:te.x)??0)),y:Math.abs(Math.round(Q.pageY)-(((U=H.current)==null?void 0:U.y)??0))}},B=Q=>{F.x<=10&&F.y<=10?Q.preventDefault():b.contains(Q.target)||O(!1),document.removeEventListener("pointermove",A),H.current=null};return H.current!==null&&(document.addEventListener("pointermove",A),document.addEventListener("pointerup",B,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",A),document.removeEventListener("pointerup",B,{capture:!0})}}},[b,O,H]),l.useEffect(()=>{const F=()=>O(!1);return window.addEventListener("blur",F),window.addEventListener("resize",F),()=>{window.removeEventListener("blur",F),window.removeEventListener("resize",F)}},[O]);const[z,I]=aa(F=>{const A=E().filter(te=>!te.disabled),B=A.find(te=>te.ref.current===document.activeElement),Q=ia(A,F,B);Q&&setTimeout(()=>Q.ref.current.focus())}),X=l.useCallback((F,A,B)=>{const Q=!W.current&&!B;(v.value!==void 0&&v.value===A||Q)&&(_(F),Q&&(W.current=!0))},[v.value]),G=l.useCallback(()=>b==null?void 0:b.focus(),[b]),ce=l.useCallback((F,A,B)=>{const Q=!W.current&&!B;(v.value!==void 0&&v.value===A||Q)&&M(F)},[v.value]),J=s==="popper"?os:Bo,se=J===os?{side:i,sideOffset:c,align:u,alignOffset:d,arrowPadding:f,collisionBoundary:m,collisionPadding:p,sticky:g,hideWhenDetached:x,avoidCollisions:w}:{};return h.jsx(Fo,{scope:n,content:b,viewport:C,onViewportChange:k,itemRefCallback:X,selectedItem:N,onItemLeave:G,itemTextRefCallback:ce,focusSelectedItem:ee,selectedItemText:$,position:s,isPositioned:L,searchRef:z,children:h.jsx(Ha,{as:uh,allowPinchZoom:!0,children:h.jsx(Oa,{asChild:!0,trapped:v.open,onMountAutoFocus:F=>{F.preventDefault()},onUnmountAutoFocus:Ne(r,F=>{var A;(A=v.trigger)==null||A.focus({preventScroll:!0}),F.preventDefault()}),children:h.jsx(Wa,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:a,onFocusOutside:F=>F.preventDefault(),onDismiss:()=>v.onOpenChange(!1),children:h.jsx(J,{role:"listbox",id:v.contentId,"data-state":v.open?"open":"closed",dir:v.dir,onContextMenu:F=>F.preventDefault(),...y,...se,onPlaced:()=>P(!0),ref:j,style:{display:"flex",flexDirection:"column",outline:"none",...y.style},onKeyDown:Ne(y.onKeyDown,F=>{const A=F.ctrlKey||F.altKey||F.metaKey;if(F.key==="Tab"&&F.preventDefault(),!A&&F.key.length===1&&I(F.key),["ArrowUp","ArrowDown","Home","End"].includes(F.key)){let Q=E().filter(te=>!te.disabled).map(te=>te.ref.current);if(["ArrowUp","End"].includes(F.key)&&(Q=Q.slice().reverse()),["ArrowUp","ArrowDown"].includes(F.key)){const te=F.target,U=Q.indexOf(te);Q=Q.slice(U+1)}setTimeout(()=>V(Q)),F.preventDefault()}})})})})})})});Vo.displayName=ch;var dh="SelectItemAlignedPosition",Bo=l.forwardRef((t,e)=>{const{__scopeSelect:n,onPlaced:s,...r}=t,o=at(mt,n),a=it(mt,n),[i,c]=l.useState(null),[u,d]=l.useState(null),f=qe(e,j=>d(j)),m=Tn(n),p=l.useRef(!1),g=l.useRef(!0),{viewport:x,selectedItem:w,selectedItemText:y,focusSelectedItem:v}=a,b=l.useCallback(()=>{if(o.trigger&&o.valueNode&&i&&u&&x&&w&&y){const j=o.trigger.getBoundingClientRect(),N=u.getBoundingClientRect(),_=o.valueNode.getBoundingClientRect(),$=y.getBoundingClientRect();if(o.dir!=="rtl"){const te=$.left-N.left,U=_.left-te,we=j.left-U,pe=j.width+we,be=Math.max(pe,N.width),Ee=window.innerWidth-Fe,D=_r(U,[Fe,Math.max(Fe,Ee-be)]);i.style.minWidth=pe+"px",i.style.left=D+"px"}else{const te=N.right-$.right,U=window.innerWidth-_.right-te,we=window.innerWidth-j.right-U,pe=j.width+we,be=Math.max(pe,N.width),Ee=window.innerWidth-Fe,D=_r(U,[Fe,Math.max(Fe,Ee-be)]);i.style.minWidth=pe+"px",i.style.right=D+"px"}const M=m(),E=window.innerHeight-Fe*2,L=x.scrollHeight,P=window.getComputedStyle(u),W=parseInt(P.borderTopWidth,10),V=parseInt(P.paddingTop,10),ee=parseInt(P.borderBottomWidth,10),O=parseInt(P.paddingBottom,10),H=W+V+L+O+ee,z=Math.min(w.offsetHeight*5,H),I=window.getComputedStyle(x),X=parseInt(I.paddingTop,10),G=parseInt(I.paddingBottom,10),ce=j.top+j.height/2-Fe,J=E-ce,se=w.offsetHeight/2,F=w.offsetTop+se,A=W+V+F,B=H-A;if(A<=ce){const te=M.length>0&&w===M[M.length-1].ref.current;i.style.bottom="0px";const U=u.clientHeight-x.offsetTop-x.offsetHeight,we=Math.max(J,se+(te?G:0)+U+ee),pe=A+we;i.style.height=pe+"px"}else{const te=M.length>0&&w===M[0].ref.current;i.style.top="0px";const we=Math.max(ce,W+x.offsetTop+(te?X:0)+se)+B;i.style.height=we+"px",x.scrollTop=A-ce+x.offsetTop}i.style.margin=`${Fe}px 0`,i.style.minHeight=z+"px",i.style.maxHeight=E+"px",s==null||s(),requestAnimationFrame(()=>p.current=!0)}},[m,o.trigger,o.valueNode,i,u,x,w,y,o.dir,s]);st(()=>b(),[b]);const[S,C]=l.useState();st(()=>{u&&C(window.getComputedStyle(u).zIndex)},[u]);const k=l.useCallback(j=>{j&&g.current===!0&&(b(),v==null||v(),g.current=!1)},[b,v]);return h.jsx(hh,{scope:n,contentWrapper:i,shouldExpandOnScrollRef:p,onScrollButtonChange:k,children:h.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:S},children:h.jsx(Ae.div,{...r,ref:f,style:{boxSizing:"border-box",maxHeight:"100%",...r.style}})})})});Bo.displayName=dh;var fh="SelectPopperPosition",os=l.forwardRef((t,e)=>{const{__scopeSelect:n,align:s="start",collisionPadding:r=Fe,...o}=t,a=Rn(n);return h.jsx(Va,{...a,...o,ref:e,align:s,collisionPadding:r,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});os.displayName=fh;var[hh,$s]=Dt(mt,{}),as="SelectViewport",Yo=l.forwardRef((t,e)=>{const{__scopeSelect:n,nonce:s,...r}=t,o=it(as,n),a=$s(as,n),i=qe(e,o.onViewportChange),c=l.useRef(0);return h.jsxs(h.Fragment,{children:[h.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),h.jsx(En.Slot,{scope:n,children:h.jsx(Ae.div,{"data-radix-select-viewport":"",role:"presentation",...r,ref:i,style:{position:"relative",flex:1,overflow:"hidden auto",...r.style},onScroll:Ne(r.onScroll,u=>{const d=u.currentTarget,{contentWrapper:f,shouldExpandOnScrollRef:m}=a;if(m!=null&&m.current&&f){const p=Math.abs(c.current-d.scrollTop);if(p>0){const g=window.innerHeight-Fe*2,x=parseFloat(f.style.minHeight),w=parseFloat(f.style.height),y=Math.max(x,w);if(y<g){const v=y+p,b=Math.min(g,v),S=v-b;f.style.height=b+"px",f.style.bottom==="0px"&&(d.scrollTop=S>0?S:0,f.style.justifyContent="flex-end")}}}c.current=d.scrollTop})})})]})});Yo.displayName=as;var Go="SelectGroup",[ph,mh]=Dt(Go),xh=l.forwardRef((t,e)=>{const{__scopeSelect:n,...s}=t,r=ds();return h.jsx(ph,{scope:n,id:r,children:h.jsx(Ae.div,{role:"group","aria-labelledby":r,...s,ref:e})})});xh.displayName=Go;var Uo="SelectLabel",Ko=l.forwardRef((t,e)=>{const{__scopeSelect:n,...s}=t,r=mh(Uo,n);return h.jsx(Ae.div,{id:r.id,...s,ref:e})});Ko.displayName=Uo;var vn="SelectItem",[gh,qo]=Dt(vn),Qo=l.forwardRef((t,e)=>{const{__scopeSelect:n,value:s,disabled:r=!1,textValue:o,...a}=t,i=at(vn,n),c=it(vn,n),u=i.value===s,[d,f]=l.useState(o??""),[m,p]=l.useState(!1),g=qe(e,v=>{var b;return(b=c.itemRefCallback)==null?void 0:b.call(c,v,s,r)}),x=ds(),w=l.useRef("touch"),y=()=>{r||(i.onValueChange(s),i.onOpenChange(!1))};if(s==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return h.jsx(gh,{scope:n,value:s,disabled:r,textId:x,isSelected:u,onItemTextChange:l.useCallback(v=>{f(b=>b||((v==null?void 0:v.textContent)??"").trim())},[]),children:h.jsx(En.ItemSlot,{scope:n,value:s,disabled:r,textValue:d,children:h.jsx(Ae.div,{role:"option","aria-labelledby":x,"data-highlighted":m?"":void 0,"aria-selected":u&&m,"data-state":u?"checked":"unchecked","aria-disabled":r||void 0,"data-disabled":r?"":void 0,tabIndex:r?void 0:-1,...a,ref:g,onFocus:Ne(a.onFocus,()=>p(!0)),onBlur:Ne(a.onBlur,()=>p(!1)),onClick:Ne(a.onClick,()=>{w.current!=="mouse"&&y()}),onPointerUp:Ne(a.onPointerUp,()=>{w.current==="mouse"&&y()}),onPointerDown:Ne(a.onPointerDown,v=>{w.current=v.pointerType}),onPointerMove:Ne(a.onPointerMove,v=>{var b;w.current=v.pointerType,r?(b=c.onItemLeave)==null||b.call(c):w.current==="mouse"&&v.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Ne(a.onPointerLeave,v=>{var b;v.currentTarget===document.activeElement&&((b=c.onItemLeave)==null||b.call(c))}),onKeyDown:Ne(a.onKeyDown,v=>{var S;((S=c.searchRef)==null?void 0:S.current)!==""&&v.key===" "||(nh.includes(v.key)&&y(),v.key===" "&&v.preventDefault())})})})})});Qo.displayName=vn;var zt="SelectItemText",Xo=l.forwardRef((t,e)=>{const{__scopeSelect:n,className:s,style:r,...o}=t,a=at(zt,n),i=it(zt,n),c=qo(zt,n),u=ah(zt,n),[d,f]=l.useState(null),m=qe(e,y=>f(y),c.onItemTextChange,y=>{var v;return(v=i.itemTextRefCallback)==null?void 0:v.call(i,y,c.value,c.disabled)}),p=d==null?void 0:d.textContent,g=l.useMemo(()=>h.jsx("option",{value:c.value,disabled:c.disabled,children:p},c.value),[c.disabled,c.value,p]),{onNativeOptionAdd:x,onNativeOptionRemove:w}=u;return st(()=>(x(g),()=>w(g)),[x,w,g]),h.jsxs(h.Fragment,{children:[h.jsx(Ae.span,{id:c.textId,...o,ref:m}),c.isSelected&&a.valueNode&&!a.valueNodeHasChildren?us.createPortal(o.children,a.valueNode):null]})});Xo.displayName=zt;var Jo="SelectItemIndicator",Zo=l.forwardRef((t,e)=>{const{__scopeSelect:n,...s}=t;return qo(Jo,n).isSelected?h.jsx(Ae.span,{"aria-hidden":!0,...s,ref:e}):null});Zo.displayName=Jo;var is="SelectScrollUpButton",ea=l.forwardRef((t,e)=>{const n=it(is,t.__scopeSelect),s=$s(is,t.__scopeSelect),[r,o]=l.useState(!1),a=qe(e,s.onScrollButtonChange);return st(()=>{if(n.viewport&&n.isPositioned){let i=function(){const u=c.scrollTop>0;o(u)};const c=n.viewport;return i(),c.addEventListener("scroll",i),()=>c.removeEventListener("scroll",i)}},[n.viewport,n.isPositioned]),r?h.jsx(na,{...t,ref:a,onAutoScroll:()=>{const{viewport:i,selectedItem:c}=n;i&&c&&(i.scrollTop=i.scrollTop-c.offsetHeight)}}):null});ea.displayName=is;var ls="SelectScrollDownButton",ta=l.forwardRef((t,e)=>{const n=it(ls,t.__scopeSelect),s=$s(ls,t.__scopeSelect),[r,o]=l.useState(!1),a=qe(e,s.onScrollButtonChange);return st(()=>{if(n.viewport&&n.isPositioned){let i=function(){const u=c.scrollHeight-c.clientHeight,d=Math.ceil(c.scrollTop)<u;o(d)};const c=n.viewport;return i(),c.addEventListener("scroll",i),()=>c.removeEventListener("scroll",i)}},[n.viewport,n.isPositioned]),r?h.jsx(na,{...t,ref:a,onAutoScroll:()=>{const{viewport:i,selectedItem:c}=n;i&&c&&(i.scrollTop=i.scrollTop+c.offsetHeight)}}):null});ta.displayName=ls;var na=l.forwardRef((t,e)=>{const{__scopeSelect:n,onAutoScroll:s,...r}=t,o=it("SelectScrollButton",n),a=l.useRef(null),i=Tn(n),c=l.useCallback(()=>{a.current!==null&&(window.clearInterval(a.current),a.current=null)},[]);return l.useEffect(()=>()=>c(),[c]),st(()=>{var d;const u=i().find(f=>f.ref.current===document.activeElement);(d=u==null?void 0:u.ref.current)==null||d.scrollIntoView({block:"nearest"})},[i]),h.jsx(Ae.div,{"aria-hidden":!0,...r,ref:e,style:{flexShrink:0,...r.style},onPointerDown:Ne(r.onPointerDown,()=>{a.current===null&&(a.current=window.setInterval(s,50))}),onPointerMove:Ne(r.onPointerMove,()=>{var u;(u=o.onItemLeave)==null||u.call(o),a.current===null&&(a.current=window.setInterval(s,50))}),onPointerLeave:Ne(r.onPointerLeave,()=>{c()})})}),wh="SelectSeparator",sa=l.forwardRef((t,e)=>{const{__scopeSelect:n,...s}=t;return h.jsx(Ae.div,{"aria-hidden":!0,...s,ref:e})});sa.displayName=wh;var cs="SelectArrow",yh=l.forwardRef((t,e)=>{const{__scopeSelect:n,...s}=t,r=Rn(n),o=at(cs,n),a=it(cs,n);return o.open&&a.position==="popper"?h.jsx(Ba,{...r,...s,ref:e}):null});yh.displayName=cs;var vh="SelectBubbleInput",ra=l.forwardRef(({__scopeSelect:t,value:e,...n},s)=>{const r=l.useRef(null),o=qe(s,r),a=Ya(e);return l.useEffect(()=>{const i=r.current;if(!i)return;const c=window.HTMLSelectElement.prototype,d=Object.getOwnPropertyDescriptor(c,"value").set;if(a!==e&&d){const f=new Event("change",{bubbles:!0});d.call(i,e),i.dispatchEvent(f)}},[a,e]),h.jsx(Ae.select,{...n,style:{...Do,...n.style},ref:o,defaultValue:e})});ra.displayName=vh;function oa(t){return t===""||t===void 0}function aa(t){const e=Ta(t),n=l.useRef(""),s=l.useRef(0),r=l.useCallback(a=>{const i=n.current+a;e(i),function c(u){n.current=u,window.clearTimeout(s.current),u!==""&&(s.current=window.setTimeout(()=>c(""),1e3))}(i)},[e]),o=l.useCallback(()=>{n.current="",window.clearTimeout(s.current)},[]);return l.useEffect(()=>()=>window.clearTimeout(s.current),[]),[n,r,o]}function ia(t,e,n){const r=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,o=n?t.indexOf(n):-1;let a=bh(t,Math.max(o,0));r.length===1&&(a=a.filter(u=>u!==n));const c=a.find(u=>u.textValue.toLowerCase().startsWith(r.toLowerCase()));return c!==n?c:void 0}function bh(t,e){return t.map((n,s)=>t[(e+s)%t.length])}var kh=Io,la=Ao,Sh=Ho,Ch=Oo,jh=Wo,ca=zo,Mh=Yo,ua=Ko,da=Qo,_h=Xo,$h=Zo,fa=ea,ha=ta,pa=sa;const Nh=kh,Eh=Sh,ma=l.forwardRef(({className:t,children:e,...n},s)=>h.jsxs(la,{ref:s,className:Ze("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[e,h.jsx(Ch,{asChild:!0,children:h.jsx(Tr,{className:"h-4 w-4 opacity-50"})})]}));ma.displayName=la.displayName;const xa=l.forwardRef(({className:t,...e},n)=>h.jsx(fa,{ref:n,className:Ze("flex cursor-default items-center justify-center py-1",t),...e,children:h.jsx(Qa,{className:"h-4 w-4"})}));xa.displayName=fa.displayName;const ga=l.forwardRef(({className:t,...e},n)=>h.jsx(ha,{ref:n,className:Ze("flex cursor-default items-center justify-center py-1",t),...e,children:h.jsx(Tr,{className:"h-4 w-4"})}));ga.displayName=ha.displayName;const wa=l.forwardRef(({className:t,children:e,position:n="popper",...s},r)=>h.jsx(jh,{children:h.jsxs(ca,{ref:r,className:Ze("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...s,children:[h.jsx(xa,{}),h.jsx(Mh,{className:Ze("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),h.jsx(ga,{})]})}));wa.displayName=ca.displayName;const Th=l.forwardRef(({className:t,...e},n)=>h.jsx(ua,{ref:n,className:Ze("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...e}));Th.displayName=ua.displayName;const fn=l.forwardRef(({className:t,children:e,...n},s)=>h.jsxs(da,{ref:s,className:Ze("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx($h,{children:h.jsx(Ka,{className:"h-4 w-4"})})}),h.jsx(_h,{children:e})]}));fn.displayName=da.displayName;const Rh=l.forwardRef(({className:t,...e},n)=>h.jsx(pa,{ref:n,className:Ze("-mx-1 my-1 h-px bg-muted",t),...e}));Rh.displayName=pa.displayName;const tp=()=>[{rel:"stylesheet",href:Gf}];class Dh extends l.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,n){console.error("Gantt Error:",e,n)}render(){var e;return this.state.hasError?this.props.fallback||h.jsxs("div",{className:"p-4 text-red-500",children:["Something went wrong: ",(e=this.state.error)==null?void 0:e.message]}):this.props.children}}const Ih=[{id:20,text:"éæ±åæ",start:new Date(2024,5,11),end:new Date(2024,6,12),duration:1,progress:60,type:"task",lazy:!1},{id:47,text:"æ ¸å¿å¼å",start:new Date(2024,5,12),end:new Date(2024,7,12),duration:8,progress:20,parent:0,type:"summary"},{id:22,text:"åç«¯å®ç°",start:new Date(2024,7,11),end:new Date(2024,8,12),duration:8,progress:0,parent:47,type:"task"},{id:21,text:"åç«¯æ¥å£",start:new Date(2024,7,10),end:new Date(2024,8,12),duration:3,progress:0,type:"task",lazy:!1},{id:23,text:"æµè¯éªæ¶",start:new Date(2024,8,15),end:new Date(2024,9,1),duration:5,progress:0,type:"task"}],Ph=[{id:1,source:20,target:47,type:"e2s"},{id:2,source:47,target:23,type:"e2s"}];function Ah({children:t,fallback:e=null}){const[n,s]=l.useState(!1);return l.useEffect(()=>{s(!0),console.log("ClientOnly mounted")},[]),n?h.jsx(Dh,{children:t()}):h.jsx(h.Fragment,{children:e})}function np(){const[t,e]=l.useState(null),[n,s]=l.useState("day"),[r,o]=l.useState([]),[a,i]=l.useState(""),[c,u]=l.useState(!0),[d,f]=l.useState(null),m=l.useRef([]);l.useEffect(()=>{m.current=r},[r]),l.useEffect(()=>{fetch("/api/projects").then(k=>k.json()).then(k=>{if(k.projects&&k.projects.length>0){const j=k.projects.map(N=>({...N,tasks:N.tasks.map(_=>({..._,start:_.start?new Date(_.start):void 0,end:_.end?new Date(_.end):void 0}))}));o(j),i(j[0].id)}else p()}).catch(k=>{console.error("Failed to load projects from API",k),p()})},[]);const p=()=>{const k={id:crypto.randomUUID(),name:"æ¼ç¤ºé¡¹ç®",tasks:Ih,links:Ph};g(k,!0)},g=(k,j=!1)=>{fetch("/api/projects",{method:j?"POST":"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(k)}).then(_=>_.json()).then(_=>{_.ok?(f(new Date),j&&(o($=>[...$,k]),i(k.id))):console.error("Failed to save project",_.error)}).catch(_=>console.error("API save error",_))},x=k=>{if(!t)return;const N=m.current.find(E=>E.id===k);if(!N)return;const _=t.serialize();let $=[];try{$=t.getStores().data.links.serialize()}catch(E){console.warn("Could not serialize links",E)}const M={...N,tasks:_,links:$.length>0?$:N.links};o(E=>E.map(L=>L.id===k?M:L)),g(M,!1)};l.useEffect(()=>{if(!t||!a)return;let k;const j=a,N=M=>{console.log("Gantt event triggered:",M),clearTimeout(k),k=setTimeout(()=>{console.log("Auto-saving project:",j),x(j)},1e3)},_=["add-task","update-task","delete-task","move-task","indent-task","add-link","update-link","delete-link"],$=[];return _.forEach(M=>{try{const E=t.on(M,N);E&&$.push({event:M,id:E})}catch(E){console.error(`Failed to attach event ${M}`,E)}}),()=>{clearTimeout(k),t&&t.detach&&$.forEach(({event:M,id:E})=>{try{t.detach(M,E),typeof t.detachEvent=="function"?t.detachEvent(E):t.detach(M,E)}catch(L){console.warn("Detach failed",L)}})}},[t,a]);const w=()=>{const k={id:crypto.randomUUID(),name:`æ°é¡¹ç® ${r.length+1}`,tasks:[],links:[]};g(k,!0)},y=(k,j)=>{k.stopPropagation(),confirm("ç¡®å®è¦å é¤è¿ä¸ªé¡¹ç®åï¼")&&fetch(`/api/projects?id=${j}`,{method:"DELETE"}).then(N=>N.json()).then(N=>{if(N.ok){const _=r.filter($=>$.id!==j);o(_),a===j&&(_.length>0?i(_[0].id):p())}})},v=k=>{a!==k&&(a&&t&&x(a),i(k))},b=r.find(k=>k.id===a)||r[0],S=()=>{if(!t){console.error("API not ready");return}try{const k=t.serialize();if(!Array.isArray(k)){console.error("Serialize returned unexpected format:",k),alert("å¯¼åºæ°æ®æ ¼å¼éè¯¯");return}const N=[["ID","ä»»å¡åç§°","å¼å§æ¶é´","ç»ææ¶é´","è¿åº¦"].join(","),...k.map(M=>[M.id,`"${M.text}"`,M.start_date?new Date(M.start_date).toLocaleDateString():"",M.end_date?new Date(M.end_date).toLocaleDateString():"",(M.progress||0)+"%"].join(","))].join(`
`),_=new Blob(["\uFEFF"+N],{type:"text/csv;charset=utf-8;"}),$=document.createElement("a");$.href=URL.createObjectURL(_),$.download=`${(b==null?void 0:b.name)||"project"}_tasks.csv`,$.click()}catch(k){alert("å¯¼åºå¤±è´¥ï¼è¯·ç¨åéè¯"),console.error(k)}},C=n==="day"?[{unit:"month",step:1,format:"MMMM yyy"},{unit:"day",step:1,format:"d"}]:n==="week"?[{unit:"month",step:1,format:"MMMM yyy"},{unit:"week",step:1,format:"'Week 'w"}]:[{unit:"year",step:1,format:"yyyy"},{unit:"month",step:1,format:"MMM"}];return h.jsxs("div",{className:"h-[calc(100vh-10rem)] w-full border rounded-lg overflow-hidden bg-background flex",children:[h.jsxs("div",{className:"w-64 border-r bg-muted/10 flex flex-col shrink-0",children:[h.jsxs("div",{className:"p-3 border-b flex items-center justify-between bg-muted/20",children:[h.jsxs("span",{className:"font-medium text-sm flex items-center gap-2",children:[h.jsx(Ga,{className:"w-4 h-4"}),"é¡¹ç®åè¡¨"]}),h.jsx(rn,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:w,children:h.jsx(ei,{className:"w-4 h-4"})})]}),h.jsx("div",{className:"flex-1 overflow-y-auto p-2 space-y-1",children:r.map(k=>h.jsxs("div",{onClick:()=>v(k.id),className:Ze("group flex items-center justify-between p-2 rounded-md text-sm cursor-pointer hover:bg-accent/50 transition-colors",k.id===a?"bg-accent text-accent-foreground font-medium":"text-muted-foreground"),children:[h.jsx("span",{className:"truncate",children:k.name}),h.jsx(rn,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity text-destructive hover:text-destructive hover:bg-destructive/10",onClick:j=>y(j,k.id),children:h.jsx(ri,{className:"w-3.5 h-3.5"})})]},k.id))})]}),h.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[h.jsxs("div",{className:"p-3 border-b flex items-center justify-between bg-muted/20",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsxs(Nh,{value:n,onValueChange:s,children:[h.jsx(ma,{className:"w-[120px] h-8",children:h.jsx(Eh,{placeholder:"éæ©è§å¾"})}),h.jsxs(wa,{children:[h.jsx(fn,{value:"day",children:"æ¥è§å¾"}),h.jsx(fn,{value:"week",children:"å¨è§å¾"}),h.jsx(fn,{value:"month",children:"æè§å¾"})]})]}),h.jsxs(rn,{variant:"outline",size:"sm",onClick:S,disabled:!t,className:"h-8",children:[h.jsx(Ja,{className:"w-3.5 h-3.5 mr-2"}),"å¯¼åº Excel"]}),h.jsxs(rn,{variant:"default",size:"sm",onClick:()=>x(a),disabled:!t,className:"h-8",children:[h.jsx(ni,{className:"w-3.5 h-3.5 mr-2"}),"ä¿å­"]})]}),h.jsxs("div",{className:"text-sm text-muted-foreground flex items-center gap-2",children:[d&&h.jsxs("span",{className:"text-xs text-muted-foreground/60",children:["å·²ä¿å­ ",d.toLocaleTimeString()]}),h.jsxs("span",{children:["å½åé¡¹ç®: ",b==null?void 0:b.name]})]})]}),h.jsx(Ah,{fallback:h.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Loading Gantt Chart..."}),children:()=>h.jsxs(Yf,{children:[h.jsx(zf,{api:t,items:es}),b&&h.jsx(Wf,{init:e,tasks:b.tasks,links:b.links,scales:C},b.id),t&&h.jsx(Bf,{api:t})]})})]})]})}export{np as default,tp as links};
