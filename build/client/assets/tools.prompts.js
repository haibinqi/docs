import{r,j as t}from"./jsx-runtime.js";import{c as Ne,B as _}from"./button.js";import{I as z}from"./input.js";import{c as v,a as je,u as T}from"./utils.js";import{d as Ce,c as be,a as A,P as E,b as R,g as De}from"./index3.js";import{P as we,h as Re,R as Ee,u as _e,F as Pe,D as Se}from"./Combination.js";import{P as O}from"./index2.js";import{c as G}from"./createLucideIcon.js";import"./index4.js";/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Ie=G("copy",Ae);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Oe=G("x",Te),H=r.forwardRef(({className:e,...o},s)=>t.jsx("textarea",{className:v("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:s,...o}));H.displayName="Textarea";const I=r.forwardRef(({className:e,...o},s)=>t.jsx("div",{ref:s,className:v("rounded-lg border bg-card text-card-foreground shadow-sm",e),...o}));I.displayName="Card";const ke=r.forwardRef(({className:e,...o},s)=>t.jsx("div",{ref:s,className:v("flex flex-col space-y-1.5 p-6",e),...o}));ke.displayName="CardHeader";const Me=r.forwardRef(({className:e,...o},s)=>t.jsx("h3",{ref:s,className:v("text-2xl font-semibold leading-none tracking-tight",e),...o}));Me.displayName="CardTitle";const Fe=r.forwardRef(({className:e,...o},s)=>t.jsx("p",{ref:s,className:v("text-sm text-muted-foreground",e),...o}));Fe.displayName="CardDescription";const Le=r.forwardRef(({className:e,...o},s)=>t.jsx("div",{ref:s,className:v("p-6 pt-0",e),...o}));Le.displayName="CardContent";const $e=r.forwardRef(({className:e,...o},s)=>t.jsx("div",{ref:s,className:v("flex items-center p-6 pt-0",e),...o}));$e.displayName="CardFooter";function We(e){const o=Ve(e),s=r.forwardRef((n,a)=>{const{children:i,...d}=n,c=r.Children.toArray(i),p=c.find(Ge);if(p){const m=p.props.children,b=c.map(y=>y===p?r.Children.count(m)>1?r.Children.only(null):r.isValidElement(m)?m.props.children:null:y);return t.jsx(o,{...d,ref:a,children:r.isValidElement(m)?r.cloneElement(m,void 0,b):null})}return t.jsx(o,{...d,ref:a,children:i})});return s.displayName=`${e}.Slot`,s}function Ve(e){const o=r.forwardRef((s,n)=>{const{children:a,...i}=s;if(r.isValidElement(a)){const d=Be(a),c=He(i,a.props);return a.type!==r.Fragment&&(c.ref=n?je(n,d):d),r.cloneElement(a,c)}return r.Children.count(a)>1?r.Children.only(null):null});return o.displayName=`${e}.SlotClone`,o}var ze=Symbol("radix.slottable");function Ge(e){return r.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===ze}function He(e,o){const s={...o};for(const n in o){const a=e[n],i=o[n];/^on[A-Z]/.test(n)?a&&i?s[n]=(...c)=>{const p=i(...c);return a(...c),p}:a&&(s[n]=a):n==="style"?s[n]={...a,...i}:n==="className"&&(s[n]=[a,i].filter(Boolean).join(" "))}return{...e,...s}}function Be(e){var n,a;let o=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,s=o&&"isReactWarning"in o&&o.isReactWarning;return s?e.ref:(o=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,s=o&&"isReactWarning"in o&&o.isReactWarning,s?e.props.ref:e.props.ref||e.ref)}var S="Dialog",[B]=be(S),[Ue,j]=B(S),U=e=>{const{__scopeDialog:o,children:s,open:n,defaultOpen:a,onOpenChange:i,modal:d=!0}=e,c=r.useRef(null),p=r.useRef(null),[m,b]=Ce({prop:n,defaultProp:a??!1,onChange:i,caller:S});return t.jsx(Ue,{scope:o,triggerRef:c,contentRef:p,contentId:A(),titleId:A(),descriptionId:A(),open:m,onOpenChange:b,onOpenToggle:r.useCallback(()=>b(y=>!y),[b]),modal:d,children:s})};U.displayName=S;var J="DialogTrigger",q=r.forwardRef((e,o)=>{const{__scopeDialog:s,...n}=e,a=j(J,s),i=T(o,a.triggerRef);return t.jsx(E.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":F(a.open),...n,ref:i,onClick:R(e.onClick,a.onOpenToggle)})});q.displayName=J;var k="DialogPortal",[Je,K]=B(k,{forceMount:void 0}),Y=e=>{const{__scopeDialog:o,forceMount:s,children:n,container:a}=e,i=j(k,o);return t.jsx(Je,{scope:o,forceMount:s,children:r.Children.map(n,d=>t.jsx(O,{present:s||i.open,children:t.jsx(we,{asChild:!0,container:a,children:d})}))})};Y.displayName=k;var P="DialogOverlay",Z=r.forwardRef((e,o)=>{const s=K(P,e.__scopeDialog),{forceMount:n=s.forceMount,...a}=e,i=j(P,e.__scopeDialog);return i.modal?t.jsx(O,{present:n||i.open,children:t.jsx(Ke,{...a,ref:o})}):null});Z.displayName=P;var qe=We("DialogOverlay.RemoveScroll"),Ke=r.forwardRef((e,o)=>{const{__scopeDialog:s,...n}=e,a=j(P,s);return t.jsx(Ee,{as:qe,allowPinchZoom:!0,shards:[a.contentRef],children:t.jsx(E.div,{"data-state":F(a.open),...n,ref:o,style:{pointerEvents:"auto",...n.style}})})}),D="DialogContent",Q=r.forwardRef((e,o)=>{const s=K(D,e.__scopeDialog),{forceMount:n=s.forceMount,...a}=e,i=j(D,e.__scopeDialog);return t.jsx(O,{present:n||i.open,children:i.modal?t.jsx(Ye,{...a,ref:o}):t.jsx(Ze,{...a,ref:o})})});Q.displayName=D;var Ye=r.forwardRef((e,o)=>{const s=j(D,e.__scopeDialog),n=r.useRef(null),a=T(o,s.contentRef,n);return r.useEffect(()=>{const i=n.current;if(i)return Re(i)},[]),t.jsx(X,{...e,ref:a,trapFocus:s.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:R(e.onCloseAutoFocus,i=>{var d;i.preventDefault(),(d=s.triggerRef.current)==null||d.focus()}),onPointerDownOutside:R(e.onPointerDownOutside,i=>{const d=i.detail.originalEvent,c=d.button===0&&d.ctrlKey===!0;(d.button===2||c)&&i.preventDefault()}),onFocusOutside:R(e.onFocusOutside,i=>i.preventDefault())})}),Ze=r.forwardRef((e,o)=>{const s=j(D,e.__scopeDialog),n=r.useRef(!1),a=r.useRef(!1);return t.jsx(X,{...e,ref:o,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var d,c;(d=e.onCloseAutoFocus)==null||d.call(e,i),i.defaultPrevented||(n.current||(c=s.triggerRef.current)==null||c.focus(),i.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:i=>{var p,m;(p=e.onInteractOutside)==null||p.call(e,i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const d=i.target;((m=s.triggerRef.current)==null?void 0:m.contains(d))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),X=r.forwardRef((e,o)=>{const{__scopeDialog:s,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:i,...d}=e,c=j(D,s),p=r.useRef(null),m=T(o,p);return _e(),t.jsxs(t.Fragment,{children:[t.jsx(Pe,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:i,children:t.jsx(Se,{role:"dialog",id:c.contentId,"aria-describedby":c.descriptionId,"aria-labelledby":c.titleId,"data-state":F(c.open),...d,ref:m,onDismiss:()=>c.onOpenChange(!1)})}),t.jsxs(t.Fragment,{children:[t.jsx(Qe,{titleId:c.titleId}),t.jsx(et,{contentRef:p,descriptionId:c.descriptionId})]})]})}),M="DialogTitle",ee=r.forwardRef((e,o)=>{const{__scopeDialog:s,...n}=e,a=j(M,s);return t.jsx(E.h2,{id:a.titleId,...n,ref:o})});ee.displayName=M;var te="DialogDescription",oe=r.forwardRef((e,o)=>{const{__scopeDialog:s,...n}=e,a=j(te,s);return t.jsx(E.p,{id:a.descriptionId,...n,ref:o})});oe.displayName=te;var se="DialogClose",re=r.forwardRef((e,o)=>{const{__scopeDialog:s,...n}=e,a=j(se,s);return t.jsx(E.button,{type:"button",...n,ref:o,onClick:R(e.onClick,()=>a.onOpenChange(!1))})});re.displayName=se;function F(e){return e?"open":"closed"}var ae="DialogTitleWarning",[bt,ne]=De(ae,{contentName:D,titleName:M,docsSlug:"dialog"}),Qe=({titleId:e})=>{const o=ne(ae),s=`\`${o.contentName}\` requires a \`${o.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${o.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${o.docsSlug}`;return r.useEffect(()=>{e&&(document.getElementById(e)||console.error(s))},[s,e]),null},Xe="DialogDescriptionWarning",et=({contentRef:e,descriptionId:o})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${ne(Xe).contentName}}.`;return r.useEffect(()=>{var i;const a=(i=e.current)==null?void 0:i.getAttribute("aria-describedby");o&&a&&(document.getElementById(o)||console.warn(n))},[n,e,o]),null},tt=U,ot=q,st=Y,ie=Z,le=Q,ce=ee,de=oe,rt=re;const at=tt,nt=ot,it=st,ue=r.forwardRef(({className:e,...o},s)=>t.jsx(ie,{ref:s,className:v("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...o}));ue.displayName=ie.displayName;const fe=r.forwardRef(({className:e,children:o,...s},n)=>t.jsxs(it,{children:[t.jsx(ue,{}),t.jsxs(le,{ref:n,className:v("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...s,children:[o,t.jsxs(rt,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[t.jsx(Oe,{className:"h-4 w-4"}),t.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));fe.displayName=le.displayName;const pe=({className:e,...o})=>t.jsx("div",{className:v("flex flex-col space-y-1.5 text-center sm:text-left",e),...o});pe.displayName="DialogHeader";const me=r.forwardRef(({className:e,...o},s)=>t.jsx(ce,{ref:s,className:v("text-lg font-semibold leading-none tracking-tight",e),...o}));me.displayName=ce.displayName;const lt=r.forwardRef(({className:e,...o},s)=>t.jsx(de,{ref:s,className:v("text-sm text-muted-foreground",e),...o}));lt.displayName=de.displayName;const ct=Ne("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),ge=r.forwardRef(({className:e,variant:o,...s},n)=>t.jsx("div",{ref:n,role:"alert",className:v(ct({variant:o}),e),...s}));ge.displayName="Alert";const dt=r.forwardRef(({className:e,...o},s)=>t.jsx("h5",{ref:s,className:v("mb-1 font-medium leading-none tracking-tight",e),...o}));dt.displayName="AlertTitle";const xe=r.forwardRef(({className:e,...o},s)=>t.jsx("div",{ref:s,className:v("text-sm [&_p]:leading-relaxed",e),...o}));xe.displayName="AlertDescription";const L="docs-prompts";function $(){if(typeof window>"u")return[];const e=localStorage.getItem(L);if(!e)return[];try{return JSON.parse(e)}catch{return[]}}function ut(e){const o=$(),s={...e,id:Date.now().toString(36)+Math.random().toString(36).slice(2,8),createdAt:Date.now()};return o.unshift(s),localStorage.setItem(L,JSON.stringify(o)),s}function ft(e){const o=$(),s=o.filter(a=>a.id!==e),n=s.length!==o.length;return n&&localStorage.setItem(L,JSON.stringify(s)),n}function Dt(){const[e,o]=r.useState(""),[s,n]=r.useState(""),[a,i]=r.useState(""),[d,c]=r.useState([]),[p,m]=r.useState([]),[b,y]=r.useState([]),[N,he]=r.useState("ALL"),[x,pt]=r.useState(""),[W,C]=r.useState("");r.useEffect(()=>{async function l(){try{const f=await fetch(`/api/prompts?category=${encodeURIComponent(N)}`);if(f.ok){const g=await f.json();m(g.prompts),c(g.categories),y(x?g.prompts.filter(w=>w.title.includes(x)||w.content.includes(x)):g.prompts);return}}catch{}const u=$();m(u),c(Array.from(new Set(u.map(f=>f.category))).sort((f,g)=>f.localeCompare(g)));const h=N==="ALL"?u:u.filter(f=>f.category===N);y(x?h.filter(f=>f.title.includes(x)||f.content.includes(x)):h)}l()},[]),r.useEffect(()=>{async function l(){try{const h=await fetch(`/api/prompts?category=${encodeURIComponent(N)}`);if(h.ok){const f=await h.json();m(f.prompts),c(f.categories),y(x?f.prompts.filter(g=>g.title.includes(x)||g.content.includes(x)):f.prompts);return}}catch{}const u=N==="ALL"?p:p.filter(h=>h.category===N);y(x?u.filter(h=>h.title.includes(x)||h.content.includes(x)):u)}l()},[N]),r.useEffect(()=>{const l=N==="ALL"?p:p.filter(u=>u.category===N);y(x?l.filter(u=>u.title.includes(x)||u.content.includes(x)):l)},[x,p]);async function ve(){const l=e.trim();if(!(!l||!s.trim()||!a.trim())){try{if((await fetch("/api/prompts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({category:l,title:s.trim(),content:a.trim()})})).ok)await V(),C("新增成功"),setTimeout(()=>C(""),2e3);else throw new Error("server")}catch{const u=ut({category:l,title:s.trim(),content:a.trim()});m(h=>{const f=[u,...h];return c(Array.from(new Set(f.map(g=>g.category))).sort((g,w)=>g.localeCompare(w))),f}),C("已保存到本地"),setTimeout(()=>C(""),2e3)}n(""),i("")}}async function ye(l){try{if((await fetch(`/api/prompts?id=${encodeURIComponent(l)}`,{method:"DELETE"})).ok){await V(),C("删除成功"),setTimeout(()=>C(""),2e3);return}}catch{}ft(l)&&(m(h=>{const f=h.filter(g=>g.id!==l);return c(Array.from(new Set(f.map(g=>g.category))).sort((g,w)=>g.localeCompare(w))),f}),C("已从本地删除"),setTimeout(()=>C(""),2e3))}async function V(){try{const l=await fetch(`/api/prompts?category=${encodeURIComponent(N)}`);if(l.ok){const u=await l.json();m(u.prompts),c(u.categories),y(u.prompts)}}catch{}}return t.jsx("div",{className:"flex-1",children:t.jsx("section",{className:"space-y-6 bg-slate-50 dark:bg-transparent",children:t.jsx("div",{className:"mx-auto px-4 max-w-[1200px] py-4",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-6",children:[t.jsx("div",{className:"md:col-span-4",children:t.jsxs(I,{className:"p-4 sticky top-4",children:[t.jsx("h3",{className:"font-bold mb-3",children:"新增提示词"}),t.jsxs("div",{className:"grid gap-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-muted-foreground",children:"分类"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("select",{value:e,onChange:l=>{const u=l.target.value;o(u!=="__NEW__"?u:"")},className:"h-8 text-[13px] w-1/3 rounded-md border border-input bg-background px-3",children:[t.jsx("option",{value:"",disabled:!0,children:"选择分类"}),d.map(l=>t.jsx("option",{value:l,children:l},l)),t.jsx("option",{value:"__NEW__",children:"输入新分类..."})]}),t.jsx(z,{value:e,onChange:l=>o(l.target.value),className:"h-8 text-[13px] flex-1",placeholder:"输入分类名称"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-muted-foreground",children:"标题"}),t.jsx(z,{value:s,onChange:l=>n(l.target.value),className:"h-8 text-[13px]",placeholder:"提示词标题"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-muted-foreground",children:"内容"}),t.jsx(H,{value:a,onChange:l=>i(l.target.value),rows:6,placeholder:"完整提示词内容"})]}),t.jsx("div",{className:"flex justify-end",children:t.jsx(_,{size:"sm",className:"h-8 px-4 text-[13px]",onClick:ve,children:"保存"})})]})]})}),t.jsx("div",{className:"md:col-span-8",children:t.jsxs(I,{className:"p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("h3",{className:"font-bold",children:"提示词库"}),t.jsx("div",{className:"w-[200px]",children:t.jsxs("select",{value:N,onChange:l=>he(l.target.value),className:"h-8 text-[13px] w-full rounded-md border border-input bg-background px-3",children:[t.jsx("option",{value:"ALL",children:"全部分类"}),d.map(l=>t.jsx("option",{value:l,children:l},l))]})})]}),t.jsxs("div",{className:"grid gap-4",children:[t.jsx("div",{className:"border rounded-md min-h-[120px]",children:b.length===0?t.jsx("div",{className:"p-3 text-sm text-muted-foreground",children:"暂无提示词"}):t.jsx("div",{className:"divide-y",children:b.map(l=>t.jsxs("div",{className:"p-3 flex items-center justify-between gap-3",children:[t.jsxs("div",{className:"min-w-0",children:[t.jsx("div",{className:"text-xs text-muted-foreground",children:l.category}),t.jsx("div",{className:"font-medium truncate max-w-[520px]",children:l.title})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(_,{variant:"outline",size:"sm",className:"h-8 px-3 text-[13px]",onClick:()=>{navigator.clipboard.writeText(l.content),C("内容已复制"),setTimeout(()=>C(""),2e3)},children:[t.jsx(Ie,{className:"w-3.5 h-3.5 mr-1"})," 复制"]}),t.jsxs(at,{children:[t.jsx(nt,{asChild:!0,children:t.jsx(_,{variant:"outline",size:"sm",className:"h-8 px-3 text-[13px]",children:"查看"})}),t.jsxs(fe,{className:"sm:max-w-[640px]",children:[t.jsx(pe,{children:t.jsx(me,{children:l.title})}),t.jsx("div",{className:"text-sm whitespace-pre-wrap",children:l.content})]})]}),t.jsx(_,{variant:"destructive",size:"sm",className:"h-8 px-3 text-[13px]",onClick:()=>ye(l.id),children:"删除"})]})]},l.id))})}),W&&t.jsx(ge,{className:"mb-2",children:t.jsx(xe,{children:W})})]})]})})]})})})})}export{Dt as default};
